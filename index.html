<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<meta name="theme-color" content="#080706"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<meta name="apple-mobile-web-app-title" content="ChairMatch"/>
<meta name="description" content="ChairMatch — Dein Beauty-Partner in ganz Deutschland. Buche Termine bei Top-Salons, Barbershops, Kosmetik & mehr."/>
<meta property="og:title" content="ChairMatch — Beauty Booking Deutschland"/>
<meta property="og:description" content="Buche Termine bei den besten Salons, Barbershops & Kosmetikstudios. Sofortige Bestätigung."/>
<meta property="og:type" content="website"/>
<meta property="og:url" content="https://chairmatch.vercel.app"/>
<meta property="og:image" content="https://chairmatch.vercel.app/og-image.png"/>
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:title" content="ChairMatch — Beauty Booking"/>
<meta name="twitter:description" content="Buche Termine bei Top-Salons in Deutschland. Sofortige Bestätigung."/>
<link rel="manifest" href="manifest.json"/>
<link rel="apple-touch-icon" sizes="180x180" href="icon-180.png"/>
<title>ChairMatch — Beauty Booking Deutschland</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600;700&family=Cinzel:wght@400;600;700;900&family=DM+Sans:wght@300;400;500;600;700;800&display=swap');
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
html,body{height:100%;font-family:'DM Sans',sans-serif;overflow:hidden;transition:background .3s,color .3s;-webkit-text-size-adjust:100%;text-size-adjust:100%;touch-action:manipulation;-webkit-touch-callout:none}
:root{--bg:#060504;--c1:#0D0B08;--c2:#141108;--c3:#1C1810;--c4:#232018;--c5:#2E2A1E;
--gold:#C8A84B;--gold2:#E8D06A;--gold3:#F5E080;--goldlo:rgba(200,168,75,0.08);
--cream:#F0E8D8;--stone:#8A8070;--stone2:#5A5448;--red:#E85040;--green:#4A8A5A;
--cardbg:#141108;--sheetbg:#0D0B08;--border:rgba(200,168,75,0.08);--borderhi:rgba(200,168,75,0.15);
--sai-top:env(safe-area-inset-top,0px);--sai-bottom:env(safe-area-inset-bottom,0px);--sai-left:env(safe-area-inset-left,0px);--sai-right:env(safe-area-inset-right,0px);
--shell-max:430px;--pad:20px;--nav-h:56px;--font-xs:10px;--font-sm:12px;--font-md:14px;--font-lg:18px;--font-xl:22px;--card-radius:18px;--btn-radius:14px}
html,body{background:var(--bg);color:var(--cream)}
.light{--bg:#F5F0E8;--c1:#FFFFFF;--c2:#F8F4EE;--c3:#EDE8E0;--c4:#E0D8CC;--c5:#D0C8B8;
--cream:#1A1408;--stone:#6A6458;--stone2:#9A9488;--cardbg:#FFFFFF;--sheetbg:#FFFFFF;--border:rgba(0,0,0,0.06);--borderhi:rgba(0,0,0,0.12)}
.serif{font-family:'Cormorant Garamond',serif}
.cinzel{font-family:'Cinzel',serif}
.shell{width:100%;max-width:var(--shell-max);margin:0 auto;height:100vh;height:100dvh;background:var(--c1);position:relative;display:flex;flex-direction:column;overflow:hidden}
.screen{flex:1;overflow-y:auto;overflow-x:hidden;padding-bottom:calc(var(--nav-h) + var(--sai-bottom));scroll-behavior:smooth;overscroll-behavior-y:contain}
.screen::-webkit-scrollbar{display:none}
button{border:none;background:none;cursor:pointer;font-family:inherit;color:inherit}
.bgold{background:linear-gradient(135deg,#D4AE54,#C8A84B,#B8982B);color:#080706;font-weight:800;border-radius:var(--btn-radius);padding:14px 22px;font-size:var(--font-md);width:100%;border:none;cursor:pointer;font-family:inherit;display:block;box-shadow:0 4px 20px rgba(200,168,75,0.3);transition:transform .15s,box-shadow .15s;min-height:48px}
.bgold:active{transform:scale(.97);box-shadow:0 2px 10px rgba(200,168,75,0.2)}
.bgold:disabled{opacity:.4;box-shadow:none;transform:none}
.boutline{background:transparent;border:1.5px solid rgba(200,168,75,.35);color:var(--gold2);font-weight:700;border-radius:var(--btn-radius);padding:14px 22px;font-size:var(--font-md);cursor:pointer;font-family:inherit;transition:background .2s;min-height:48px}
.boutline:active{background:rgba(200,168,75,.08)}
.inp{width:100%;background:var(--c3);border:1.5px solid var(--border);border-radius:12px;padding:13px 16px;color:var(--cream);font-family:inherit;font-size:16px;outline:none;transition:border-color .2s;-webkit-appearance:none;appearance:none}
.inp:focus{border-color:var(--gold)}
.inp::placeholder{color:var(--stone2)}
.card{background:var(--cardbg);border-radius:var(--card-radius);border:1px solid var(--border);overflow:hidden;transition:transform .2s}
.card:active{transform:scale(.985)}
.lsm{font-size:var(--font-xs);font-weight:800;letter-spacing:.12em;color:var(--stone);text-transform:uppercase}
.lgold{font-size:var(--font-xs);font-weight:800;letter-spacing:.12em;color:var(--gold);text-transform:uppercase}
.badge{display:inline-flex;align-items:center;padding:4px 10px;border-radius:20px;font-size:var(--font-xs);font-weight:700}
.bgd{background:rgba(200,168,75,.12);color:var(--gold2);border:1px solid rgba(200,168,75,.2)}
.bgr{background:rgba(74,138,90,.15);color:#6ABF80;border:1px solid rgba(74,138,90,.25)}
.brd{background:rgba(232,80,64,.12);color:#F07060;border:1px solid rgba(232,80,64,.2)}
.nav{position:absolute;bottom:0;left:0;right:0;background:rgba(6,5,4,.97);border-top:1px solid rgba(200,168,75,.12);display:flex;justify-content:space-around;padding:6px 0 calc(4px + var(--sai-bottom));z-index:50;backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px)}
.light .nav{background:rgba(255,255,255,.95)}
.nbtn{display:flex;flex-direction:column;align-items:center;gap:2px;padding:4px 14px;cursor:pointer;border:none;background:none;font-family:inherit;position:relative;min-width:44px;min-height:44px;justify-content:center}
.nbtn .notif-dot{position:absolute;top:2px;right:8px;width:8px;height:8px;border-radius:50%;background:var(--red)}
.sticky{position:sticky;top:0;background:var(--c1);z-index:40;border-bottom:1px solid var(--border);padding:14px var(--pad)}
.pbar{height:3px;background:var(--c4);border-radius:2px}
.pfill{height:3px;background:linear-gradient(90deg,var(--gold),var(--gold3));border-radius:2px;transition:width .3s}
.check{width:22px;height:22px;border-radius:5px;display:flex;align-items:center;justify-content:center;font-size:10px;flex-shrink:0;border:2px solid var(--c5);background:var(--c4);cursor:pointer}
.check.on{background:var(--gold);border-color:var(--gold);color:#080706}
.overlay{display:none;position:fixed;inset:0;z-index:200;background:rgba(0,0,0,.8);align-items:flex-end;justify-content:center}
.overlay.active{display:flex}
.sheet{width:100%;max-width:var(--shell-max);margin:0 auto;max-height:93vh;max-height:93dvh;overflow-y:auto;background:var(--sheetbg);border-radius:24px 24px 0 0;border:1px solid var(--borderhi);animation:sheetUp .3s ease;padding-bottom:var(--sai-bottom)}
@keyframes sheetUp{from{transform:translateY(100%)}to{transform:translateY(0)}}
/* Logo Animations */
@keyframes logoFloat{0%,100%{transform:translateY(0px)}50%{transform:translateY(-4px)}}
@keyframes logoGlow{0%,100%{filter:drop-shadow(0 0 8px rgba(200,168,75,0.4)) drop-shadow(0 0 20px rgba(200,168,75,0.2))}50%{filter:drop-shadow(0 0 16px rgba(232,208,106,0.7)) drop-shadow(0 0 40px rgba(200,168,75,0.4)) drop-shadow(0 0 80px rgba(200,168,75,0.15))}}
@keyframes rimRotate{0%{stroke-dashoffset:0}100%{stroke-dashoffset:-600}}
@keyframes sparkle{0%,100%{opacity:0;transform:scale(0)}40%,60%{opacity:1;transform:scale(1)}}
@keyframes shimmer{0%{stop-color:#FFF8D0}25%{stop-color:#E8C860}50%{stop-color:#FFF0A0}75%{stop-color:#D4A840}100%{stop-color:#FFF8D0}}
@keyframes fu{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
.fu{animation:fu .4s ease both}
.d1{animation-delay:.07s}.d2{animation-delay:.14s}.d3{animation-delay:.22s}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
@keyframes starGlow{0%,100%{text-shadow:0 0 4px rgba(245,208,96,.3)}50%{text-shadow:0 0 12px rgba(245,208,96,.8),0 0 24px rgba(245,208,96,.4)}}
@keyframes slideIn{from{opacity:0;transform:translateX(20px)}to{opacity:1;transform:translateX(0)}}
.toast{position:fixed;top:calc(20px + var(--sai-top));left:50%;transform:translateX(-50%);background:var(--gold);color:#080706;padding:12px 24px;border-radius:12px;font-size:13px;font-weight:700;z-index:999;animation:toastIn .3s ease,toastOut .3s ease 2s forwards;pointer-events:none;max-width:calc(100vw - 40px);text-align:center}
@keyframes toastIn{from{opacity:0;transform:translateX(-50%) translateY(-20px)}to{opacity:1;transform:translateX(-50%) translateY(0)}}
@keyframes toastOut{from{opacity:1}to{opacity:0}}
.skel{background:linear-gradient(90deg,var(--c3) 25%,var(--c4) 50%,var(--c3) 75%);background-size:200% 100%;animation:skel 1.5s infinite;border-radius:8px}
@keyframes skel{0%{background-position:200% 0}100%{background-position:-200% 0}}
.heart{cursor:pointer;transition:transform .2s;min-width:44px;min-height:44px;display:inline-flex;align-items:center;justify-content:center}
.heart:active{transform:scale(1.3)}
.heart.liked{color:#E85040}
.switch{width:48px;height:26px;border-radius:13px;background:var(--c4);position:relative;cursor:pointer;transition:background .2s;flex-shrink:0}
.switch.on{background:var(--gold)}
.switch::after{content:'';position:absolute;top:2px;left:2px;width:22px;height:22px;border-radius:50%;background:#fff;transition:transform .2s}
.switch.on::after{transform:translateX(22px)}
/* ═══ RESPONSIVE: Small phones (iPhone SE, Galaxy S mini) ═══ */
@media(max-width:374px){:root{--pad:14px;--font-xs:9px;--font-sm:11px;--font-md:13px;--font-lg:16px;--font-xl:19px;--card-radius:14px;--btn-radius:12px}
.nbtn{padding:4px 10px;min-width:40px}.nbtn span:last-child{font-size:8px!important}
.badge{padding:3px 8px;font-size:9px}
.bgold,.boutline{padding:12px 16px}
}
/* ═══ RESPONSIVE: Standard phones (375-429px) - default ═══ */
/* ═══ RESPONSIVE: Large phones (430-519px, iPhone Pro Max, Galaxy Ultra) ═══ */
@media(min-width:430px){:root{--pad:22px;--font-md:15px;--font-lg:19px;--font-xl:24px}}
/* ═══ RESPONSIVE: Small tablets / landscape phones (520-767px) ═══ */
@media(min-width:520px){:root{--shell-max:520px;--pad:28px;--font-xs:11px;--font-sm:13px;--font-md:15px;--font-lg:20px;--font-xl:26px;--card-radius:20px}
.badge{padding:5px 12px;font-size:11px}
.bgold,.boutline{padding:16px 24px;font-size:15px}
}
/* ═══ RESPONSIVE: Tablets (768px+) ═══ */
@media(min-width:768px){:root{--shell-max:560px;--pad:32px;--font-xs:11px;--font-sm:13px;--font-md:15px;--font-lg:22px;--font-xl:28px}
.sheet{max-width:560px;border-radius:24px 24px 0 0}
}
/* ═══ RESPONSIVE: Landscape mode ═══ */
@media(max-height:500px) and (orientation:landscape){
.screen{padding-bottom:calc(50px + var(--sai-bottom))}
.nav{padding:4px 0 calc(2px + var(--sai-bottom))}
.nbtn{gap:1px;padding:2px 10px}
}
/* ═══ Hover devices (desktop/mouse) ═══ */
@media(hover:hover){.card:hover{transform:scale(1.01);border-color:var(--borderhi)}.bgold:hover:not(:disabled){box-shadow:0 6px 28px rgba(200,168,75,0.4)}.boutline:hover{background:rgba(200,168,75,.06)}}
</style>
</head>
<body>
<div class="shell">
  <div class="screen" id="mainScreen"></div>
  <nav class="nav" id="navBar" style="display:none">
    <button class="nbtn" onclick="goTab('home')">
      <span id="ni_home" style="font-size:19px;color:var(--gold)">⌂</span>
      <span id="nl_home" style="font-size:9px;font-weight:700;letter-spacing:.05em;color:var(--gold)">START</span>
    </button>
    <button class="nbtn" onclick="goTab('explore')">
      <span id="ni_explore" style="font-size:19px;color:var(--stone)">◫</span>
      <span id="nl_explore" style="font-size:9px;font-weight:700;letter-spacing:.05em;color:var(--stone2)">TERMIN</span>
    </button>
    <button class="nbtn" onclick="goTab('favorites')">
      <span id="ni_favorites" style="font-size:19px;color:var(--stone)">♡</span>
      <span id="nl_favorites" style="font-size:9px;font-weight:700;letter-spacing:.05em;color:var(--stone2)">FAVORITEN</span>
    </button>
    <button class="nbtn" onclick="goTab('offers')">
      <span id="ni_offers" style="font-size:19px;color:var(--stone)">❋</span>
      <span id="nl_offers" style="font-size:9px;font-weight:700;letter-spacing:.05em;color:var(--stone2)">ANGEBOTE</span>
    </button>
    <button class="nbtn" onclick="goTab('account')">
      <span id="ni_account" style="font-size:19px;color:var(--stone)">◎</span>
      <span id="nl_account" style="font-size:9px;font-weight:700;letter-spacing:.05em;color:var(--stone2)">KONTO</span>
    </button>
  </nav>
</div>
<div class="overlay" id="bookingOverlay" onclick="if(event.target===this)closeBooking()">
  <div class="sheet" id="bookingSheet"></div>
</div>
<div class="overlay" id="filterOverlay" onclick="if(event.target===this)toggleFilter()">
  <div class="sheet" id="filterSheet"></div>
</div>

<script>
// ═══════════════ CHAIRMATCH LOGO SVG (v5.2) ═══════════════
function LOGO(size){
  const s=size||180;
  return `<svg width="${s}" height="${Math.round(s*1.15)}" viewBox="0 0 200 230" fill="none" xmlns="http://www.w3.org/2000/svg" style="animation:logoFloat 3s ease-in-out infinite,logoGlow 3s ease-in-out infinite;display:block">
  <defs>
    <linearGradient id="lGold" x1="0" y1="0" x2="200" y2="230" gradientUnits="userSpaceOnUse">
      <stop offset="0%" stop-color="#FFF8D0"/><stop offset="15%" stop-color="#E8C860"/>
      <stop offset="30%" stop-color="#C8A030"/><stop offset="45%" stop-color="#F5E080"/>
      <stop offset="60%" stop-color="#B8901C"/><stop offset="75%" stop-color="#E0C050"/>
      <stop offset="90%" stop-color="#FFF0A0"/><stop offset="100%" stop-color="#C8A840"/>
    </linearGradient>
    <linearGradient id="lDark" x1="0" y1="0" x2="0" y2="1" gradientUnits="objectBoundingBox">
      <stop offset="0%" stop-color="#8A6010"/><stop offset="100%" stop-color="#3A2008"/>
    </linearGradient>
    <linearGradient id="lBg" x1="0" y1="0" x2="0" y2="230" gradientUnits="userSpaceOnUse">
      <stop offset="0%" stop-color="#1A1608"/><stop offset="40%" stop-color="#120E04"/><stop offset="100%" stop-color="#060402"/>
    </linearGradient>
    <radialGradient id="rCenter" cx="50%" cy="40%" r="55%">
      <stop offset="0%" stop-color="#2A2010" stop-opacity="1"/><stop offset="100%" stop-color="#0A0802" stop-opacity="1"/>
    </radialGradient>
    <radialGradient id="rGlow" cx="50%" cy="50%" r="50%">
      <stop offset="0%" stop-color="#C8A84B" stop-opacity="0.25"/><stop offset="60%" stop-color="#C8A84B" stop-opacity="0.05"/><stop offset="100%" stop-color="#C8A84B" stop-opacity="0"/>
    </radialGradient>
    <linearGradient id="lChair" x1="0" y1="0" x2="1" y2="1" gradientUnits="objectBoundingBox">
      <stop offset="0%" stop-color="#F5E080"/><stop offset="30%" stop-color="#C8A84B"/><stop offset="60%" stop-color="#A07828"/><stop offset="100%" stop-color="#C8A84B"/>
    </linearGradient>
    <filter id="fShadow" x="-20%" y="-20%" width="140%" height="150%"><feDropShadow dx="0" dy="4" stdDeviation="6" flood-color="#000" flood-opacity="0.9"/></filter>
    <filter id="fGlow" x="-40%" y="-40%" width="180%" height="180%"><feGaussianBlur stdDeviation="3" result="b1"/><feGaussianBlur stdDeviation="8" result="b2"/><feMerge><feMergeNode in="b2"/><feMergeNode in="b1"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
    <filter id="fOuter" x="-30%" y="-20%" width="160%" height="150%"><feGaussianBlur stdDeviation="12" result="glow"/><feMerge><feMergeNode in="glow"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
    <filter id="fBevel"><feGaussianBlur in="SourceAlpha" stdDeviation="1" result="blur"/><feSpecularLighting in="blur" surfaceScale="4" specularConstant="1.2" specularExponent="12" result="spec" lighting-color="#FFF8D0"><fePointLight x="80" y="30" z="120"/></feSpecularLighting><feComposite in="spec" in2="SourceAlpha" operator="in" result="specOut"/><feBlend in="SourceGraphic" in2="specOut" mode="screen"/></filter>
    <filter id="fSparkle"><feGaussianBlur stdDeviation="1.5" result="b"/><feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
    <clipPath id="clipShield"><path d="M12 18 Q12 8 22 8 L178 8 Q188 8 188 18 L188 130 Q188 185 100 210 Q12 185 12 130 Z"/></clipPath>
    <path id="bottomArc" d="M38 176 Q100 199 162 176" fill="none"/>
  </defs>
  <ellipse cx="100" cy="115" rx="92" ry="105" fill="url(#rGlow)" style="animation:logoGlow 3s ease-in-out infinite"/>
  <path d="M14 20 Q14 10 24 10 L176 10 Q186 10 186 20 L186 132 Q186 187 100 212 Q14 187 14 132 Z" fill="#0A0800" transform="translate(4,6)" opacity="0.9"/>
  <path d="M10 18 L14 20 L14 132 Q14 187 100 212 L98 216 Q8 190 8 134 Z" fill="url(#lDark)" opacity="0.8"/>
  <path d="M190 18 L186 20 L186 132 Q186 187 100 212 L102 216 Q192 190 192 134 Z" fill="url(#lDark)" opacity="0.6"/>
  <path d="M100 216 L98 212 Q14 187 14 132 L10 134 Q8 190 100 220 Z" fill="#6A4A10" opacity="0.7"/>
  <path d="M12 18 Q12 8 22 8 L178 8 Q188 8 188 18 L188 130 Q188 185 100 210 Q12 185 12 130 Z" fill="url(#lBg)"/>
  <path d="M12 18 Q12 8 22 8 L178 8 Q188 8 188 18 L188 130 Q188 185 100 210 Q12 185 12 130 Z" fill="url(#rCenter)"/>
  <path d="M12 18 Q12 8 22 8 L178 8 Q188 8 188 18 L188 130 Q188 185 100 210 Q12 185 12 130 Z" fill="none" stroke="url(#lGold)" stroke-width="4" opacity="0.4" style="filter:blur(2px)"/>
  <path d="M12 18 Q12 8 22 8 L178 8 Q188 8 188 18 L188 130 Q188 185 100 210 Q12 185 12 130 Z" fill="none" stroke="url(#lGold)" stroke-width="2.5"/>
  <path d="M18 20 Q18 14 26 14 L174 14 Q182 14 182 20 L182 128 Q182 180 100 204 Q18 180 18 128 Z" fill="none" stroke="url(#lGold)" stroke-width="0.8" opacity="0.5"/>
  <path d="M24 23 Q24 18 30 18 L170 18 Q176 18 176 23 L176 126 Q176 174 100 198 Q24 174 24 126 Z" fill="none" stroke="url(#lGold)" stroke-width="0.4" opacity="0.25"/>
  <g clip-path="url(#clipShield)">
  <g transform="translate(22,12)"><path d="M0 8 L4 0 L8 8 L4 14 Z" fill="url(#lGold)" opacity="0.9"/><path d="M0 8 L4 4 L4 14 Z" fill="#FFF8D0" opacity="0.4"/></g>
  <g transform="translate(168,12)"><path d="M0 8 L4 0 L8 8 L4 14 Z" fill="url(#lGold)" opacity="0.9"/><path d="M0 8 L4 4 L4 14 Z" fill="#FFF8D0" opacity="0.4"/></g>
  <path d="M34 20 Q28 20 26 26 Q24 32 30 34 Q22 34 20 40" stroke="url(#lGold)" stroke-width="1.2" fill="none" stroke-linecap="round" opacity="0.6"/>
  <path d="M166 20 Q172 20 174 26 Q176 32 170 34 Q178 34 180 40" stroke="url(#lGold)" stroke-width="1.2" fill="none" stroke-linecap="round" opacity="0.6"/>
  <line x1="38" y1="44" x2="162" y2="44" stroke="url(#lGold)" stroke-width="0.6" opacity="0.35"/>
  <path d="M100 40 L102.5 44 L100 48 L97.5 44 Z" fill="url(#lGold)" opacity="0.6"/>
  <text x="101" y="95" text-anchor="middle" fill="#3A2808" font-size="38" font-weight="900" font-family="Cinzel,Georgia,serif" letter-spacing="6">CHAIR</text>
  <text x="100" y="94" text-anchor="middle" fill="url(#lGold)" font-size="38" font-weight="900" font-family="Cinzel,Georgia,serif" letter-spacing="6" filter="url(#fBevel)">CHAIR</text>
  <text x="100" y="93" text-anchor="middle" fill="#FFF8D0" font-size="38" font-weight="900" font-family="Cinzel,Georgia,serif" letter-spacing="6" opacity="0.18">CHAIR</text>
  <line x1="28" y1="106" x2="172" y2="106" stroke="url(#lGold)" stroke-width="1" opacity="0.5"/>
  <line x1="28" y1="109" x2="172" y2="109" stroke="url(#lGold)" stroke-width="0.4" opacity="0.2"/>
  <path d="M100 101 L104 106 L100 111 L96 106 Z" fill="url(#lGold)" opacity="0.95"/>
  <path d="M100 103 L102.5 106 L100 109 Z" fill="#FFF8D0" opacity="0.4"/>
  <path d="M78 104 L80.5 106 L78 108 L75.5 106 Z" fill="url(#lGold)" opacity="0.6"/>
  <path d="M122 104 L124.5 106 L122 108 L119.5 106 Z" fill="url(#lGold)" opacity="0.6"/>
  <circle cx="60" cy="106" r="1.2" fill="url(#lGold)" opacity="0.45"/>
  <circle cx="140" cy="106" r="1.2" fill="url(#lGold)" opacity="0.45"/>
  <circle cx="46" cy="106" r="0.8" fill="url(#lGold)" opacity="0.3"/>
  <circle cx="154" cy="106" r="0.8" fill="url(#lGold)" opacity="0.3"/>
  <text x="101" y="148" text-anchor="middle" fill="#3A2808" font-size="38" font-weight="900" font-family="Cinzel,Georgia,serif" letter-spacing="6">MATCH</text>
  <text x="100" y="147" text-anchor="middle" fill="url(#lGold)" font-size="38" font-weight="900" font-family="Cinzel,Georgia,serif" letter-spacing="6" filter="url(#fBevel)">MATCH</text>
  <text x="100" y="146" text-anchor="middle" fill="#FFF8D0" font-size="38" font-weight="900" font-family="Cinzel,Georgia,serif" letter-spacing="6" opacity="0.18">MATCH</text>
  <line x1="38" y1="160" x2="162" y2="160" stroke="url(#lGold)" stroke-width="0.6" opacity="0.35"/>
  <path d="M100 156 L102.5 160 L100 164 L97.5 160 Z" fill="url(#lGold)" opacity="0.6"/>
  <text fill="url(#lGold)" font-size="6.5" font-weight="400" font-family="Cinzel,Georgia,serif" letter-spacing="2.5" opacity="0.65"><textPath href="#bottomArc" startOffset="50%" text-anchor="middle">DEUTSCHLAND · EST. 2026</textPath></text>
  </g>
  <g filter="url(#fSparkle)" fill="url(#lGold)">
    <g style="animation:sparkle 2.4s ease-in-out infinite;animation-delay:0s;transform-origin:28px 35px"><path d="M28 30 L29.2 33.5 L33 34.5 L29.2 35.5 L28 39 L26.8 35.5 L23 34.5 L26.8 33.5 Z" opacity="0.9"/></g>
    <g style="animation:sparkle 2.4s ease-in-out infinite;animation-delay:0.8s;transform-origin:172px 35px"><path d="M172 30 L173.2 33.5 L177 34.5 L173.2 35.5 L172 39 L170.8 35.5 L167 34.5 L170.8 33.5 Z" opacity="0.9"/></g>
    <g style="animation:sparkle 2.4s ease-in-out infinite;animation-delay:1.6s;transform-origin:100px 22px"><path d="M100 18 L101 21 L104 22 L101 23 L100 26 L99 23 L96 22 L99 21 Z" opacity="0.75"/></g>
    <g style="animation:sparkle 2.8s ease-in-out infinite;animation-delay:0.4s;transform-origin:48px 155px"><path d="M48 152 L49 154.5 L51.5 155.5 L49 156.5 L48 159 L47 156.5 L44.5 155.5 L47 154.5 Z" opacity="0.6"/></g>
    <g style="animation:sparkle 2.8s ease-in-out infinite;animation-delay:1.2s;transform-origin:152px 155px"><path d="M152 152 L153 154.5 L155.5 155.5 L153 156.5 L152 159 L151 156.5 L148.5 155.5 L151 154.5 Z" opacity="0.6"/></g>
  </g>
  <path d="M14 75 Q8 68 10 60 Q12 52 18 54 Q13 56 14 62 Q15 68 20 70 Q14 72 14 78 Q14 84 20 86 Q13 86 12 92" stroke="url(#lGold)" stroke-width="1.2" fill="none" stroke-linecap="round" opacity="0.55"/>
  <path d="M14 62 Q10 58 12 53" stroke="url(#lGold)" stroke-width="0.8" fill="none" opacity="0.35"/>
  <path d="M186 75 Q192 68 190 60 Q188 52 182 54 Q187 56 186 62 Q185 68 180 70 Q186 72 186 78 Q186 84 180 86 Q187 86 188 92" stroke="url(#lGold)" stroke-width="1.2" fill="none" stroke-linecap="round" opacity="0.55"/>
  <path d="M186 62 Q190 58 188 53" stroke="url(#lGold)" stroke-width="0.8" fill="none" opacity="0.35"/>
</svg>`;}

// ─── LOGO HEADER (v5.2 style with LOGO()) ───
function logoHeader(small){
  if(small) return `<div style="display:flex;align-items:center;gap:10px;min-width:0;flex-shrink:1">
    <div style="animation:logoFloat 3s ease-in-out infinite,logoGlow 3s ease-in-out infinite;display:inline-block;flex-shrink:0">
      ${LOGO(38)}
    </div>
    <div style="min-width:0">
      <p class="cinzel" style="font-size:15px;font-weight:700;letter-spacing:2px;color:var(--gold2);line-height:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">CHAIR<span style="color:var(--gold3)">MATCH</span></p>
      <p style="font-size:8px;letter-spacing:3px;color:var(--stone);margin-top:2px">DEUTSCHLAND</p>
    </div>
  </div>`;
  return `<div style="display:flex;flex-direction:column;align-items:center;padding:16px 0 10px">
    ${LOGO(120)}
  </div>`;}

// ─── CATEGORY SVG ICONS (luxury gold, detailed) ───
function catSVG(type){
  const ids={barber:"gBa",friseur:"gFr",kosmetik:"gKo",aesthetik:"gAe",nail:"gNa",massage:"gMa",lash:"gLa",arzt:"gAr",raum:"gRa",opraum:"gOp"};
  const id=ids[type];if(!id)return"";
  const hd=`<defs><linearGradient id="${id}" x1="0" y1="0" x2="64" y2="64"><stop offset="0%" stop-color="#FFF0C0"/><stop offset="30%" stop-color="#E0C060"/><stop offset="60%" stop-color="#C8A84B"/><stop offset="100%" stop-color="#A08030"/></linearGradient><linearGradient id="${id}h" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FFF8D0" stop-opacity=".5"/><stop offset="100%" stop-color="#C8A84B" stop-opacity="0"/></linearGradient></defs>`;
  const g=`url(#${id})`;const gh=`url(#${id}h)`;
  const sk=(x,y,r,o)=>`<path d="M${x} ${y-r}L${x+r*.32} ${y-r*.32}L${x+r} ${y}L${x+r*.32} ${y+r*.32}L${x} ${y+r}L${x-r*.32} ${y+r*.32}L${x-r} ${y}L${x-r*.32} ${y-r*.32}Z" fill="${g}" opacity="${o}"/>`;
  const w=`<svg width="34" height="34" viewBox="0 0 64 64" fill="none">`;

  if(type==="barber") return `${w}${hd}
    <rect x="24" y="10" width="16" height="46" rx="8" fill="${gh}"/>
    <rect x="24" y="10" width="16" height="46" rx="8" fill="none" stroke="${g}" stroke-width="2.2"/>
    <ellipse cx="32" cy="10" rx="9" ry="5" fill="${g}" opacity=".8"/>
    <ellipse cx="32" cy="9" rx="5" ry="2.5" fill="#FFF0C0" opacity=".3"/>
    <rect x="20" y="55" width="24" height="5" rx="2.5" fill="${g}" opacity=".6"/>
    <clipPath id="cpBa"><rect x="24" y="10" width="16" height="46" rx="8"/></clipPath>
    <g clip-path="url(#cpBa)"><path d="M22 16L42 26M22 26L42 36M22 36L42 46M22 46L42 56" stroke="${g}" stroke-width="3.5" opacity=".3"/></g>
    <line x1="24" y1="14" x2="24" y2="56" stroke="${g}" stroke-width=".5" opacity=".25"/>
    <line x1="40" y1="14" x2="40" y2="56" stroke="${g}" stroke-width=".5" opacity=".25"/>
    ${sk(14,14,4,.9)}${sk(52,10,3,.75)}${sk(54,48,3.5,.8)}${sk(12,48,2.5,.6)}
  </svg>`;

  if(type==="friseur") return `${w}${hd}
    <g transform="rotate(-25 32 28)" opacity=".4">
      <rect x="29" y="2" width="6" height="52" rx="1.5" fill="none" stroke="${g}" stroke-width="1.5"/>
      <line x1="29" y1="7" x2="35" y2="7" stroke="${g}" stroke-width=".8"/>
      <line x1="29" y1="11" x2="35" y2="11" stroke="${g}" stroke-width=".8"/>
      <line x1="29" y1="15" x2="35" y2="15" stroke="${g}" stroke-width=".8"/>
      <line x1="29" y1="19" x2="35" y2="19" stroke="${g}" stroke-width=".8"/>
      <line x1="29" y1="23" x2="35" y2="23" stroke="${g}" stroke-width=".8"/>
      <line x1="29" y1="27" x2="35" y2="27" stroke="${g}" stroke-width=".8"/>
      <line x1="29" y1="31" x2="35" y2="31" stroke="${g}" stroke-width=".8"/>
      <line x1="29" y1="35" x2="35" y2="35" stroke="${g}" stroke-width=".8"/>
      <line x1="29" y1="39" x2="35" y2="39" stroke="${g}" stroke-width=".8"/>
      <line x1="29" y1="43" x2="35" y2="43" stroke="${g}" stroke-width=".8"/>
      <line x1="29" y1="47" x2="35" y2="47" stroke="${g}" stroke-width=".8"/>
    </g>
    <path d="M20 10 Q28 22 31 32" fill="none" stroke="${g}" stroke-width="2.8" stroke-linecap="round"/>
    <path d="M44 10 Q36 22 33 32" fill="none" stroke="${g}" stroke-width="2.8" stroke-linecap="round"/>
    <circle cx="32" cy="30" r="2.5" fill="${g}"/>
    <circle cx="32" cy="30" r="1" fill="#FFF0C0" opacity=".4"/>
    <path d="M27 36 Q30 33 32 30" fill="none" stroke="${g}" stroke-width="2.2" stroke-linecap="round"/>
    <path d="M37 36 Q34 33 32 30" fill="none" stroke="${g}" stroke-width="2.2" stroke-linecap="round"/>
    <circle cx="24" cy="42" r="6.5" fill="none" stroke="${g}" stroke-width="2"/>
    <circle cx="24" cy="42" r="2.5" fill="${g}" opacity=".2"/>
    <circle cx="40" cy="42" r="6.5" fill="none" stroke="${g}" stroke-width="2"/>
    <circle cx="40" cy="42" r="2.5" fill="${g}" opacity=".2"/>
    ${sk(12,16,3,.85)}${sk(52,14,2.5,.7)}${sk(50,56,2,.6)}
  </svg>`;

  if(type==="kosmetik") return `${w}${hd}
    <!-- Kosmetik-Liege (reclined chair with mirror) -->
    <rect x="8" y="32" width="38" height="24" rx="4" fill="${gh}"/>
    <rect x="8" y="32" width="38" height="24" rx="4" fill="none" stroke="${g}" stroke-width="2"/>
    <!-- liege body stitching -->
    <line x1="18" y1="34" x2="18" y2="54" stroke="${g}" stroke-width=".7" opacity=".3"/>
    <line x1="28" y1="33" x2="28" y2="55" stroke="${g}" stroke-width=".7" opacity=".3"/>
    <line x1="38" y1="34" x2="38" y2="54" stroke="${g}" stroke-width=".7" opacity=".3"/>
    <!-- reclined backrest -->
    <path d="M8 32 L4 14 Q3 8 9 8 L30 8 Q36 8 35 14 L32 32" fill="${gh}"/>
    <path d="M8 32 L4 14 Q3 8 9 8 L30 8 Q36 8 35 14 L32 32" fill="none" stroke="${g}" stroke-width="2"/>
    <line x1="14" y1="10" x2="12" y2="30" stroke="${g}" stroke-width=".7" opacity=".3"/>
    <line x1="22" y1="9" x2="21" y2="31" stroke="${g}" stroke-width=".7" opacity=".3"/>
    <!-- headrest pillow -->
    <path d="M6 12 Q4 6 10 6 L28 6 Q34 6 33 12" fill="none" stroke="${g}" stroke-width="1.5" opacity=".5"/>
    <!-- legs -->
    <rect x="12" y="56" width="3" height="6" rx="1" fill="${g}" opacity=".6"/>
    <rect x="38" y="56" width="3" height="6" rx="1" fill="${g}" opacity=".6"/>
    <!-- magnifying lamp -->
    <circle cx="52" cy="16" r="8" fill="none" stroke="${g}" stroke-width="2" opacity=".75"/>
    <circle cx="52" cy="16" r="4" fill="${g}" opacity=".15"/>
    <circle cx="50" cy="14" r="1.2" fill="#FFF0C0" opacity=".4"/>
    <rect x="51" y="24" width="2" height="16" rx="1" fill="${g}" opacity=".5"/>
    <rect x="48" y="40" width="8" height="3" rx="1.5" fill="${g}" opacity=".5"/>
    ${sk(58,8,3,.85)}${sk(4,50,2.5,.7)}${sk(50,54,2,.6)}
  </svg>`;

  if(type==="aesthetik") return `${w}${hd}
    <g transform="rotate(-45 32 32)">
      <rect x="16" y="26" width="36" height="12" rx="2" fill="${gh}"/>
      <rect x="16" y="26" width="36" height="12" rx="2" fill="none" stroke="${g}" stroke-width="2"/>
      <rect x="20" y="29" width="5" height="6" rx="1" fill="${g}" opacity=".35"/>
      <line x1="30" y1="27" x2="30" y2="37" stroke="${g}" stroke-width=".7" opacity=".35"/>
      <line x1="34" y1="27" x2="34" y2="37" stroke="${g}" stroke-width=".7" opacity=".35"/>
      <line x1="38" y1="27" x2="38" y2="37" stroke="${g}" stroke-width=".7" opacity=".35"/>
      <line x1="42" y1="27" x2="42" y2="37" stroke="${g}" stroke-width=".7" opacity=".35"/>
      <line x1="46" y1="27" x2="46" y2="37" stroke="${g}" stroke-width=".7" opacity=".35"/>
      <rect x="6" y="28" width="12" height="8" rx="1.5" fill="${g}" opacity=".5"/>
      <rect x="6" y="28" width="12" height="8" rx="1.5" fill="none" stroke="${g}" stroke-width="1"/>
      <path d="M52 30 L58 32 L52 34" fill="${g}" opacity=".6"/>
      <line x1="58" y1="32" x2="63" y2="32" stroke="${g}" stroke-width="1.8" stroke-linecap="round"/>
    </g>
    ${sk(10,10,3.5,.9)}${sk(54,8,2.5,.7)}${sk(56,54,3,.8)}${sk(8,52,2.5,.65)}
  </svg>`;

  if(type==="nail") return `${w}${hd}
    <path d="M18 56 Q14 44 16 34 Q18 24 22 18 Q26 14 30 16 Q34 18 35 26 L36 56 Z" fill="${gh}"/>
    <path d="M18 56 Q14 44 16 34 Q18 24 22 18 Q26 14 30 16 Q34 18 35 26 L36 56" fill="none" stroke="${g}" stroke-width="2.2" stroke-linecap="round"/>
    <path d="M20 36 Q22 24 26 18" fill="none" stroke="${g}" stroke-width="1" opacity=".35" stroke-linecap="round"/>
    <path d="M24 56 Q22 48 22 40" fill="none" stroke="${g}" stroke-width=".8" opacity=".25" stroke-linecap="round"/>
    <path d="M44 12 L46 8 Q48 5 50 8 L48 14 L42 40 Q40 46 38 48" fill="none" stroke="${g}" stroke-width="2.2" stroke-linecap="round"/>
    <path d="M44 12 L46 8 Q48 5 50 8 L48 14 Z" fill="${g}" opacity=".6"/>
    <line x1="45" y1="14" x2="42" y2="36" stroke="${g}" stroke-width="1.2" opacity=".4" stroke-linecap="round"/>
    ${sk(52,4,3,.9)}${sk(10,12,2.5,.7)}${sk(50,46,3,.8)}${sk(8,46,2,.6)}
  </svg>`;

  if(type==="massage") return `${w}${hd}
    <!-- Massage-Liege (flat table with face hole) -->
    <rect x="4" y="24" width="48" height="20" rx="5" fill="${gh}"/>
    <rect x="4" y="24" width="48" height="20" rx="5" fill="none" stroke="${g}" stroke-width="2"/>
    <!-- stitching -->
    <line x1="16" y1="26" x2="16" y2="42" stroke="${g}" stroke-width=".7" opacity=".3"/>
    <line x1="28" y1="25" x2="28" y2="43" stroke="${g}" stroke-width=".7" opacity=".3"/>
    <line x1="40" y1="26" x2="40" y2="42" stroke="${g}" stroke-width=".7" opacity=".3"/>
    <!-- top cushion shine -->
    <path d="M8 28 Q28 24 48 28" stroke="#FFF0C0" stroke-width="1.2" fill="none" opacity=".15"/>
    <!-- face hole cutout -->
    <ellipse cx="10" cy="22" rx="6" ry="4" fill="none" stroke="${g}" stroke-width="1.8" opacity=".7"/>
    <ellipse cx="10" cy="22" rx="3" ry="2" fill="${g}" opacity=".15"/>
    <!-- pillow/towel roll -->
    <ellipse cx="28" cy="16" rx="16" ry="5" fill="${gh}" opacity=".6"/>
    <ellipse cx="28" cy="16" rx="16" ry="5" fill="none" stroke="${g}" stroke-width="1.2" opacity=".5"/>
    <ellipse cx="28" cy="15" rx="8" ry="2" fill="#FFF0C0" opacity=".15"/>
    <!-- 4 legs -->
    <rect x="8" y="44" width="2.5" height="10" rx="1" fill="${g}" opacity=".6"/>
    <rect x="44" y="44" width="2.5" height="10" rx="1" fill="${g}" opacity=".6"/>
    <rect x="20" y="44" width="2.5" height="10" rx="1" fill="${g}" opacity=".5"/>
    <rect x="32" y="44" width="2.5" height="10" rx="1" fill="${g}" opacity=".5"/>
    <!-- spa hands icon -->
    <path d="M52 40 Q56 36 58 32 Q59 28 57 26 Q55 24 53 26 Q51 28 51 32" fill="none" stroke="${g}" stroke-width="1.5" stroke-linecap="round" opacity=".5"/>
    <path d="M53 26 L53 22 Q53 20 55 20" fill="none" stroke="${g}" stroke-width="1.2" stroke-linecap="round" opacity=".4"/>
    ${sk(56,14,3,.8)}${sk(4,10,2.5,.7)}${sk(56,52,2.5,.65)}${sk(4,52,2,.6)}
  </svg>`;

  if(type==="lash") return `${w}${hd}
    <path d="M6 34 Q18 20 32 20 Q46 20 58 34" fill="none" stroke="${g}" stroke-width="2.2" stroke-linecap="round"/>
    <path d="M6 34 Q18 46 32 46 Q46 46 58 34" fill="none" stroke="${g}" stroke-width="2.2" stroke-linecap="round"/>
    <ellipse cx="32" cy="33" rx="8" ry="7" fill="${g}" opacity=".25"/>
    <circle cx="32" cy="33" r="4.5" fill="${g}" opacity=".6"/>
    <circle cx="32" cy="33" r="2.2" fill="${g}"/>
    <circle cx="33.5" cy="31.5" r="1" fill="#FFF0C0" opacity=".45"/>
    <path d="M12 28 L9 18" stroke="${g}" stroke-width="2" stroke-linecap="round" opacity=".7"/>
    <path d="M18 24 L15 14" stroke="${g}" stroke-width="2" stroke-linecap="round" opacity=".75"/>
    <path d="M24 21 L22 10" stroke="${g}" stroke-width="2" stroke-linecap="round" opacity=".8"/>
    <path d="M32 20 L32 8" stroke="${g}" stroke-width="2" stroke-linecap="round" opacity=".85"/>
    <path d="M40 21 L42 10" stroke="${g}" stroke-width="2" stroke-linecap="round" opacity=".8"/>
    <path d="M46 24 L49 14" stroke="${g}" stroke-width="2" stroke-linecap="round" opacity=".75"/>
    <path d="M52 28 L55 18" stroke="${g}" stroke-width="2" stroke-linecap="round" opacity=".7"/>
    <path d="M9 14 Q20 6 32 6 Q44 6 55 14" fill="none" stroke="${g}" stroke-width="1.8" stroke-linecap="round" opacity=".45"/>
    ${sk(4,10,2.5,.8)}${sk(60,10,2.5,.8)}${sk(32,54,2,.6)}
  </svg>`;

  if(type==="arzt") return `${w}${hd}
    <rect x="8" y="8" width="48" height="48" rx="12" fill="${gh}"/>
    <rect x="8" y="8" width="48" height="48" rx="12" fill="none" stroke="${g}" stroke-width="2.2"/>
    <rect x="26" y="16" width="12" height="32" rx="2.5" fill="${g}" opacity=".7"/>
    <rect x="16" y="26" width="32" height="12" rx="2.5" fill="${g}" opacity=".7"/>
    <rect x="28" y="18" width="8" height="28" rx="1.5" fill="#FFF0C0" opacity=".12"/>
    <rect x="18" y="28" width="28" height="8" rx="1.5" fill="#FFF0C0" opacity=".12"/>
    ${sk(32,32,3.5,.95)}${sk(14,14,2.5,.7)}${sk(50,14,2,.65)}${sk(50,50,2.5,.7)}${sk(14,50,2,.6)}
  </svg>`;

  if(type==="raum") return `${w}${hd}
    <!-- Raum / Kabine / Freelancer Space (door + key) -->
    <rect x="10" y="8" width="34" height="48" rx="3" fill="${gh}"/>
    <rect x="10" y="8" width="34" height="48" rx="3" fill="none" stroke="${g}" stroke-width="2.2"/>
    <!-- door panel lines -->
    <rect x="14" y="12" width="26" height="18" rx="1.5" fill="none" stroke="${g}" stroke-width="1" opacity=".35"/>
    <rect x="14" y="34" width="26" height="18" rx="1.5" fill="none" stroke="${g}" stroke-width="1" opacity=".35"/>
    <!-- door handle -->
    <circle cx="38" cy="32" r="3" fill="${g}" opacity=".7"/>
    <circle cx="38" cy="32" r="1.5" fill="#FFF0C0" opacity=".3"/>
    <!-- key icon (right side) -->
    <circle cx="54" cy="22" r="6" fill="none" stroke="${g}" stroke-width="2" opacity=".75"/>
    <circle cx="54" cy="22" r="2.5" fill="${g}" opacity=".25"/>
    <line x1="54" y1="28" x2="54" y2="42" stroke="${g}" stroke-width="2.2" stroke-linecap="round" opacity=".7"/>
    <line x1="54" y1="36" x2="58" y2="36" stroke="${g}" stroke-width="1.8" stroke-linecap="round" opacity=".5"/>
    <line x1="54" y1="40" x2="58" y2="40" stroke="${g}" stroke-width="1.8" stroke-linecap="round" opacity=".5"/>
    <!-- sparkle accents -->
    ${sk(6,6,3,.85)}${sk(48,10,2.5,.7)}${sk(8,54,2.5,.65)}${sk(56,52,2,.6)}
  </svg>`;

  if(type==="opraum") return `${w}${hd}
    <!-- OP-Raum / Steriler Operationssaal -->
    <!-- OP-Tisch -->
    <rect x="6" y="30" width="42" height="14" rx="3" fill="${gh}"/>
    <rect x="6" y="30" width="42" height="14" rx="3" fill="none" stroke="${g}" stroke-width="2"/>
    <line x1="16" y1="32" x2="16" y2="42" stroke="${g}" stroke-width=".7" opacity=".3"/>
    <line x1="27" y1="31" x2="27" y2="43" stroke="${g}" stroke-width=".7" opacity=".3"/>
    <line x1="38" y1="32" x2="38" y2="42" stroke="${g}" stroke-width=".7" opacity=".3"/>
    <!-- Tischbein (Hydraulik) -->
    <rect x="22" y="44" width="10" height="4" rx="1" fill="${g}" opacity=".5"/>
    <rect x="25" y="48" width="4" height="8" rx="1" fill="${g}" opacity=".6"/>
    <rect x="18" y="56" width="18" height="3" rx="1.5" fill="${g}" opacity=".5"/>
    <!-- OP-Lampe (oben) -->
    <line x1="32" y1="4" x2="32" y2="14" stroke="${g}" stroke-width="2" opacity=".6"/>
    <line x1="24" y1="4" x2="40" y2="4" stroke="${g}" stroke-width="1.5" opacity=".5"/>
    <ellipse cx="32" cy="18" rx="12" ry="5" fill="${gh}" opacity=".5"/>
    <ellipse cx="32" cy="18" rx="12" ry="5" fill="none" stroke="${g}" stroke-width="2" opacity=".8"/>
    <ellipse cx="32" cy="17" rx="6" ry="2.5" fill="#FFF0C0" opacity=".25"/>
    <circle cx="28" cy="17" r="1.5" fill="#FFF0C0" opacity=".4"/>
    <circle cx="32" cy="17" r="1.5" fill="#FFF0C0" opacity=".4"/>
    <circle cx="36" cy="17" r="1.5" fill="#FFF0C0" opacity=".4"/>
    <!-- Kreuz-Symbol (steril) -->
    <rect x="52" y="10" width="8" height="2.5" rx="1" fill="${g}" opacity=".7"/>
    <rect x="55" y="7" width="2.5" height="8" rx="1" fill="${g}" opacity=".7"/>
    <!-- Monitor/Puls -->
    <rect x="50" y="26" width="12" height="10" rx="2" fill="none" stroke="${g}" stroke-width="1.5" opacity=".6"/>
    <path d="M52 31 L54 31 L55 28 L56.5 34 L58 31 L60 31" fill="none" stroke="${g}" stroke-width="1.2" stroke-linecap="round" opacity=".5"/>
    ${sk(4,8,3,.85)}${sk(60,4,2.5,.7)}${sk(4,52,2.5,.65)}${sk(60,54,2,.6)}
  </svg>`;

  return "";}

// ─── MINI RENTAL ICONS (26px, gold, premium quality) ───
function rentalIcon(type){
  const w=`<svg width="26" height="26" viewBox="0 0 32 32" fill="none">`;
  const g="#C8A84B";const g2="#E8D06A";const g3="#FFF0C0";
  if(type==="stuhl") return `${w}
    <rect x="10" y="4" width="12" height="24" rx="6" fill="none" stroke="${g}" stroke-width="1.5"/>
    <ellipse cx="16" cy="4" rx="6.5" ry="3" fill="${g}" opacity=".6"/>
    <ellipse cx="16" cy="3.5" rx="3.5" ry="1.5" fill="${g3}" opacity=".25"/>
    <rect x="8" y="27" width="16" height="3" rx="1.5" fill="${g}" opacity=".5"/>
    <line x1="10" y1="8" x2="22" y2="14" stroke="${g}" stroke-width="1.5" opacity=".2"/>
    <line x1="10" y1="14" x2="22" y2="20" stroke="${g}" stroke-width="1.5" opacity=".2"/>
    <line x1="10" y1="20" x2="22" y2="26" stroke="${g}" stroke-width="1.5" opacity=".2"/>
  </svg>`;
  if(type==="liege") return `${w}
    <rect x="2" y="14" width="24" height="10" rx="3" fill="none" stroke="${g}" stroke-width="1.5"/>
    <path d="M4 14 L2 6 Q2 3 5 3 L16 3 Q19 3 18 6 L16 14" fill="none" stroke="${g}" stroke-width="1.2" opacity=".7"/>
    <ellipse cx="14" cy="9" rx="8" ry="3" fill="none" stroke="${g}" stroke-width=".8" opacity=".4"/>
    <rect x="5" y="24" width="2" height="5" rx=".8" fill="${g}" opacity=".5"/>
    <rect x="21" y="24" width="2" height="5" rx=".8" fill="${g}" opacity=".5"/>
    <circle cx="27" cy="10" r="4" fill="none" stroke="${g}" stroke-width="1.2" opacity=".6"/>
    <circle cx="27" cy="10" r="1.5" fill="${g3}" opacity=".3"/>
  </svg>`;
  if(type==="raum") return `${w}
    <rect x="5" y="3" width="18" height="26" rx="2" fill="none" stroke="${g}" stroke-width="1.5"/>
    <rect x="8" y="6" width="12" height="9" rx="1" fill="none" stroke="${g}" stroke-width=".8" opacity=".3"/>
    <rect x="8" y="18" width="12" height="9" rx="1" fill="none" stroke="${g}" stroke-width=".8" opacity=".3"/>
    <circle cx="20" cy="16" r="1.8" fill="${g}" opacity=".6"/>
    <circle cx="28" cy="12" r="3" fill="none" stroke="${g}" stroke-width="1.2" opacity=".6"/>
    <line x1="28" y1="15" x2="28" y2="22" stroke="${g}" stroke-width="1.2" opacity=".5"/>
    <line x1="28" y1="19" x2="30" y2="19" stroke="${g}" stroke-width="1" opacity=".4"/>
  </svg>`;
  if(type==="opraum") return `${w}
    <rect x="3" y="14" width="22" height="8" rx="2" fill="none" stroke="${g}" stroke-width="1.5"/>
    <line x1="10" y1="15" x2="10" y2="21" stroke="${g}" stroke-width=".6" opacity=".3"/>
    <line x1="17" y1="15" x2="17" y2="21" stroke="${g}" stroke-width=".6" opacity=".3"/>
    <rect x="11" y="22" width="6" height="3" rx=".8" fill="${g}" opacity=".4"/>
    <rect x="13" y="25" width="2" height="4" rx=".5" fill="${g}" opacity=".5"/>
    <rect x="9" y="29" width="10" height="2" rx="1" fill="${g}" opacity=".4"/>
    <line x1="14" y1="2" x2="14" y2="8" stroke="${g}" stroke-width="1.2" opacity=".5"/>
    <ellipse cx="14" cy="10" rx="6" ry="3" fill="none" stroke="${g}" stroke-width="1.2" opacity=".7"/>
    <circle cx="12" cy="10" r=".8" fill="${g3}" opacity=".4"/>
    <circle cx="14" cy="10" r=".8" fill="${g3}" opacity=".4"/>
    <circle cx="16" cy="10" r=".8" fill="${g3}" opacity=".4"/>
    <rect x="25" y="5" width="4" height="1.5" rx=".5" fill="${g}" opacity=".6"/>
    <rect x="26.2" y="3.5" width="1.5" height="4" rx=".5" fill="${g}" opacity=".6"/>
  </svg>`;
  return "";
}

// ─── PREMIUM CLASSIC BARBER CHAIR ───
function dbSeat(){
  return `<svg width="140" height="155" viewBox="0 0 280 310" fill="none" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="bcBlk" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#3A3A3A"/><stop offset="30%" stop-color="#1A1A1A"/><stop offset="70%" stop-color="#0E0E0E"/><stop offset="100%" stop-color="#222"/>
    </linearGradient>
    <linearGradient id="bcBlkH" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#111"/><stop offset="35%" stop-color="#383838"/><stop offset="55%" stop-color="#1E1E1E"/><stop offset="100%" stop-color="#0A0A0A"/>
    </linearGradient>
    <linearGradient id="bcChr" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#F0ECE8"/><stop offset="20%" stop-color="#D8D0C8"/><stop offset="45%" stop-color="#E8E4E0"/><stop offset="70%" stop-color="#A8A098"/><stop offset="100%" stop-color="#C8C0B8"/>
    </linearGradient>
    <linearGradient id="bcChrH" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#908880"/><stop offset="25%" stop-color="#F0E8E0"/><stop offset="50%" stop-color="#B8B0A8"/><stop offset="75%" stop-color="#E0D8D0"/><stop offset="100%" stop-color="#807870"/>
    </linearGradient>
    <linearGradient id="bcGd" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#F5E8B0"/><stop offset="25%" stop-color="#D4B050"/><stop offset="50%" stop-color="#E8D078"/><stop offset="75%" stop-color="#C8A040"/><stop offset="100%" stop-color="#A88828"/>
    </linearGradient>
    <radialGradient id="bcShn" cx=".35" cy=".25" r=".65">
      <stop offset="0%" stop-color="#555" stop-opacity=".6"/><stop offset="100%" stop-color="#000" stop-opacity="0"/>
    </radialGradient>
    <filter id="bcS"><feDropShadow dx="1" dy="3" stdDeviation="3" flood-color="#000" flood-opacity=".55"/></filter>
    <filter id="bcGw"><feDropShadow dx="0" dy="0" stdDeviation="4" flood-color="#C8A84B" flood-opacity=".3"/></filter>
  </defs>

  <!-- FLOOR SHADOW -->
  <ellipse cx="140" cy="302" rx="80" ry="8" fill="#000" opacity=".4"/>

  <!-- === STAR BASE === -->
  <g filter="url(#bcS)">
    <path d="M140 290 L52 296 Q44 297 44 292 L44 286 Q44 282 52 282 L140 278 L228 282 Q236 282 236 286 L236 292 Q236 297 228 296 Z" fill="url(#bcChr)"/>
    <ellipse cx="44" cy="290" rx="12" ry="7" fill="url(#bcChr)"/>
    <ellipse cx="236" cy="290" rx="12" ry="7" fill="url(#bcChr)"/>
    <ellipse cx="44" cy="288" rx="8" ry="4" fill="#F0E8E0" opacity=".4"/>
    <ellipse cx="236" cy="288" rx="8" ry="4" fill="#F0E8E0" opacity=".4"/>
    <path d="M60 283 Q140 278 220 283" stroke="#FFF" stroke-width="1.5" fill="none" opacity=".25"/>
  </g>

  <!-- === HYDRAULIC PUMP === -->
  <g filter="url(#bcS)">
    <rect x="126" y="240" width="28" height="44" rx="14" fill="url(#bcChr)"/>
    <rect x="129" y="242" width="6" height="40" rx="3" fill="#F8F0E8" opacity=".3"/>
    <rect x="122" y="260" width="36" height="8" rx="4" fill="url(#bcChrH)"/>
    <path d="M124 262 L156 262" stroke="#FFF" stroke-width="1" opacity=".2"/>
  </g>

  <!-- === FOOTREST === -->
  <g filter="url(#bcS)">
    <rect x="58" y="252" width="164" height="12" rx="6" fill="url(#bcGd)" filter="url(#bcGw)"/>
    <rect x="62" y="254" width="156" height="5" rx="2.5" fill="#FFF8D0" opacity=".35"/>
    <ellipse cx="58" cy="258" rx="8" ry="8" fill="url(#bcGd)"/>
    <ellipse cx="222" cy="258" rx="8" ry="8" fill="url(#bcGd)"/>
    <ellipse cx="58" cy="256" rx="5" ry="5" fill="#FFF8D0" opacity=".35"/>
    <ellipse cx="222" cy="256" rx="5" ry="5" fill="#FFF8D0" opacity=".35"/>
  </g>

  <!-- === SEAT === -->
  <g filter="url(#bcS)">
    <path d="M46 175 Q46 158 62 158 L218 158 Q234 158 234 175 L234 200 Q234 216 218 216 L62 216 Q46 216 46 200 Z" fill="url(#bcBlk)"/>
    <path d="M46 175 Q46 158 62 158 L218 158 Q234 158 234 175 L234 200 Q234 216 218 216 L62 216 Q46 216 46 200 Z" fill="url(#bcShn)"/>
    <!-- seat stitching lines -->
    <line x1="100" y1="162" x2="100" y2="212" stroke="#2A2A2A" stroke-width="1.5" opacity=".6"/>
    <line x1="140" y1="160" x2="140" y2="214" stroke="#2A2A2A" stroke-width="1.5" opacity=".6"/>
    <line x1="180" y1="162" x2="180" y2="212" stroke="#2A2A2A" stroke-width="1.5" opacity=".6"/>
    <!-- seat highlight -->
    <path d="M56 162 Q140 155 224 162" stroke="#555" stroke-width="2.5" fill="none" opacity=".35" stroke-linecap="round"/>
    <!-- gold piping -->
    <path d="M50 160 Q140 154 230 160" stroke="#C8A84B" stroke-width="1.5" fill="none" opacity=".4"/>
    <path d="M46 200 Q46 216 62 216 L218 216 Q234 216 234 200" stroke="#C8A84B" stroke-width="2" fill="none" opacity=".35"/>
  </g>

  <!-- === SEAT CONNECTOR TO BASE === -->
  <g filter="url(#bcS)">
    <path d="M110 216 L110 244 Q110 248 114 248 L166 248 Q170 248 170 244 L170 216" fill="url(#bcChr)"/>
    <path d="M112 218 L112 242" stroke="#F8F0E8" stroke-width="3" opacity=".2" stroke-linecap="round"/>
  </g>

  <!-- === LEFT ARMREST === -->
  <g filter="url(#bcS)">
    <!-- arm support (chrome) -->
    <path d="M30 152 L30 200 Q30 210 38 210 L52 210 L52 200 L40 200 L40 152 Z" fill="url(#bcGd)"/>
    <rect x="32" y="154" width="3.5" height="44" rx="1.5" fill="#FFF8D0" opacity=".3"/>
    <!-- arm pad (leather) -->
    <path d="M18 132 Q18 122 28 122 L50 122 Q60 122 60 132 L60 158 Q60 166 50 166 L28 166 Q18 166 18 158 Z" fill="url(#bcBlk)"/>
    <path d="M18 132 Q18 122 28 122 L50 122 Q60 122 60 132 L60 158 Q60 166 50 166 L28 166 Q18 166 18 158 Z" fill="url(#bcShn)"/>
    <path d="M18 158 Q18 166 28 166 L50 166 Q60 166 60 158" stroke="#C8A84B" stroke-width="1.5" fill="none" opacity=".4"/>
    <path d="M24 126 Q39 123 56 126" stroke="#444" stroke-width="2" fill="none" opacity=".3" stroke-linecap="round"/>
  </g>

  <!-- === RIGHT ARMREST === -->
  <g filter="url(#bcS)">
    <path d="M250 152 L250 200 Q250 210 242 210 L228 210 L228 200 L240 200 L240 152 Z" fill="url(#bcGd)"/>
    <rect x="244.5" y="154" width="3.5" height="44" rx="1.5" fill="#FFF8D0" opacity=".3"/>
    <path d="M220 132 Q220 122 230 122 L252 122 Q262 122 262 132 L262 158 Q262 166 252 166 L230 166 Q220 166 220 158 Z" fill="url(#bcBlk)"/>
    <path d="M220 132 Q220 122 230 122 L252 122 Q262 122 262 132 L262 158 Q262 166 252 166 L230 166 Q220 166 220 158 Z" fill="url(#bcShn)"/>
    <path d="M220 158 Q220 166 230 166 L252 166 Q262 166 262 158" stroke="#C8A84B" stroke-width="1.5" fill="none" opacity=".4"/>
    <path d="M224 126 Q241 123 258 126" stroke="#444" stroke-width="2" fill="none" opacity=".3" stroke-linecap="round"/>
  </g>

  <!-- === BACKREST === -->
  <g filter="url(#bcS)">
    <!-- chrome frame -->
    <path d="M56 30 Q56 14 72 14 L208 14 Q224 14 224 30 L224 158 Q224 166 216 166 L64 166 Q56 166 56 158 Z" fill="url(#bcGd)"/>
    <rect x="58" y="16" width="4" height="148" rx="2" fill="#FFF8D0" opacity=".25"/>
    <!-- leather pad -->
    <path d="M62 36 Q62 20 76 20 L204 20 Q218 20 218 36 L218 154 Q218 162 208 162 L72 162 Q62 162 62 154 Z" fill="url(#bcBlk)"/>
    <path d="M62 36 Q62 20 76 20 L204 20 Q218 20 218 36 L218 154 Q218 162 208 162 L72 162 Q62 162 62 154 Z" fill="url(#bcShn)"/>
    <!-- vertical stitch lines -->
    <line x1="104" y1="26" x2="104" y2="156" stroke="#2A2A2A" stroke-width="1.5" opacity=".5"/>
    <line x1="140" y1="22" x2="140" y2="160" stroke="#2A2A2A" stroke-width="1.5" opacity=".5"/>
    <line x1="176" y1="26" x2="176" y2="156" stroke="#2A2A2A" stroke-width="1.5" opacity=".5"/>
    <!-- horizontal stitch lines -->
    <line x1="66" y1="55" x2="214" y2="55" stroke="#2A2A2A" stroke-width="1" opacity=".35"/>
    <line x1="66" y1="90" x2="214" y2="90" stroke="#2A2A2A" stroke-width="1" opacity=".35"/>
    <line x1="66" y1="125" x2="214" y2="125" stroke="#2A2A2A" stroke-width="1" opacity=".35"/>
    <!-- leather sheen -->
    <path d="M76 24 Q140 18 204 24" stroke="#555" stroke-width="3" fill="none" opacity=".3" stroke-linecap="round"/>
    <!-- gold piping -->
    <path d="M62 36 Q62 20 76 20 L204 20 Q218 20 218 36" stroke="#C8A84B" stroke-width="1.5" fill="none" opacity=".4"/>
    <path d="M62 154 Q62 162 72 162 L208 162 Q218 162 218 154" stroke="#C8A84B" stroke-width="1.5" fill="none" opacity=".4"/>
  </g>

  <!-- === HEADREST === -->
  <g filter="url(#bcS)">
    <!-- chrome bracket -->
    <rect x="110" y="8" width="60" height="12" rx="4" fill="url(#bcGd)"/>
    <!-- leather headrest -->
    <path d="M92 2 Q92 -8 104 -8 L176 -8 Q188 -8 188 2 L188 18 Q188 28 176 28 L104 28 Q92 28 92 18 Z" fill="url(#bcBlk)"/>
    <path d="M92 2 Q92 -8 104 -8 L176 -8 Q188 -8 188 2 L188 18 Q188 28 176 28 L104 28 Q92 28 92 18 Z" fill="url(#bcShn)"/>
    <!-- headrest stitching -->
    <line x1="124" y1="-4" x2="124" y2="24" stroke="#2A2A2A" stroke-width="1.2" opacity=".5"/>
    <line x1="140" y1="-6" x2="140" y2="26" stroke="#2A2A2A" stroke-width="1.2" opacity=".5"/>
    <line x1="156" y1="-4" x2="156" y2="24" stroke="#2A2A2A" stroke-width="1.2" opacity=".5"/>
    <path d="M92 18 Q92 28 104 28 L176 28 Q188 28 188 18" stroke="#C8A84B" stroke-width="1.5" fill="none" opacity=".4"/>
    <path d="M100 -6 Q140 -10 180 -6" stroke="#444" stroke-width="2" fill="none" opacity=".25" stroke-linecap="round"/>
  </g>

  <!-- === LEVER HANDLE === -->
  <rect x="230" y="200" width="24" height="6" rx="3" fill="url(#bcGd)" filter="url(#bcS)"/>
  <ellipse cx="254" cy="203" rx="6" ry="6" fill="url(#bcGd)" filter="url(#bcGw)"/>
  <ellipse cx="254" cy="202" rx="3.5" ry="3.5" fill="#FFF8D0" opacity=".45"/>

  <!-- === SUBTLE GOLD AMBIENT === -->
  <ellipse cx="140" cy="130" rx="90" ry="110" fill="#C8A84B" opacity=".02"/>
</svg>`;}

function dbBooking(){
  return `<svg width="140" height="155" viewBox="0 0 280 310" fill="none" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="bkBlk" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#3A3A3A"/><stop offset="30%" stop-color="#1A1A1A"/><stop offset="70%" stop-color="#0E0E0E"/><stop offset="100%" stop-color="#222"/>
    </linearGradient>
    <linearGradient id="bkGd" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#F5E8B0"/><stop offset="25%" stop-color="#D4B050"/><stop offset="50%" stop-color="#E8D078"/><stop offset="75%" stop-color="#C8A040"/><stop offset="100%" stop-color="#A88828"/>
    </linearGradient>
    <linearGradient id="bkChr" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#F0ECE8"/><stop offset="20%" stop-color="#D8D0C8"/><stop offset="45%" stop-color="#E8E4E0"/><stop offset="70%" stop-color="#A8A098"/><stop offset="100%" stop-color="#C8C0B8"/>
    </linearGradient>
    <radialGradient id="bkShn" cx=".35" cy=".25" r=".65">
      <stop offset="0%" stop-color="#555" stop-opacity=".6"/><stop offset="100%" stop-color="#000" stop-opacity="0"/>
    </radialGradient>
    <filter id="bkS"><feDropShadow dx="1" dy="3" stdDeviation="3" flood-color="#000" flood-opacity=".55"/></filter>
    <filter id="bkGw"><feDropShadow dx="0" dy="0" stdDeviation="4" flood-color="#C8A84B" flood-opacity=".3"/></filter>
  </defs>

  <!-- FLOOR SHADOW -->
  <ellipse cx="140" cy="295" rx="90" ry="9" fill="#000" opacity=".35"/>

  <!-- === CALENDAR BODY (leather) === -->
  <g filter="url(#bkS)">
    <rect x="44" y="60" width="192" height="230" rx="18" fill="url(#bkBlk)"/>
    <rect x="44" y="60" width="192" height="230" rx="18" fill="url(#bkShn)"/>
    <!-- gold border -->
    <rect x="44" y="60" width="192" height="230" rx="18" stroke="#C8A84B" stroke-width="2" fill="none" opacity=".45"/>
  </g>

  <!-- === TOP BAR (gold header) === -->
  <g filter="url(#bkS)">
    <rect x="44" y="60" width="192" height="52" rx="18" fill="url(#bkGd)" filter="url(#bkGw)"/>
    <rect x="44" y="90" width="192" height="22" fill="url(#bkGd)"/>
    <!-- shine -->
    <rect x="52" y="64" width="120" height="6" rx="3" fill="#FFF8D0" opacity=".3"/>
  </g>

  <!-- === BINDING RINGS (chrome) === -->
  <g filter="url(#bkS)">
    <rect x="90" y="46" width="14" height="32" rx="7" fill="url(#bkChr)"/>
    <rect x="92" y="48" width="3" height="28" rx="1.5" fill="#F8F0E8" opacity=".35"/>
    <rect x="176" y="46" width="14" height="32" rx="7" fill="url(#bkChr)"/>
    <rect x="178" y="48" width="3" height="28" rx="1.5" fill="#F8F0E8" opacity=".35"/>
  </g>

  <!-- === GRID LINES (stitching style) === -->
  <!-- horizontal lines -->
  <line x1="62" y1="150" x2="218" y2="150" stroke="#2A2A2A" stroke-width="1.2" opacity=".5"/>
  <line x1="62" y1="190" x2="218" y2="190" stroke="#2A2A2A" stroke-width="1.2" opacity=".5"/>
  <line x1="62" y1="230" x2="218" y2="230" stroke="#2A2A2A" stroke-width="1.2" opacity=".5"/>
  <!-- vertical lines -->
  <line x1="105" y1="118" x2="105" y2="272" stroke="#2A2A2A" stroke-width="1.2" opacity=".5"/>
  <line x1="162" y1="118" x2="162" y2="272" stroke="#2A2A2A" stroke-width="1.2" opacity=".5"/>

  <!-- === CHECKMARK (gold, selected date) === -->
  <g filter="url(#bkGw)">
    <rect x="114" y="157" width="40" height="26" rx="8" fill="url(#bkGd)" opacity=".9"/>
    <path d="M126 172 L132 178 L146 164" stroke="#1A1A1A" stroke-width="3.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
  </g>

  <!-- === CLOCK ICON (bottom right, chrome) === -->
  <g filter="url(#bkS)">
    <circle cx="198" cy="248" r="18" fill="url(#bkChr)"/>
    <circle cx="198" cy="248" r="14" fill="url(#bkBlk)"/>
    <circle cx="198" cy="248" r="14" fill="url(#bkShn)"/>
    <circle cx="198" cy="248" r="14" stroke="#C8A84B" stroke-width="1.5" fill="none" opacity=".5"/>
    <!-- clock hands -->
    <line x1="198" y1="248" x2="198" y2="239" stroke="#C8A84B" stroke-width="2" stroke-linecap="round"/>
    <line x1="198" y1="248" x2="205" y2="252" stroke="#C8A84B" stroke-width="2" stroke-linecap="round"/>
    <circle cx="198" cy="248" r="2" fill="#C8A84B"/>
  </g>

  <!-- === SUBTLE GOLD AMBIENT === -->
  <ellipse cx="140" cy="170" rx="90" ry="110" fill="#C8A84B" opacity=".02"/>
</svg>`;}

// ─── MASSAGE TABLE (Premium SVG — same quality as dbSeat) ───
function dbMassage(){
  return `<svg width="140" height="155" viewBox="0 0 280 310" fill="none" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="mtBlk" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#3A3A3A"/><stop offset="30%" stop-color="#1A1A1A"/><stop offset="70%" stop-color="#0E0E0E"/><stop offset="100%" stop-color="#222"/></linearGradient>
    <linearGradient id="mtChr" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#F0ECE8"/><stop offset="20%" stop-color="#D8D0C8"/><stop offset="45%" stop-color="#E8E4E0"/><stop offset="70%" stop-color="#A8A098"/><stop offset="100%" stop-color="#C8C0B8"/></linearGradient>
    <linearGradient id="mtGd" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#F5E8B0"/><stop offset="25%" stop-color="#D4B050"/><stop offset="50%" stop-color="#E8D078"/><stop offset="75%" stop-color="#C8A040"/><stop offset="100%" stop-color="#A88828"/></linearGradient>
    <radialGradient id="mtShn" cx=".35" cy=".25" r=".65"><stop offset="0%" stop-color="#555" stop-opacity=".6"/><stop offset="100%" stop-color="#000" stop-opacity="0"/></radialGradient>
    <filter id="mtS"><feDropShadow dx="1" dy="3" stdDeviation="3" flood-color="#000" flood-opacity=".55"/></filter>
    <filter id="mtGw"><feDropShadow dx="0" dy="0" stdDeviation="4" flood-color="#C8A84B" flood-opacity=".3"/></filter>
  </defs>
  <!-- FLOOR SHADOW -->
  <ellipse cx="140" cy="298" rx="100" ry="10" fill="#000" opacity=".35"/>
  <!-- === 4 LEGS (chrome) === -->
  <g filter="url(#mtS)">
    <rect x="48" y="200" width="10" height="96" rx="3" fill="url(#mtChr)"/>
    <rect x="50" y="202" width="3" height="92" rx="1.5" fill="#F8F0E8" opacity=".25"/>
    <rect x="222" y="200" width="10" height="96" rx="3" fill="url(#mtChr)"/>
    <rect x="224" y="202" width="3" height="92" rx="1.5" fill="#F8F0E8" opacity=".25"/>
    <rect x="88" y="200" width="10" height="96" rx="3" fill="url(#mtChr)"/>
    <rect x="182" y="200" width="10" height="96" rx="3" fill="url(#mtChr)"/>
  </g>
  <!-- === LEG CROSSBAR (gold) === -->
  <g filter="url(#mtGw)">
    <rect x="52" y="260" width="176" height="6" rx="3" fill="url(#mtGd)"/>
    <rect x="56" y="261" width="120" height="2.5" rx="1" fill="#FFF8D0" opacity=".3"/>
  </g>
  <!-- === MATTRESS (main body — black leather) === -->
  <g filter="url(#mtS)">
    <path d="M30 130 Q30 112 48 112 L232 112 Q250 112 250 130 L250 200 Q250 212 232 212 L48 212 Q30 212 30 200 Z" fill="url(#mtBlk)"/>
    <path d="M30 130 Q30 112 48 112 L232 112 Q250 112 250 130 L250 200 Q250 212 232 212 L48 212 Q30 212 30 200 Z" fill="url(#mtShn)"/>
    <!-- stitching lines -->
    <line x1="80" y1="118" x2="80" y2="206" stroke="#2A2A2A" stroke-width="1.5" opacity=".5"/>
    <line x1="140" y1="114" x2="140" y2="210" stroke="#2A2A2A" stroke-width="1.5" opacity=".5"/>
    <line x1="200" y1="118" x2="200" y2="206" stroke="#2A2A2A" stroke-width="1.5" opacity=".5"/>
    <line x1="36" y1="160" x2="244" y2="160" stroke="#2A2A2A" stroke-width="1" opacity=".35"/>
    <!-- top highlight -->
    <path d="M48 116 Q140 110 232 116" stroke="#555" stroke-width="2.5" fill="none" opacity=".35" stroke-linecap="round"/>
    <!-- gold piping top -->
    <path d="M34 130 Q34 114 48 114 L232 114 Q246 114 246 130" stroke="#C8A84B" stroke-width="1.8" fill="none" opacity=".4"/>
    <!-- gold piping bottom -->
    <path d="M30 200 Q30 212 48 212 L232 212 Q250 212 250 200" stroke="#C8A84B" stroke-width="2" fill="none" opacity=".35"/>
  </g>
  <!-- === FACE HOLE SECTION (left end) === -->
  <g filter="url(#mtS)">
    <path d="M30 140 Q12 140 12 155 L12 175 Q12 190 30 190" fill="url(#mtBlk)"/>
    <path d="M30 140 Q12 140 12 155 L12 175 Q12 190 30 190" fill="url(#mtShn)"/>
    <ellipse cx="22" cy="165" rx="8" ry="16" fill="#080706" stroke="#2A2A2A" stroke-width="1.5"/>
    <path d="M30 142 Q14 142 14 155" stroke="#C8A84B" stroke-width="1.5" fill="none" opacity=".35"/>
  </g>
  <!-- === PILLOW (top — cream leather) === -->
  <g filter="url(#mtS)">
    <path d="M30 80 Q30 62 50 62 L230 62 Q250 62 250 80 L250 118 Q250 128 230 128 L50 128 Q30 128 30 118 Z" fill="url(#mtBlk)"/>
    <path d="M30 80 Q30 62 50 62 L230 62 Q250 62 250 80 L250 118 Q250 128 230 128 L50 128 Q30 128 30 118 Z" fill="url(#mtShn)"/>
    <!-- pillow puff -->
    <path d="M50 66 Q140 58 230 66" stroke="#555" stroke-width="3" fill="none" opacity=".3" stroke-linecap="round"/>
    <line x1="100" y1="68" x2="100" y2="122" stroke="#2A2A2A" stroke-width="1.2" opacity=".4"/>
    <line x1="140" y1="64" x2="140" y2="126" stroke="#2A2A2A" stroke-width="1.2" opacity=".4"/>
    <line x1="180" y1="68" x2="180" y2="122" stroke="#2A2A2A" stroke-width="1.2" opacity=".4"/>
    <!-- gold border -->
    <path d="M34 80 Q34 66 50 66 L230 66 Q246 66 246 80" stroke="#C8A84B" stroke-width="1.5" fill="none" opacity=".4"/>
    <path d="M30 118 Q30 128 50 128 L230 128 Q250 128 250 118" stroke="#C8A84B" stroke-width="1.5" fill="none" opacity=".35"/>
  </g>
  <!-- === TOWEL ROLL (gold accent) === -->
  <g filter="url(#mtGw)">
    <ellipse cx="140" cy="48" rx="50" ry="14" fill="url(#mtGd)"/>
    <ellipse cx="140" cy="46" rx="30" ry="8" fill="#FFF8D0" opacity=".25"/>
    <ellipse cx="90" cy="48" rx="6" ry="14" fill="url(#mtGd)"/>
    <ellipse cx="190" cy="48" rx="6" ry="14" fill="url(#mtGd)"/>
  </g>
  <!-- === HAND ICON (spa touch) === -->
  <g filter="url(#mtGw)" opacity=".6">
    <path d="M204 80 Q210 72 216 76 Q222 80 218 90 Q216 96 210 96 Q204 96 202 90 Z" fill="url(#mtGd)" opacity=".4"/>
    <path d="M212 82 L210 72 Q210 66 214 64 L218 62 Q222 62 222 66 L220 76" fill="none" stroke="url(#mtGd)" stroke-width="1.5" stroke-linecap="round" opacity=".5"/>
  </g>
  <!-- === SUBTLE GOLD AMBIENT === -->
  <ellipse cx="140" cy="150" rx="100" ry="100" fill="#C8A84B" opacity=".02"/>
</svg>`;}

// ─── KOSMETIK CHAIR/BED (Premium SVG) ───
function dbKosmetik(){
  return `<svg width="140" height="155" viewBox="0 0 280 310" fill="none" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="ksBlk" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#3A3A3A"/><stop offset="30%" stop-color="#1A1A1A"/><stop offset="70%" stop-color="#0E0E0E"/><stop offset="100%" stop-color="#222"/></linearGradient>
    <linearGradient id="ksChr" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#F0ECE8"/><stop offset="20%" stop-color="#D8D0C8"/><stop offset="45%" stop-color="#E8E4E0"/><stop offset="70%" stop-color="#A8A098"/><stop offset="100%" stop-color="#C8C0B8"/></linearGradient>
    <linearGradient id="ksGd" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#F5E8B0"/><stop offset="25%" stop-color="#D4B050"/><stop offset="50%" stop-color="#E8D078"/><stop offset="75%" stop-color="#C8A040"/><stop offset="100%" stop-color="#A88828"/></linearGradient>
    <linearGradient id="ksPnk" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#E8C0D0"/><stop offset="50%" stop-color="#C86090"/><stop offset="100%" stop-color="#A04878"/></linearGradient>
    <radialGradient id="ksShn" cx=".35" cy=".25" r=".65"><stop offset="0%" stop-color="#555" stop-opacity=".6"/><stop offset="100%" stop-color="#000" stop-opacity="0"/></radialGradient>
    <filter id="ksS"><feDropShadow dx="1" dy="3" stdDeviation="3" flood-color="#000" flood-opacity=".55"/></filter>
    <filter id="ksGw"><feDropShadow dx="0" dy="0" stdDeviation="4" flood-color="#C8A84B" flood-opacity=".3"/></filter>
  </defs>
  <!-- FLOOR SHADOW -->
  <ellipse cx="140" cy="300" rx="90" ry="9" fill="#000" opacity=".35"/>
  <!-- === HYDRAULIC BASE (chrome) === -->
  <g filter="url(#ksS)">
    <ellipse cx="140" cy="290" rx="55" ry="10" fill="url(#ksChr)"/>
    <ellipse cx="140" cy="288" rx="35" ry="5" fill="#F0E8E0" opacity=".25"/>
    <rect x="130" y="240" width="20" height="52" rx="10" fill="url(#ksChr)"/>
    <rect x="132" y="242" width="5" height="48" rx="2.5" fill="#F8F0E8" opacity=".25"/>
    <rect x="124" y="260" width="32" height="8" rx="4" fill="url(#ksChr)"/>
  </g>
  <!-- === RECLINED SEAT (black leather) === -->
  <g filter="url(#ksS)">
    <path d="M40 165 Q40 148 56 148 L224 148 Q240 148 240 165 L240 210 Q240 225 224 225 L56 225 Q40 225 40 210 Z" fill="url(#ksBlk)"/>
    <path d="M40 165 Q40 148 56 148 L224 148 Q240 148 240 165 L240 210 Q240 225 224 225 L56 225 Q40 225 40 210 Z" fill="url(#ksShn)"/>
    <!-- stitching -->
    <line x1="100" y1="152" x2="100" y2="221" stroke="#2A2A2A" stroke-width="1.5" opacity=".5"/>
    <line x1="140" y1="150" x2="140" y2="223" stroke="#2A2A2A" stroke-width="1.5" opacity=".5"/>
    <line x1="180" y1="152" x2="180" y2="221" stroke="#2A2A2A" stroke-width="1.5" opacity=".5"/>
    <path d="M56 152 Q140 146 224 152" stroke="#555" stroke-width="2.5" fill="none" opacity=".35" stroke-linecap="round"/>
    <!-- gold piping -->
    <path d="M44 165 Q44 150 56 150 L224 150 Q236 150 236 165" stroke="#C8A84B" stroke-width="1.8" fill="none" opacity=".4"/>
    <path d="M40 210 Q40 225 56 225 L224 225 Q240 225 240 210" stroke="#C8A84B" stroke-width="2" fill="none" opacity=".35"/>
  </g>
  <!-- === SEAT CONNECTOR === -->
  <g filter="url(#ksS)">
    <path d="M110 225 L110 244 Q110 248 114 248 L166 248 Q170 248 170 244 L170 225" fill="url(#ksChr)"/>
  </g>
  <!-- === RECLINED BACKREST (tilted 25°) === -->
  <g filter="url(#ksS)" transform="rotate(-20 140 148)">
    <path d="M50 26 Q50 10 66 10 L214 10 Q230 10 230 26 L230 148 Q230 158 214 158 L66 158 Q50 158 50 148 Z" fill="url(#ksBlk)"/>
    <path d="M50 26 Q50 10 66 10 L214 10 Q230 10 230 26 L230 148 Q230 158 214 158 L66 158 Q50 158 50 148 Z" fill="url(#ksShn)"/>
    <!-- stitching -->
    <line x1="100" y1="16" x2="100" y2="152" stroke="#2A2A2A" stroke-width="1.5" opacity=".5"/>
    <line x1="140" y1="12" x2="140" y2="156" stroke="#2A2A2A" stroke-width="1.5" opacity=".5"/>
    <line x1="180" y1="16" x2="180" y2="152" stroke="#2A2A2A" stroke-width="1.5" opacity=".5"/>
    <line x1="56" y1="55" x2="224" y2="55" stroke="#2A2A2A" stroke-width="1" opacity=".35"/>
    <line x1="56" y1="95" x2="224" y2="95" stroke="#2A2A2A" stroke-width="1" opacity=".35"/>
    <path d="M66 14 Q140 8 214 14" stroke="#555" stroke-width="2.5" fill="none" opacity=".3" stroke-linecap="round"/>
    <!-- gold piping -->
    <path d="M54 26 Q54 12 66 12 L214 12 Q226 12 226 26" stroke="#C8A84B" stroke-width="1.5" fill="none" opacity=".4"/>
    <path d="M50 148 Q50 158 66 158 L214 158 Q230 158 230 148" stroke="#C8A84B" stroke-width="1.5" fill="none" opacity=".35"/>
  </g>
  <!-- === MAGNIFYING LAMP (gold) === -->
  <g filter="url(#ksGw)">
    <rect x="244" y="80" width="4" height="120" rx="2" fill="url(#ksChr)"/>
    <rect x="232" y="74" width="28" height="6" rx="3" fill="url(#ksChr)"/>
    <circle cx="246" cy="60" r="18" fill="none" stroke="url(#ksGd)" stroke-width="3"/>
    <circle cx="246" cy="60" r="12" fill="rgba(200,168,75,.06)"/>
    <circle cx="246" cy="60" r="12" fill="none" stroke="url(#ksGd)" stroke-width="1" opacity=".5"/>
    <circle cx="243" cy="56" r="3" fill="#FFF8D0" opacity=".3"/>
    <!-- lamp glow -->
    <circle cx="246" cy="60" r="22" fill="#C8A84B" opacity=".04"/>
  </g>
  <!-- === PRODUCT TRAY (side) === -->
  <g filter="url(#ksS)">
    <rect x="4" y="140" width="30" height="50" rx="6" fill="url(#ksChr)"/>
    <rect x="6" y="142" width="3" height="46" rx="1.5" fill="#F8F0E8" opacity=".2"/>
    <!-- bottles -->
    <rect x="8" y="144" width="8" height="18" rx="3" fill="url(#ksPnk)" opacity=".6"/>
    <rect x="18" y="148" width="8" height="14" rx="3" fill="url(#ksGd)" opacity=".5"/>
    <rect x="10" y="142" width="4" height="4" rx="2" fill="url(#ksPnk)" opacity=".4"/>
    <rect x="20" y="146" width="4" height="4" rx="2" fill="url(#ksGd)" opacity=".4"/>
    <!-- tray border -->
    <rect x="4" y="140" width="30" height="50" rx="6" fill="none" stroke="#C8A84B" stroke-width="1" opacity=".25"/>
  </g>
  <!-- === SUBTLE GOLD AMBIENT === -->
  <ellipse cx="140" cy="140" rx="100" ry="110" fill="#C8A84B" opacity=".02"/>
</svg>`;}

// ═══════════════ i18n ═══════════════
const LANG={
  de:{welcome:"Willkommen bei ChairMatch",subtitle:"Dein Beauty-Partner in ganz Deutschland",chair:"Stuhl · Liege · Kabine",chairSub:"Stühle, Liegen & Räume vermieten — Jetzt entdecken",book:"Sofort buchen",bookSub:"Termin in 30 Sekunden · Sofortige Bestätigung",iAm:"Ich bin...",customer:"Kunde — ich suche Termine",provider:"Anbieter — ich biete Services",b2b:"B2B — Stuhl / Kabine mieten",next:"Weiter →",go:"Los geht's",morning:"Guten Morgen",afternoon:"Guten Tag",evening:"Guten Abend",nationwide:"Deutschlandweit buchen",search:"Stadt, Name, Service...",categories:"Kategorien",all:"Alle",topSpecs:"Top Spezialisten",availToday:"Heute verfügbar",allProviders:"Alle Anbieter",found:"gefunden",from:"ab",available:"verfügbar",soldOut:"Ausgebucht",offers:"Angebote",discount:"Rabatt",bookNow:"Jetzt buchen",refer:"Freunde werben",referSub:"Du & dein Freund erhalten je 5 €",shareLink:"Link teilen",perRef:"pro Empfehlung",back:"Zurück",buchen:"Buchen",info:"Info",services:"Services",team:"Team",reviews:"Bewertungen",gallery:"Galerie",whyUs:"Warum ChairMatch?",noComm:"Faire Konditionen",vs:"Beste Preise garantiert",direct:"Direktbuchung",noDetour:"Kein Umweg",verified:"Verifiziert",checked:"Gewerbeschein geprüft",service:"Service",day:"Tag",time:"Uhrzeit",specialist:"Spezialist",contact:"Kontakt",name:"Name",email:"E-Mail",step:"Schritt",confirm:"Bestätigt!",total:"Gesamt",noFee:"Sofortige Bestätigung · Kostenlose Stornierung 24h",done:"Fertig",shareWA:"Per WhatsApp teilen",favs:"Favoriten",noFavs:"Noch keine Favoriten",noFavsSub:"Tippe ♡ um Salons zu speichern",account:"Konto",bookings:"Buchungen",legal:"Rechtliches",privacy:"Datenschutzerklärung (DSGVO)",imprint:"Impressum",register:"Als Anbieter registrieren",loyalty:"Treuekarte",stampsOf:"Stempel",freeService:"Gratis-Service!",loyaltySub:"Sammle Stempel bei jeder Buchung",lang:"Sprache",theme:"Design",darkMode:"Dark Mode",lightMode:"Light Mode",notifications:"Benachrichtigungen",filter:"Filter",priceRange:"Preis",minRating:"Min. Bewertung",city:"Stadt",allCities:"Alle Städte",onlyAvail:"Nur verfügbar",onlyDiscount:"Nur Rabatt",apply:"Anwenden",reset:"Zurücksetzen",map:"Karte",list:"Liste",promoTitle:"Spare bis zu 15%",promoSub:"auf erste Buchung",promoCode:"Code: CHAIR2026",noResults:"Keine Ergebnisse",tryOther:"Versuche andere Filter",confirmed:"Bestätigt",pending:"Ausstehend",cancelled:"Storniert",chairRent:"Stuhl vermieten",premChair:"Barber-Stühle · Kosmetik-Kabinen · OP-Räume",zeroComm:"Deutschlandweit verfügbar",becomeProvider:"→ Anbieter werden",refBalance:"Referral Guthaben",recommend:"Empfehlen",special:"SONDERANGEBOT",before:"Vorher",after:"Nachher",phone:"Telefon",linkCopied:"Link kopiert!",writeReview:"Bewertung schreiben",reviewPlaceholder:"Wie war dein Erlebnis?",submitReview:"Absenden",reviewSubmitted:"Bewertung abgeschickt!",promoApply:"Anwenden",promoInvalid:"Ungültiger Code",promoApplied:"Code angewendet!",enterPromo:"Promo-Code eingeben",redeemNow:"Jetzt einlösen",redeemed:"Eingelöst!",loyaltyRedeemMsg:"Gratis-Service eingelöst!",cancelBooking:"Stornieren",cancelConfirm:"Termin wirklich stornieren?",bookingCancelled:"Termin storniert",noBookings:"Keine Buchungen",noBookingsSub:"Buche deinen ersten Termin",specialRequests:"Besondere Wünsche",notesPlaceholder:"z.B. Allergien, Wünsche...",noNotifications:"Keine Benachrichtigungen",noNotificationsSub:"Du bist auf dem neuesten Stand!",nlTitle:"Exklusive Angebote erhalten",nlSub:"Melde dich für unseren Newsletter an und erhalte sofort 10% Rabatt!",nlPlaceholder:"Deine E-Mail-Adresse",nlButton:"Anmelden & 10% sichern",nlSuccess:"Willkommen! Dein 10%-Code: WELCOME10",nlAlready:"Du bist bereits angemeldet!",refTitle:"Freunde einladen, Geld verdienen",refSteps:"So geht's:",refStep1:"Teile deinen Link mit Freunden",refStep2:"Dein Freund bucht seinen ersten Termin",refStep3:"Ihr beide erhaltet 5 € Guthaben",refCode:"Dein Empfehlungscode",refCopied:"Code kopiert!",refInvited:"Eingeladene Freunde",refEarned:"Verdient",premBadge:"PREMIUM",premFeatured:"Empfohlen",adminPanel:"Admin-Panel",adminDash:"Dashboard",adminLogo:"Logo & Branding",adminServices:"Services verwalten",adminStats:"Statistiken",adminSettings:"Einstellungen",todayBookings:"Termine heute",totalRevenue:"Umsatz (Monat)",avgRating:"Ø Bewertung",totalReviews:"Bewertungen",uploadLogo:"Logo hochladen",logoDesc:"Lade dein Geschäftslogo hoch (JPG, PNG)",generateIcons:"AI-Icons generieren",iconDesc:"Wir erstellen 3 professionelle Varianten aus deinem Logo",iconStyle1:"Geometric",iconStyle2:"Minimal",iconStyle3:"Luxury",selectIcon:"Dieses Icon verwenden",selectedIcon:"Aktives Icon",removeLogo:"Logo entfernen",generating:"Generiere Varianten...",adminNoShop:"Noch kein Geschäft registriert",adminRegFirst:"Registriere dich zuerst als Anbieter",saPanel:"Super Admin",saProviders:"Anbieter",saFeatures:"Features",saAnalytics:"Analyse",saTogglePrem:"Premium aktivieren/deaktivieren",saTier:"Tier ändern",saBoost:"Boost anpassen",saActive:"Aktiv",saInactive:"Inaktiv",saIconFeature:"AI-Icon Feature",saTotalProviders:"Anbieter gesamt",saPremiumCount:"Premium Anbieter",saGoldCount:"Gold Anbieter",saFreeCount:"Free Anbieter",pricingTitle:"Abonnement-Pakete",pricingFree:"Starter",pricingPrem:"Premium",pricingGold:"Gold",pricingMonth:"/Monat",pricingFreeSub:"Kostenlos starten",pricingPremSub:"Mehr Sichtbarkeit",pricingGoldSub:"Maximale Reichweite",pricingCurrent:"Aktuelles Paket",pricingUpgrade:"Upgrade",pricingFeatures:"Inklusive"},
  en:{welcome:"Welcome to ChairMatch",subtitle:"Your Beauty Partner across Germany",chair:"Chair · Bed · Room",chairSub:"Rent chairs, beds & rooms — Discover now",book:"Book instantly",bookSub:"Appointment in 30 seconds · Instant confirmation",iAm:"I am...",customer:"Customer — looking for appointments",provider:"Provider — offering services",b2b:"B2B — rent a chair / cabin",next:"Next →",go:"Let's go!",morning:"Good Morning",afternoon:"Good Afternoon",evening:"Good Evening",nationwide:"Book nationwide",search:"City, name, service...",categories:"Categories",all:"All",topSpecs:"Top Specialists",availToday:"Available today",allProviders:"All Providers",found:"found",from:"from",available:"available",soldOut:"Sold out",offers:"Offers",discount:"Discount",bookNow:"Book now",refer:"Refer Friends",referSub:"You & your friend each get €5",shareLink:"Share link",perRef:"per referral",back:"Back",buchen:"Book",info:"Info",services:"Services",team:"Team",reviews:"Reviews",gallery:"Gallery",whyUs:"Why ChairMatch?",noComm:"Fair conditions",vs:"Best prices guaranteed",direct:"Direct booking",noDetour:"No detour",verified:"Verified",checked:"Business license checked",service:"Service",day:"Day",time:"Time",specialist:"Specialist",contact:"Contact",name:"Name",email:"Email",step:"Step",confirm:"Confirmed!",total:"Total",noFee:"Instant confirmation · Free cancellation 24h",done:"Done",shareWA:"Share via WhatsApp",favs:"Favorites",noFavs:"No favorites yet",noFavsSub:"Tap ♡ to save salons",account:"Account",bookings:"Bookings",legal:"Legal",privacy:"Privacy Policy (GDPR)",imprint:"Imprint",register:"Register as provider",loyalty:"Loyalty Card",stampsOf:"stamps",freeService:"Free service!",loyaltySub:"Collect stamps with every booking",lang:"Language",theme:"Design",darkMode:"Dark Mode",lightMode:"Light Mode",notifications:"Notifications",filter:"Filter",priceRange:"Price",minRating:"Min. Rating",city:"City",allCities:"All cities",onlyAvail:"Available only",onlyDiscount:"Discount only",apply:"Apply",reset:"Reset",map:"Map",list:"List",promoTitle:"Save up to 15%",promoSub:"on first booking",promoCode:"Code: CHAIR2026",noResults:"No results",tryOther:"Try different filters",confirmed:"Confirmed",pending:"Pending",cancelled:"Cancelled",chairRent:"Rent a chair",premChair:"Barber Chairs · Beauty Cabins · OR Rooms",zeroComm:"Available nationwide",becomeProvider:"→ Become a provider",refBalance:"Referral Balance",recommend:"Recommend",special:"SPECIAL OFFER",before:"Before",after:"After",phone:"Phone",linkCopied:"Link copied!",writeReview:"Write a review",reviewPlaceholder:"How was your experience?",submitReview:"Submit",reviewSubmitted:"Review submitted!",promoApply:"Apply",promoInvalid:"Invalid code",promoApplied:"Code applied!",enterPromo:"Enter promo code",redeemNow:"Redeem now",redeemed:"Redeemed!",loyaltyRedeemMsg:"Free service redeemed!",cancelBooking:"Cancel",cancelConfirm:"Really cancel appointment?",bookingCancelled:"Booking cancelled",noBookings:"No bookings",noBookingsSub:"Book your first appointment",specialRequests:"Special requests",notesPlaceholder:"e.g. allergies, preferences...",noNotifications:"No notifications",noNotificationsSub:"You're all caught up!",nlTitle:"Get exclusive offers",nlSub:"Sign up for our newsletter and get 10% off instantly!",nlPlaceholder:"Your email address",nlButton:"Sign up & get 10% off",nlSuccess:"Welcome! Your 10% code: WELCOME10",nlAlready:"You're already subscribed!",refTitle:"Invite friends, earn money",refSteps:"How it works:",refStep1:"Share your link with friends",refStep2:"Your friend books their first appointment",refStep3:"You both receive €5 credit",refCode:"Your referral code",refCopied:"Code copied!",refInvited:"Friends invited",refEarned:"Earned",premBadge:"PREMIUM",premFeatured:"Featured",adminPanel:"Admin Panel",adminDash:"Dashboard",adminLogo:"Logo & Branding",adminServices:"Manage Services",adminStats:"Statistics",adminSettings:"Settings",todayBookings:"Bookings today",totalRevenue:"Revenue (month)",avgRating:"Avg. Rating",totalReviews:"Reviews",uploadLogo:"Upload Logo",logoDesc:"Upload your business logo (JPG, PNG)",generateIcons:"Generate AI Icons",iconDesc:"We create 3 professional variants from your logo",iconStyle1:"Geometric",iconStyle2:"Minimal",iconStyle3:"Luxury",selectIcon:"Use this icon",selectedIcon:"Active icon",removeLogo:"Remove logo",generating:"Generating variants...",adminNoShop:"No business registered yet",adminRegFirst:"Register as a provider first",saPanel:"Super Admin",saProviders:"Providers",saFeatures:"Features",saAnalytics:"Analytics",saTogglePrem:"Activate/deactivate premium",saTier:"Change tier",saBoost:"Adjust boost",saActive:"Active",saInactive:"Inactive",saIconFeature:"AI Icon Feature",saTotalProviders:"Total providers",saPremiumCount:"Premium providers",saGoldCount:"Gold providers",saFreeCount:"Free providers",pricingTitle:"Subscription Plans",pricingFree:"Starter",pricingPrem:"Premium",pricingGold:"Gold",pricingMonth:"/month",pricingFreeSub:"Start for free",pricingPremSub:"More visibility",pricingGoldSub:"Maximum reach",pricingCurrent:"Current plan",pricingUpgrade:"Upgrade",pricingFeatures:"Included"},
  tr:{welcome:"ChairMatch'e Hoş Geldiniz",subtitle:"Almanya genelinde güzellik ortağınız",chair:"Koltuk · Şezlong · Oda",chairSub:"Koltuk, şezlong & oda kiralama — Keşfet",book:"Hemen randevu al",bookSub:"30 saniyede randevu · Anında onay",iAm:"Ben...",customer:"Müşteri — randevu arıyorum",provider:"Hizmet veren — hizmet sunuyorum",b2b:"B2B — koltuk / kabin kiralama",next:"İleri →",go:"Başlayalım!",morning:"Günaydın",afternoon:"İyi Günler",evening:"İyi Akşamlar",nationwide:"Almanya genelinde rezervasyon",search:"Şehir, isim, hizmet...",categories:"Kategoriler",all:"Tümü",topSpecs:"En İyi Uzmanlar",availToday:"Bugün müsait",allProviders:"Tüm Sağlayıcılar",found:"bulundu",from:"dan",available:"müsait",soldOut:"Dolu",offers:"Teklifler",discount:"İndirim",bookNow:"Şimdi rezerve et",refer:"Arkadaşını Davet Et",referSub:"Sen ve arkadaşın 5€ kazanır",shareLink:"Link paylaş",perRef:"davet başına",back:"Geri",buchen:"Rezerve Et",info:"Bilgi",services:"Hizmetler",team:"Ekip",reviews:"Değerlendirmeler",gallery:"Galeri",whyUs:"Neden ChairMatch?",noComm:"Uygun koşullar",vs:"En iyi fiyat garantisi",direct:"Direkt rezervasyon",noDetour:"Aracısız",verified:"Doğrulanmış",checked:"İşletme belgesi kontrol edildi",service:"Hizmet",day:"Gün",time:"Saat",specialist:"Uzman",contact:"İletişim",name:"İsim",email:"E-Posta",step:"Adım",confirm:"Onaylandı!",total:"Toplam",noFee:"Anında onay · 24 saat ücretsiz iptal",done:"Tamam",shareWA:"WhatsApp ile paylaş",favs:"Favoriler",noFavs:"Henüz favori yok",noFavsSub:"Salonları kaydetmek için ♡ tıklayın",account:"Hesap",bookings:"Rezervasyonlar",legal:"Yasal",privacy:"Gizlilik Politikası (KVKK)",imprint:"Künye",register:"Sağlayıcı olarak kayıt ol",loyalty:"Sadakat Kartı",stampsOf:"damga",freeService:"Ücretsiz hizmet!",loyaltySub:"Her rezervasyonda damga toplayın",lang:"Dil",theme:"Tasarım",darkMode:"Koyu Mod",lightMode:"Açık Mod",notifications:"Bildirimler",filter:"Filtre",priceRange:"Fiyat",minRating:"Min. Puan",city:"Şehir",allCities:"Tüm şehirler",onlyAvail:"Sadece müsait",onlyDiscount:"Sadece indirimli",apply:"Uygula",reset:"Sıfırla",map:"Harita",list:"Liste",promoTitle:"%15'e kadar tasarruf",promoSub:"ilk rezervasyonda",promoCode:"Kod: CHAIR2026",noResults:"Sonuç yok",tryOther:"Farklı filtre deneyin",confirmed:"Onaylandı",pending:"Beklemede",cancelled:"İptal",chairRent:"Koltuk kirala",premChair:"Berber Koltu\u011fu · Kozmetik Kabin · Ameliyathane",zeroComm:"Almanya genelinde mevcut",becomeProvider:"→ Sağlayıcı ol",refBalance:"Referans Bakiyesi",recommend:"Tavsiye Et",special:"ÖZEL TEKLİF",before:"Önce",after:"Sonra",phone:"Telefon",linkCopied:"Link kopyalandı!",writeReview:"Değerlendirme yaz",reviewPlaceholder:"Deneyimin nasıldı?",submitReview:"Gönder",reviewSubmitted:"Değerlendirme gönderildi!",promoApply:"Uygula",promoInvalid:"Geçersiz kod",promoApplied:"Kod uygulandı!",enterPromo:"Promo kodu girin",redeemNow:"Şimdi kullan",redeemed:"Kullanıldı!",loyaltyRedeemMsg:"Ücretsiz hizmet kullanıldı!",cancelBooking:"İptal et",cancelConfirm:"Randevuyu iptal etmek istiyor musunuz?",bookingCancelled:"Randevu iptal edildi",noBookings:"Rezervasyon yok",noBookingsSub:"İlk randevunuzu alın",specialRequests:"Özel istekler",notesPlaceholder:"ör. alerji, tercihler...",noNotifications:"Bildirim yok",noNotificationsSub:"Her şey güncel!",nlTitle:"Özel tekliflerden haberdar ol",nlSub:"Bültenimize kaydol, anında %10 indirim kazan!",nlPlaceholder:"E-posta adresiniz",nlButton:"Kaydol & %10 kazan",nlSuccess:"Hoş geldin! %10 kodun: WELCOME10",nlAlready:"Zaten kayıtlısınız!",refTitle:"Arkadaşlarını davet et, para kazan",refSteps:"Nasıl çalışır:",refStep1:"Linkini arkadaşlarınla paylaş",refStep2:"Arkadaşın ilk randevusunu alsın",refStep3:"İkiniz de 5€ bakiye kazanın",refCode:"Davet kodun",refCopied:"Kod kopyalandı!",refInvited:"Davet edilen arkadaşlar",refEarned:"Kazanılan",premBadge:"PREMİUM",premFeatured:"Öne Çıkan",adminPanel:"Yönetim Paneli",adminDash:"Gösterge Paneli",adminLogo:"Logo & Marka",adminServices:"Hizmet Yönetimi",adminStats:"İstatistikler",adminSettings:"Ayarlar",todayBookings:"Bugünkü randevular",totalRevenue:"Gelir (aylık)",avgRating:"Ort. Puan",totalReviews:"Değerlendirmeler",uploadLogo:"Logo yükle",logoDesc:"İşletme logonuzu yükleyin (JPG, PNG)",generateIcons:"AI İkon üret",iconDesc:"Logonuzdan 3 profesyonel varyant oluşturuyoruz",iconStyle1:"Geometrik",iconStyle2:"Minimal",iconStyle3:"Lüks",selectIcon:"Bu ikonu kullan",selectedIcon:"Aktif ikon",removeLogo:"Logoyu kaldır",generating:"Varyantlar oluşturuluyor...",adminNoShop:"Henüz kayıtlı işletme yok",adminRegFirst:"Önce hizmet veren olarak kayıt olun",saPanel:"Süper Admin",saProviders:"Sağlayıcılar",saFeatures:"Özellikler",saAnalytics:"Analiz",saTogglePrem:"Premium aktif/deaktif",saTier:"Tier değiştir",saBoost:"Boost ayarla",saActive:"Aktif",saInactive:"Pasif",saIconFeature:"AI İkon Özelliği",saTotalProviders:"Toplam sağlayıcı",saPremiumCount:"Premium sağlayıcı",saGoldCount:"Gold sağlayıcı",saFreeCount:"Ücretsiz sağlayıcı",pricingTitle:"Abonelik Paketleri",pricingFree:"Başlangıç",pricingPrem:"Premium",pricingGold:"Gold",pricingMonth:"/ay",pricingFreeSub:"Ücretsiz başla",pricingPremSub:"Daha fazla görünürlük",pricingGoldSub:"Maksimum erişim",pricingCurrent:"Mevcut paket",pricingUpgrade:"Yükselt",pricingFeatures:"Dahil"}
};
function t(key){return LANG[state.lang]?.[key]||LANG.de[key]||key;}

// ═══════════════ DATA ═══════════════
const CATS=[
  {id:"barber",lbl:"Barbershop",sub:"Fade · Cut · Bart"},
  {id:"friseur",lbl:"Friseur",sub:"Schnitt · Farbe · Styling"},
  {id:"kosmetik",lbl:"Kosmetik",sub:"Facial · Peeling"},
  {id:"aesthetik",lbl:"Ästhetik",sub:"Botox · Filler"},
  {id:"nail",lbl:"Nails",sub:"Gel · Nail Art"},
  {id:"massage",lbl:"Massage",sub:"Wellness · Therapie"},
  {id:"lash",lbl:"Lash & Brows",sub:"Extensions · Lifting"},
  {id:"arzt",lbl:"Arzt/Klinik",sub:"Derma · Behandlung"},
  {id:"raum",lbl:"Raum/Kabine",sub:"Freelancer · Miete"},
  {id:"opraum",lbl:"OP-Raum",sub:"Steril · Chirurgie"}
];
const SPECS=[
  {id:"s1",nm:"Ahmed K.",role:"Master Barber",rt:4.9,cat:"barber",ini:"AK",col:"#2A4A3A"},
  {id:"s2",nm:"Sofia M.",role:"Kosmetikerin",rt:4.8,cat:"kosmetik",ini:"SM",col:"#4A2A3A"},
  {id:"s3",nm:"Dr. Meyer",role:"Ästhetik Arzt",rt:5.0,cat:"aesthetik",ini:"DM",col:"#1A3050"},
  {id:"s4",nm:"Lena B.",role:"Nail Artist",rt:4.9,cat:"nail",ini:"LB",col:"#3A3828"},
  {id:"s5",nm:"Marcus R.",role:"Senior Barber",rt:4.7,cat:"barber",ini:"MR",col:"#2A3828"},
  {id:"s6",nm:"Julia H.",role:"Friseurmeisterin",rt:4.9,cat:"friseur",ini:"JH",col:"#3A2840"},
  {id:"s7",nm:"Kenan A.",role:"Masseur",rt:5.0,cat:"massage",ini:"KA",col:"#1A3430"},
  {id:"s8",nm:"Elif T.",role:"Friseurin",rt:4.8,cat:"friseur",ini:"ET",col:"#3A2048"},
  {id:"s9",nm:"Jan W.",role:"Barber",rt:4.6,cat:"barber",ini:"JW",col:"#283A28"},
  {id:"s10",nm:"Sarah L.",role:"Kosmetikerin",rt:4.9,cat:"kosmetik",ini:"SL",col:"#4A2848"},
  {id:"s11",nm:"Mia K.",role:"Nail Designerin",rt:4.8,cat:"nail",ini:"MK",col:"#38382A"},
  {id:"s12",nm:"Timo F.",role:"Masseur",rt:4.7,cat:"massage",ini:"TF",col:"#1A3028"},
  {id:"s13",nm:"Nadine R.",role:"Lash Stylistin",rt:4.9,cat:"lash",ini:"NR",col:"#3A3020"},
  {id:"s14",nm:"Dr. Schneider",role:"Dermatologe",rt:4.8,cat:"arzt",ini:"DS",col:"#1A2840"}
];
const PROVS=[
  {id:"p1",cat:"barber",nm:"BlackLabel Barbershop",st:"Münchener Str. 17",city:"Frankfurt",rt:4.9,rc:412,tl:"Premium Fades & Beard Design",tags:["Fade","Skin Fade","Bart","Herrenschnitt","Rasur"],disc:15,bc:"#C8A84B",prom:true,ver:true,live:true,frei:3,tier:"gold",boost:95,logo:null,sps:["s1","s5"],rental:[{type:"stuhl",pr:45},{type:"raum",pr:60}],svs:[{id:"sv1",nm:"Signature Cut",dur:40,pr:42},{id:"sv2",nm:"Skin Fade",dur:45,pr:48},{id:"sv3",nm:"Beard Design",dur:30,pr:28}],revs:[{u:"Tobias K.",s:5,t:"Absolut top!",d:"12.02.2026"},{u:"Markus L.",s:5,t:"Super Atmosphäre.",d:"05.02.2026"}],gal:[{b:"#3A2818",a:"#5A4828",sv:"Skin Fade"},{b:"#2A1A10",a:"#4A3A20",sv:"Beard Design"}]},
  {id:"p2",cat:"kosmetik",nm:"Glow Studio",st:"Maximilianstr. 18",city:"München",rt:4.8,rc:234,tl:"Organic Facials & Skin Care",tags:["Facial","Peeling","Hautreinigung","Gesichtspflege","Anti-Aging"],disc:0,bc:"#D4829A",prom:false,ver:true,live:true,frei:2,tier:"free",boost:0,logo:null,sps:["s2","s10"],rental:[{type:"liege",pr:38},{type:"raum",pr:50}],svs:[{id:"sv4",nm:"Deep Cleanse Facial",dur:60,pr:85},{id:"sv5",nm:"Chemical Peeling",dur:45,pr:65}],revs:[{u:"Anna S.",s:5,t:"Haut strahlt!",d:"08.02.2026"}],gal:[{b:"#3A2028",a:"#5A3848",sv:"Facial"}]},
  {id:"p3",cat:"aesthetik",nm:"AesthetiQ Klinik",st:"Kurfürstendamm 55",city:"Berlin",rt:5.0,rc:188,tl:"Med. Ästhetik & Anti-Aging",tags:["Botox","Filler","Haartransplantation","Faltenbehandlung","Lippenunterspritzung","Schönheitsklinik"],disc:10,bc:"#6AAED4",prom:true,ver:true,live:false,frei:0,tier:"premium",boost:70,logo:null,sps:["s3"],rental:[{type:"raum",pr:120}],svs:[{id:"sv6",nm:"Botox",dur:30,pr:320},{id:"sv7",nm:"Hyaluron Filler",dur:45,pr:450},{id:"sv36",nm:"Haartransplantation Beratung",dur:60,pr:0}],revs:[{u:"Sandra M.",s:5,t:"Dr. Meyer ist der Beste.",d:"10.02.2026"}],gal:[]},
  {id:"p4",cat:"nail",nm:"NailLab by Lena",st:"Jungfernstieg 7",city:"Hamburg",rt:4.9,rc:301,tl:"Gel Nails & Premium Nail Art",tags:["Gel","Nail Art","Maniküre","Pediküre","Shellac"],disc:0,bc:"#C8A87A",prom:false,ver:true,live:true,frei:1,tier:"free",boost:0,logo:null,sps:["s4","s11"],rental:[{type:"stuhl",pr:30}],svs:[{id:"sv8",nm:"Gel Manicure",dur:60,pr:55},{id:"sv9",nm:"Nail Art Design",dur:90,pr:75}],revs:[{u:"Julia R.",s:5,t:"Traumhafte Nägel!",d:"14.02.2026"}],gal:[{b:"#2A2818",a:"#4A4828",sv:"Gel"},{b:"#281828",a:"#483848",sv:"Nail Art"}]},
  {id:"p5",cat:"friseur",nm:"Maison Haarwerk",st:"Königsallee 44",city:"Düsseldorf",rt:4.9,rc:318,tl:"Premium Haarschnitt & Colorationen",tags:["Damenschnitt","Herrenschnitt","Balayage","Strähnchen","Haarfarbe","Haarverlängerung"],disc:10,bc:"#9A70C8",prom:true,ver:true,live:true,frei:2,tier:"gold",boost:88,logo:null,sps:["s6"],rental:[{type:"stuhl",pr:50},{type:"raum",pr:65}],svs:[{id:"sv10",nm:"Damenschnitt & Styling",dur:60,pr:65},{id:"sv11",nm:"Herrenschnitt",dur:35,pr:38},{id:"sv12",nm:"Balayage / Highlights",dur:120,pr:120}],revs:[{u:"Klara W.",s:5,t:"Traumhafte Farbe!",d:"15.02.2026"},{u:"Tom B.",s:5,t:"Bester Haarschnitt.",d:"09.02.2026"}],gal:[{b:"#2A1828",a:"#4A3048",sv:"Balayage"},{b:"#1A1828",a:"#3A3048",sv:"Damenschnitt"}]},
  {id:"p6",cat:"massage",nm:"ZenFlow Massage",st:"Schildergasse 12",city:"Köln",rt:5.0,rc:276,tl:"Klassische & Tiefengewebsmassagen",tags:["Klassisch","Tiefengewebe","Hot Stone","Sportmassage","Lymphdrainage"],disc:0,bc:"#4AA890",prom:true,ver:true,live:true,frei:4,tier:"premium",boost:60,logo:null,sps:["s7"],rental:[{type:"liege",pr:40},{type:"raum",pr:55}],svs:[{id:"sv13",nm:"Klassische Massage",dur:60,pr:75},{id:"sv14",nm:"Tiefengewebsmassage",dur:60,pr:90},{id:"sv15",nm:"Hot Stone Massage",dur:90,pr:110}],revs:[{u:"Peter N.",s:5,t:"Absolut entspannend!",d:"13.02.2026"},{u:"Sabine K.",s:5,t:"Kenan ist ein Profi.",d:"07.02.2026"}],gal:[]},
  {id:"p7",cat:"barber",nm:"King's Cut Berlin",st:"Torstraße 89",city:"Berlin",rt:4.8,rc:189,tl:"Urban Barbershop Culture",tags:["Fade","Razor","Bart","Herrenschnitt","Konturenschnitt"],disc:20,bc:"#D4A840",prom:true,ver:true,live:true,frei:2,tier:"premium",boost:55,logo:null,sps:["s9"],rental:[{type:"stuhl",pr:42}],svs:[{id:"sv16",nm:"Classic Cut",dur:35,pr:35},{id:"sv17",nm:"Hot Towel Shave",dur:30,pr:30},{id:"sv18",nm:"Full Service",dur:60,pr:58}],revs:[{u:"Leon M.",s:5,t:"Bester Barber in Berlin!",d:"18.02.2026"},{u:"Felix A.",s:4,t:"Super Ergebnis.",d:"11.02.2026"}],gal:[{b:"#2A2010",a:"#4A4020",sv:"Fade"}]},
  {id:"p8",cat:"friseur",nm:"Haarmonie Stuttgart",st:"Calwer Str. 22",city:"Stuttgart",rt:4.7,rc:156,tl:"Nachhaltige Friseur-Kunst",tags:["Bio","Vegan","Balayage","Naturfarbe","Haarschnitt"],disc:0,bc:"#7AB870",prom:false,ver:true,live:true,frei:3,tier:"free",boost:0,logo:null,sps:["s8"],rental:[{type:"stuhl",pr:35}],svs:[{id:"sv19",nm:"Bio Haarschnitt",dur:45,pr:52},{id:"sv20",nm:"Vegan Coloration",dur:90,pr:95}],revs:[{u:"Marie S.",s:5,t:"Endlich ein nachhaltiger Salon!",d:"20.02.2026"}],gal:[{b:"#182A18",a:"#284A28",sv:"Bio"}]},
  {id:"p9",cat:"kosmetik",nm:"Skin Atelier",st:"Neuer Wall 15",city:"Hamburg",rt:4.9,rc:210,tl:"Luxus Hautpflege & Treatments",tags:["Microneedling","Facial","Anti-Aging","Haarentfernung","Hautstraffung","Fruchtsäurepeeling"],disc:15,bc:"#C880A0",prom:true,ver:true,live:true,frei:1,tier:"gold",boost:82,logo:null,sps:["s10"],rental:[{type:"liege",pr:45},{type:"raum",pr:70}],svs:[{id:"sv21",nm:"Luxus Facial",dur:75,pr:120},{id:"sv22",nm:"Microneedling",dur:60,pr:150},{id:"sv37",nm:"Laser Haarentfernung",dur:45,pr:130}],revs:[{u:"Lisa W.",s:5,t:"Beste Behandlung ever!",d:"22.02.2026"}],gal:[{b:"#2A1828",a:"#4A3040",sv:"Facial"}]},
  {id:"p10",cat:"massage",nm:"Lotus Wellness",st:"Hohenzollernring 33",city:"Köln",rt:4.8,rc:198,tl:"Asiatische Massage-Tradition",tags:["Thai","Shiatsu","Aromatherapie","Fußreflexzonen","Rückenmassage"],disc:0,bc:"#60A8A0",prom:false,ver:true,live:true,frei:5,tier:"free",boost:0,logo:null,sps:["s12"],rental:[{type:"liege",pr:35},{type:"raum",pr:48}],svs:[{id:"sv23",nm:"Thai Massage",dur:60,pr:70},{id:"sv24",nm:"Shiatsu",dur:75,pr:85},{id:"sv25",nm:"Aromatherapie",dur:90,pr:100}],revs:[{u:"Hans B.",s:5,t:"Wie in Thailand!",d:"16.02.2026"}],gal:[]},
  {id:"p11",cat:"nail",nm:"Glitter & Glow Nails",st:"Zeil 28",city:"Frankfurt",rt:4.7,rc:145,tl:"Trendy Nail Art Studio",tags:["Chrome","Airbrush","Extensions","Acryl","French Nails"],disc:10,bc:"#C0A0D0",prom:false,ver:true,live:true,frei:2,tier:"free",boost:0,logo:null,sps:["s11"],rental:[{type:"stuhl",pr:28}],svs:[{id:"sv26",nm:"Chrome Nails",dur:75,pr:65},{id:"sv27",nm:"Airbrush Design",dur:90,pr:85}],revs:[{u:"Lara T.",s:4,t:"Coole Designs!",d:"19.02.2026"}],gal:[{b:"#281838",a:"#483058",sv:"Chrome"}]},
  {id:"p12",cat:"aesthetik",nm:"Face Perfect München",st:"Leopoldstr. 31",city:"München",rt:4.9,rc:167,tl:"Lippenunterspritzung & Profhilo",tags:["Lippen","Profhilo","Mesotherapie","Faltenunterspritzung","Schönheitsklinik","Haartransplantation"],disc:0,bc:"#80A8D8",prom:true,ver:true,live:true,frei:1,tier:"premium",boost:50,logo:null,sps:["s3"],rental:[{type:"raum",pr:100}],svs:[{id:"sv28",nm:"Lippen Filler",dur:30,pr:380},{id:"sv29",nm:"Profhilo",dur:45,pr:420},{id:"sv38",nm:"Haartransplantation FUE",dur:180,pr:2500}],revs:[{u:"Nina G.",s:5,t:"Natürliches Ergebnis!",d:"21.02.2026"}],gal:[]},
  {id:"p13",cat:"lash",nm:"LashPerfect Studio",st:"Sendlinger Str. 28",city:"München",rt:4.9,rc:178,tl:"Premium Wimpern & Brow Design",tags:["Lash Extensions","Lash Lifting","Brow Lamination","Wimpernverlängerung","Augenbrauen"],disc:0,bc:"#B8A060",prom:false,ver:true,live:true,frei:3,tier:"free",boost:0,logo:null,sps:["s13"],rental:[{type:"stuhl",pr:32}],svs:[{id:"sv30",nm:"Classic Lash Extensions",dur:90,pr:89},{id:"sv31",nm:"Lash Lifting & Tinting",dur:60,pr:55},{id:"sv32",nm:"Brow Lamination",dur:45,pr:45}],revs:[{u:"Jenny K.",s:5,t:"Perfekte Wimpern!",d:"23.02.2026"}],gal:[{b:"#2A2418",a:"#4A4028",sv:"Lash Extensions"}]},
  {id:"p14",cat:"arzt",nm:"Derma Zentrum Berlin",st:"Friedrichstr. 112",city:"Berlin",rt:4.9,rc:203,tl:"Dermatologie & Laserbehandlung",tags:["Laser","Hautcheck","Akne","Haarentfernung","Haartransplantation","Laserbehandlung","Pigmentflecken","Narbenbehandlung"],disc:5,bc:"#6090C8",prom:true,ver:true,live:true,frei:2,tier:"gold",boost:78,logo:null,sps:["s14"],rental:[{type:"raum",pr:90},{type:"opraum",pr:350}],svs:[{id:"sv33",nm:"Hautkrebs-Screening",dur:30,pr:95},{id:"sv34",nm:"Laser Haarentfernung",dur:45,pr:150},{id:"sv35",nm:"Akne Behandlung",dur:40,pr:120},{id:"sv39",nm:"Haartransplantation Beratung",dur:45,pr:0}],revs:[{u:"Max B.",s:5,t:"Sehr professionell!",d:"24.02.2026"}],gal:[]},
  {id:"p15",cat:"opraum",nm:"MedCenter OP-Räume",st:"Kaiserstr. 40",city:"Frankfurt",rt:5.0,rc:89,tl:"Sterile OP-Räume für Chirurgen & Ärzte",tags:["OP-Raum","Steril","Chirurgie","Haartransplantation","Schönheits-OP","Operationssaal","Ambulant"],disc:0,bc:"#50B8A0",prom:true,ver:true,live:true,frei:2,tier:"gold",boost:90,logo:null,sps:["s3","s14"],rental:[{type:"opraum",pr:450}],svs:[{id:"sv40",nm:"OP-Raum Tagesmiete",dur:480,pr:450},{id:"sv41",nm:"OP-Raum Halbtag",dur:240,pr:280},{id:"sv42",nm:"Sterilisation & Aufbereitung",dur:60,pr:80}],revs:[{u:"Dr. Yilmaz",s:5,t:"Perfekt ausgestattet, steril und modern.",d:"20.02.2026"},{u:"Dr. Fischer",s:5,t:"Beste OP-Räume in Frankfurt.",d:"15.02.2026"}],gal:[]},
  {id:"p16",cat:"opraum",nm:"SterileSpace München",st:"Prinzregentenstr. 22",city:"München",rt:4.9,rc:67,tl:"Premium OP-Räume & Behandlungszimmer",tags:["OP-Raum","Steril","Ambulante Chirurgie","Haartransplantation","Implantate","Operationssaal"],disc:10,bc:"#40A890",prom:true,ver:true,live:true,frei:1,tier:"premium",boost:65,logo:null,sps:["s3"],rental:[{type:"opraum",pr:400},{type:"raum",pr:120}],svs:[{id:"sv43",nm:"OP-Raum Premium (Ganztag)",dur:480,pr:400},{id:"sv44",nm:"Behandlungsraum Steril",dur:240,pr:180}],revs:[{u:"Dr. Berger",s:5,t:"Top Ausstattung, alles steril.",d:"18.02.2026"}],gal:[]}
];
const CITIES=[...new Set(PROVS.map(p=>p.city))].sort();
// Service catalog per category — providers can toggle these on/off
const SVC_CATALOG={
  barber:[{nm:"Herrenschnitt",dur:30,pr:28},{nm:"Skin Fade",dur:40,pr:35},{nm:"Beard Trim",dur:20,pr:15},{nm:"Bart Design",dur:30,pr:25},{nm:"Hot Towel Shave",dur:30,pr:28},{nm:"Full Service (Cut + Bart)",dur:60,pr:50},{nm:"Kinderschnitt",dur:20,pr:18},{nm:"Kopfmassage",dur:15,pr:12},{nm:"Augenbrauen",dur:10,pr:8},{nm:"Nasenhaare Waxing",dur:5,pr:5}],
  friseur:[{nm:"Damenschnitt",dur:45,pr:45},{nm:"Herrenschnitt",dur:30,pr:32},{nm:"Waschen & Föhnen",dur:30,pr:25},{nm:"Balayage / Highlights",dur:120,pr:120},{nm:"Komplett-Coloration",dur:90,pr:85},{nm:"Strähnchen",dur:90,pr:95},{nm:"Haarverlängerung",dur:180,pr:250},{nm:"Brautfrisur",dur:90,pr:120},{nm:"Kinderschnitt",dur:20,pr:18},{nm:"Kopfhaut-Treatment",dur:30,pr:35}],
  kosmetik:[{nm:"Klassisches Facial",dur:60,pr:75},{nm:"Anti-Aging Behandlung",dur:75,pr:120},{nm:"Chemical Peeling",dur:45,pr:65},{nm:"Microdermabrasion",dur:45,pr:80},{nm:"Hautreinigung",dur:60,pr:55},{nm:"Augenbrauen Waxing",dur:15,pr:12},{nm:"Wimpern Lifting",dur:60,pr:55},{nm:"Rückenbehandlung",dur:50,pr:70},{nm:"Fruchtsäurepeeling",dur:40,pr:60},{nm:"Ultraschall-Behandlung",dur:45,pr:85}],
  aesthetik:[{nm:"Botox",dur:30,pr:280},{nm:"Hyaluron Filler",dur:45,pr:380},{nm:"Lippen Unterspritzung",dur:30,pr:350},{nm:"Profhilo",dur:45,pr:420},{nm:"Mesotherapie",dur:45,pr:200},{nm:"PRP Behandlung",dur:60,pr:350},{nm:"Faltenunterspritzung",dur:30,pr:300},{nm:"Haartransplantation Beratung",dur:60,pr:0}],
  nail:[{nm:"Gel Maniküre",dur:60,pr:45},{nm:"Shellac",dur:45,pr:35},{nm:"Nail Art Design",dur:90,pr:75},{nm:"Acryl Verlängerung",dur:90,pr:65},{nm:"French Nails",dur:60,pr:50},{nm:"Pediküre",dur:50,pr:40},{nm:"Chrome Nails",dur:75,pr:60},{nm:"Nail Repair",dur:30,pr:20}],
  massage:[{nm:"Klassische Massage",dur:60,pr:65},{nm:"Tiefengewebsmassage",dur:60,pr:80},{nm:"Hot Stone Massage",dur:90,pr:100},{nm:"Thai Massage",dur:60,pr:70},{nm:"Sportmassage",dur:45,pr:60},{nm:"Lymphdrainage",dur:60,pr:75},{nm:"Fußreflexzonen",dur:30,pr:40},{nm:"Aromatherapie",dur:75,pr:85},{nm:"Shiatsu",dur:60,pr:75}],
  lash:[{nm:"Classic Lash Extensions",dur:90,pr:85},{nm:"Volume Lash Extensions",dur:120,pr:120},{nm:"Lash Lifting & Tinting",dur:60,pr:55},{nm:"Wimpern Auffüllen",dur:60,pr:50},{nm:"Brow Lamination",dur:45,pr:45},{nm:"Brow Shaping",dur:30,pr:25},{nm:"Lash Removal",dur:30,pr:25}],
  arzt:[{nm:"Hautkrebs-Screening",dur:30,pr:95},{nm:"Laser Haarentfernung",dur:45,pr:150},{nm:"Akne Behandlung",dur:40,pr:120},{nm:"Derma-Beratung",dur:30,pr:80},{nm:"Narbenbehandlung",dur:60,pr:200},{nm:"Pigmentflecken Laser",dur:45,pr:180},{nm:"Haartransplantation",dur:180,pr:2500}],
  raum:[],
  opraum:[{nm:"OP-Raum Tagesmiete",dur:480,pr:450},{nm:"OP-Raum Halbtag",dur:240,pr:280},{nm:"Sterilisation & Aufbereitung",dur:60,pr:80}]
};
// Opening hours per provider
const defaultHrs={Mo:"09:00–19:00",Di:"09:00–19:00",Mi:"09:00–19:00",Do:"09:00–19:00",Fr:"09:00–19:00",Sa:"10:00–16:00",So:"Geschlossen"};
const HOURS={
  p1:{Mo:"09:00–20:00",Di:"09:00–20:00",Mi:"09:00–20:00",Do:"09:00–20:00",Fr:"09:00–20:00",Sa:"09:00–17:00",So:"Geschlossen"},
  p2:{Mo:"Geschlossen",Di:"10:00–18:00",Mi:"10:00–18:00",Do:"10:00–20:00",Fr:"10:00–18:00",Sa:"10:00–16:00",So:"Geschlossen"},
  p3:{Mo:"08:00–18:00",Di:"08:00–18:00",Mi:"08:00–18:00",Do:"08:00–18:00",Fr:"08:00–16:00",Sa:"Nach Vereinbarung",So:"Geschlossen"},
  p5:{Mo:"Geschlossen",Di:"09:00–19:00",Mi:"09:00–19:00",Do:"09:00–21:00",Fr:"09:00–19:00",Sa:"09:00–17:00",So:"Geschlossen"},
  p7:{Mo:"10:00–20:00",Di:"10:00–20:00",Mi:"10:00–20:00",Do:"10:00–20:00",Fr:"10:00–21:00",Sa:"10:00–18:00",So:"12:00–17:00"},
  p8:{Mo:"Geschlossen",Di:"09:00–18:00",Mi:"09:00–18:00",Do:"09:00–18:00",Fr:"09:00–18:00",Sa:"09:00–14:00",So:"Geschlossen"},
  p10:{Mo:"10:00–20:00",Di:"10:00–20:00",Mi:"10:00–20:00",Do:"10:00–20:00",Fr:"10:00–20:00",Sa:"10:00–18:00",So:"11:00–17:00"},
  p15:{Mo:"07:00–19:00",Di:"07:00–19:00",Mi:"07:00–19:00",Do:"07:00–19:00",Fr:"07:00–17:00",Sa:"Nach Vereinbarung",So:"Geschlossen"},
  p16:{Mo:"08:00–18:00",Di:"08:00–18:00",Mi:"08:00–18:00",Do:"08:00–18:00",Fr:"08:00–16:00",Sa:"Nach Vereinbarung",So:"Geschlossen"}
};
function getHrs(pid){return HOURS[pid]||defaultHrs;}
function isOpenNow(pid){const h=getHrs(pid);const d=new Date();const days=["So","Mo","Di","Mi","Do","Fr","Sa"];const today=days[d.getDay()];const t=h[today];if(!t||t==="Geschlossen"||t==="Nach Vereinbarung")return t==="Nach Vereinbarung"?"info":"closed";const[open,close]=t.split("–");const now=d.getHours()*60+d.getMinutes();const[oh,om]=open.split(":").map(Number);const[ch,cm]=close.split(":").map(Number);return now>=oh*60+om&&now<ch*60+cm?"open":"closed";}
const PROMO_CODES={"CHAIR2026":{discount:15,type:"percent"},"WELCOME10":{discount:10,type:"percent"},"BEAUTY5":{discount:5,type:"fixed"}};
const NOTIFS=[
  {id:"n1",title:"Termin morgen!",body:"Skin Fade bei BlackLabel · Mi 10:00",time:"vor 2 Std.",read:false,icon:"📅"},
  {id:"n2",title:"15% Rabatt",body:"Exklusiv für dich bei King's Cut Berlin",time:"vor 5 Std.",read:false,icon:"🎉"},
  {id:"n3",title:"Neue Bewertung",body:"Tobias K. hat BlackLabel bewertet",time:"Gestern",read:true,icon:"⭐"},
  {id:"n4",title:"Willkommen!",body:"Entdecke die besten Salons in deiner Nähe",time:"vor 2 Tagen",read:true,icon:"👋"}
];

// ═══════════════ STATE ═══════════════
let state={tab:"home",catFilter:"all",detail:null,detailTab:"info",bookingProv:null,bookStep:1,bookSv:null,bookDay:0,bookSlot:null,bookSp:null,subPage:null,role:"CUSTOMER",onboarded:false,obStep:0,
  lang:"de",theme:"dark",favorites:JSON.parse(localStorage.getItem("cm_favs")||"[]"),stamps:parseInt(localStorage.getItem("cm_stamps")||"4"),
  searchQuery:"",searchOpen:false,showFilter:false,filterCity:"all",filterMinRating:0,filterMaxPrice:500,filterOnlyAvail:false,filterOnlyDisc:false,
  viewMode:"list",notifications:[...NOTIFS],
  bookName:"",bookEmail:"",bookPhone:"",bookNotes:"",
  promoCode:"",promoValid:null,promoDiscount:0,
  reviewRating:0,reviewText:"",
  bookings:JSON.parse(localStorage.getItem("cm_bookings")||"[]"),
  loyaltyRedeemed:JSON.parse(localStorage.getItem("cm_redeemed")||"false"),
  regStep:1,regData:{vn:"",nn:"",em:"",tel:"",geschaeft:"",st:"",plz:"",city:"",kat:"",iban:"",gb:false,chair:false,cpr:"",agb:false,dsgvo:false},bookDone:false,regDone:false,
  nlEmail:"",nlSubscribed:JSON.parse(localStorage.getItem("cm_nl")||"false"),
  refCode:"CM-"+(Math.random().toString(36).substring(2,6).toUpperCase()),
  refCount:parseInt(localStorage.getItem("cm_refcount")||"0"),
  refEarnings:parseFloat(localStorage.getItem("cm_refearnings")||"0"),
  adminProv:null,adminTab:"dashboard",
  adminLogo:localStorage.getItem("cm_admin_logo")||null,
  adminIcons:JSON.parse(localStorage.getItem("cm_admin_icons")||"[]"),
  adminSelectedIcon:localStorage.getItem("cm_admin_selicon")||null,
  adminGenerated:false,
  superAdmin:JSON.parse(localStorage.getItem("cm_superadmin")||"false"),saTab:"providers",
  unlockRequests:JSON.parse(localStorage.getItem("cm_unlock")||"[]"),
  provServices:JSON.parse(localStorage.getItem("cm_prov_svcs")||"null"),
  provPrices:JSON.parse(localStorage.getItem("cm_prov_prices")||"{}"),
  b2bRentals:JSON.parse(localStorage.getItem("cm_b2b")||"null")
};
if(localStorage.getItem("cm_theme")==="light"){state.theme="light";document.body.classList.add("light");}
if(localStorage.getItem("cm_lang"))state.lang=localStorage.getItem("cm_lang");

function saveFavs(){localStorage.setItem("cm_favs",JSON.stringify(state.favorites));}
function saveStamps(){localStorage.setItem("cm_stamps",state.stamps);}
function stars(n){let s="";for(let i=1;i<=5;i++)s+=`<span style="opacity:${i<=Math.round(n)?1:.25};color:#F5D060;font-size:15px;text-shadow:${i<=Math.round(n)?"0 0 6px rgba(245,208,96,.5)":"none"}">★</span>`;return s;}
function badge(tx,c){return`<span class="badge ${c}">${tx}</span>`;}
function showToast(msg){const d=document.createElement("div");d.className="toast";d.textContent=msg;document.body.appendChild(d);setTimeout(()=>d.remove(),2500);}
function toggleFav(id,e){if(e)e.stopPropagation();const i=state.favorites.indexOf(id);if(i>-1){state.favorites.splice(i,1);showToast("Favorit entfernt");}else{state.favorites.push(id);showToast("Zu Favoriten hinzugefügt ♡");}saveFavs();render();}
function tierWeight(t){return t==="gold"?3:t==="premium"?2:1;}
function getFiltered(){let list=[...PROVS];if(state.catFilter!=="all")list=list.filter(p=>p.cat===state.catFilter);if(state.searchQuery){const q=state.searchQuery.toLowerCase();list=list.filter(p=>p.nm.toLowerCase().includes(q)||p.city.toLowerCase().includes(q)||p.tags.some(tg=>tg.toLowerCase().includes(q))||p.cat.toLowerCase().includes(q)||p.tl.toLowerCase().includes(q)||p.svs.some(sv=>sv.nm.toLowerCase().includes(q)));}
if(state.filterCity!=="all")list=list.filter(p=>p.city===state.filterCity);if(state.filterMinRating>0)list=list.filter(p=>p.rt>=state.filterMinRating);if(state.filterMaxPrice<500)list=list.filter(p=>p.svs.some(sv=>sv.pr<=state.filterMaxPrice));if(state.filterOnlyAvail)list=list.filter(p=>p.live);if(state.filterOnlyDisc)list=list.filter(p=>p.disc>0);
list.sort((a,b)=>{const tw=tierWeight(b.tier)-tierWeight(a.tier);if(tw!==0)return tw;const bw=(b.boost||0)-(a.boost||0);if(bw!==0)return bw;return b.rt-a.rt;});return list;}
function activeFilterCount(){let c=0;if(state.filterCity!=="all")c++;if(state.filterMinRating>0)c++;if(state.filterMaxPrice<500)c++;if(state.filterOnlyAvail)c++;if(state.filterOnlyDisc)c++;return c;}

// ═══════════════ RENDER ═══════════════
function render(){
  const scr=document.getElementById("mainScreen");
  const nav=document.getElementById("navBar");
  if(!state.onboarded){nav.style.display="none";scr.innerHTML=renderOnboarding();return;}
  if(state.subPage){nav.style.display="none";scr.innerHTML=renderSubPage();if(state.subPage==="social")setTimeout(generateQR,50);return;}
  nav.style.display="flex";
  ["home","explore","favorites","offers","account"].forEach(tb=>{
    const a=state.tab===tb||(tb==="home"&&state.detail);
    const el_i=document.getElementById("ni_"+tb);
    const el_l=document.getElementById("nl_"+tb);
    if(el_i)el_i.style.color=a?"var(--gold)":"var(--stone)";
    if(el_l)el_l.style.color=a?"var(--gold)":"var(--stone2)";
  });
  if(state.detail)scr.innerHTML=renderDetail();
  else if(state.tab==="home")scr.innerHTML=renderHome();
  else if(state.tab==="explore")scr.innerHTML=renderExplore();
  else if(state.tab==="favorites")scr.innerHTML=renderFavorites();
  else if(state.tab==="offers")scr.innerHTML=renderOffers();
  else if(state.tab==="account")scr.innerHTML=renderAccount();
  const ov=document.getElementById("bookingOverlay");
  if(state.bookingProv){ov.classList.add("active");document.getElementById("bookingSheet").innerHTML=renderBooking();}
  else ov.classList.remove("active");
  const fov=document.getElementById("filterOverlay");
  if(state.showFilter){fov.classList.add("active");document.getElementById("filterSheet").innerHTML=renderFilterSheet();}
  else fov.classList.remove("active");
}

// ─── ONBOARDING ───
function renderOnboarding(){
  const slides=[{icon:"💈",t:t("welcome"),s:t("subtitle")},{icon:"chair",t:t("chair"),s:t("chairSub")},{icon:"booking",t:t("book"),s:t("bookSub")}];
  if(state.obStep>=3)return`<div style="padding:40px var(--pad) 30px;display:flex;flex-direction:column;gap:12px">
    <button onclick="state.obStep=2;render()" style="align-self:flex-start;color:var(--gold);font-size:var(--font-md);font-weight:700;margin-bottom:4px;background:none;border:none;cursor:pointer;font-family:inherit;min-height:44px;display:flex;align-items:center">← ${t("back")}</button>
    <div style="text-align:center;margin-bottom:6px">${logoHeader(false)}</div>
    <p class="cinzel" style="font-size:var(--font-xl);font-weight:600;text-align:center;margin-bottom:6px;color:var(--gold2)">${t("iAm")}</p>
    ${[[t("customer"),"CUSTOMER"],[t("provider"),"PROVIDER"],[t("b2b"),"B2B"]].map(([l,r])=>`<button class="boutline" style="padding:17px;font-size:var(--font-md);font-weight:700;text-align:left" onclick="finishOnboarding('${r}')">${l}</button>`).join("")}
  </div>`;
  const sl=slides[state.obStep];
  const dots=slides.map((_,i)=>`<div style="width:${i===state.obStep?22:8}px;height:8px;border-radius:4px;background:${i===state.obStep?"var(--gold)":"var(--c4)"};transition:all .3s"></div>`).join("");
  return`<div style="display:flex;flex-direction:column;align-items:center;text-align:center;min-height:100vh;min-height:100dvh;justify-content:center;padding:20px var(--pad)">
    ${state.obStep===0?`<div style="margin-bottom:8px">${logoHeader(false)}</div>`:sl.icon==="chair"?`<div style="margin-bottom:14px;display:flex;gap:4px;align-items:flex-end;justify-content:center;filter:drop-shadow(0 0 12px rgba(200,168,75,.4))"><div>${dbSeat()}</div></div>`:sl.icon==="booking"?`<div style="margin-bottom:14px;filter:drop-shadow(0 0 12px rgba(200,168,75,.4))">${dbBooking()}</div>`:`<div style="font-size:60px;margin-bottom:14px">${sl.icon}</div>`}
    <p class="cinzel" style="font-size:var(--font-xl);font-weight:600;margin-bottom:8px;line-height:1.3;color:var(--gold2)">${sl.t}</p>
    <p style="font-size:var(--font-md);color:var(--stone);line-height:1.6;margin-bottom:28px;max-width:360px">${sl.s}</p>
    <div style="display:flex;gap:8px;margin-bottom:20px">${dots}</div>
    <div style="display:flex;gap:14px;align-items:center;flex-wrap:wrap;justify-content:center">
      ${state.obStep>0?`<button onclick="state.obStep--;render()" style="color:var(--gold);font-size:var(--font-md);font-weight:700;padding:15px 20px;background:none;border:1.5px solid rgba(200,168,75,.3);border-radius:14px;cursor:pointer;font-family:inherit;min-height:48px">← ${t("back")}</button>`:""}
      <button class="bgold" style="width:auto;padding:15px 36px;font-size:var(--font-md)" onclick="nextOb()">
        ${state.obStep<2?t("next"):t("go")}
      </button>
    </div>
  </div>`;}

// ─── HOME (v5.2 grid layout + v6.0 features) ───
function renderHome(){
  const f=state.catFilter;
  const list=getFiltered();
  const h2=new Date().getHours();
  const gr=h2<12?t("morning"):h2<17?t("afternoon"):t("evening");
  const catIcons={barber:catSVG("barber"),friseur:catSVG("friseur"),kosmetik:catSVG("kosmetik"),aesthetik:catSVG("aesthetik"),nail:catSVG("nail"),massage:catSVG("massage"),lash:catSVG("lash"),arzt:catSVG("arzt"),raum:catSVG("raum"),opraum:catSVG("opraum")};
  const catColors={barber:"#C8A84B",friseur:"#9A70C8",kosmetik:"#C86090",aesthetik:"#4AA0D8",nail:"#C8987A",massage:"#4AA890",lash:"#B8A060",arzt:"#6090C8",raum:"#D0A870",opraum:"#50B8A0"};
  const afc=activeFilterCount();
  const catCards=CATS.map(c=>`
    <div onclick="setCat('${c.id}')" style="width:calc(25% - 7px);display:flex;flex-direction:column;align-items:center;gap:5px;padding:10px 2px 10px;border-radius:14px;background:${f===c.id?"rgba(200,168,75,.07)":"var(--c2)"};border:1.5px solid ${f===c.id?"var(--gold)":"var(--border)"};cursor:pointer;position:relative;min-height:82px">
      ${f===c.id?`<div style="position:absolute;top:4px;right:4px;width:12px;height:12px;border-radius:50%;background:var(--gold);font-size:6px;font-weight:900;color:#080706;display:flex;align-items:center;justify-content:center">✓</div>`:""}
      <div style="width:46px;height:46px;border-radius:12px;background:linear-gradient(135deg,var(--c3),var(--c4));border:1px solid rgba(200,168,75,.2);display:flex;align-items:center;justify-content:center">${catIcons[c.id]}</div>
      <span style="font-size:10px;font-weight:800;color:${f===c.id?"var(--gold2)":"var(--cream)"};text-align:center;letter-spacing:.02em;line-height:1.15">${c.lbl}</span>
      <span style="font-size:8px;color:var(--stone);text-align:center;line-height:1.15">${c.sub}</span>
    </div>`).join("");
  const provCards=list.map(p=>`
    <div class="card fu" onclick="openDetail('${p.id}')" style="cursor:pointer;${p.tier==="gold"?"border:1.5px solid rgba(200,168,75,.3);box-shadow:0 0 20px rgba(200,168,75,.08)":p.tier==="premium"?"border:1.5px solid rgba(200,168,75,.15)":""}">
      <div style="height:3px;background:${p.tier==="gold"?"linear-gradient(90deg,#C8A84B,#F5E080,#C8A84B)":p.tier==="premium"?"linear-gradient(90deg,#9A70C8,#C8A84B)":p.bc}"></div>
      <div style="padding:13px 15px">
        <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:7px;gap:10px">
          <div style="flex:1;min-width:0">
            <div style="display:flex;gap:5px;flex-wrap:wrap;margin-bottom:5px">
              ${p.tier==="gold"?badge("👑 GOLD","bgd"):p.tier==="premium"?badge("⚡ "+t("premBadge"),"bgd"):""}${p.ver?badge("✓ "+t("verified"),"bgr"):""}${p.disc>0?badge("−"+p.disc+"%","brd"):""}
            </div>
            <div style="display:flex;align-items:center;gap:8px">
              ${p.logo?`<img src="${p.logo}" style="width:28px;height:28px;border-radius:6px;object-fit:cover">`:""}
              <p style="font-size:var(--font-md);font-weight:800;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${p.nm}</p>
            </div>
            <p style="font-size:var(--font-sm);color:var(--stone);overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${p.st} · ${p.city}</p>
          </div>
          <div style="display:flex;flex-direction:column;align-items:flex-end;gap:6px;flex-shrink:0">
            <span class="heart ${state.favorites.includes(p.id)?'liked':''}" onclick="toggleFav('${p.id}',event)" style="font-size:18px">${state.favorites.includes(p.id)?'♥':'♡'}</span>
            <div style="display:flex;align-items:center;gap:3px">${stars(p.rt)}<span style="font-size:var(--font-sm);font-weight:700;color:var(--gold2)">${p.rt}</span></div>
            <span style="font-size:11px;color:var(--stone)">(${p.rc})</span>
          </div>
        </div>
        ${p.rental&&p.rental.length>0?`<div style="display:flex;gap:5px;flex-wrap:wrap;margin-bottom:6px">${p.rental.map(r=>`<span style="font-size:10px;padding:3px 7px;border-radius:6px;background:rgba(200,168,75,.08);border:1px solid rgba(200,168,75,.15);color:var(--gold2);font-weight:600">${r.type==="stuhl"?"💺":r.type==="liege"?"🛏":r.type==="opraum"?"🏥":"🚪"} ${r.pr}€/Tag</span>`).join("")}</div>`:""}
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div style="display:flex;gap:8px;align-items:center">
            <div style="display:flex;gap:4px;align-items:center">
              <div style="width:7px;height:7px;border-radius:50%;background:${p.live?"#4A8A5A":"#C04040"}"></div>
              <span style="font-size:11px;color:${p.live?"#6ABF80":"var(--stone)"}">${p.live?p.frei+" "+t("available"):t("soldOut")}</span>
            </div>
            <span style="font-size:10px;color:${isOpenNow(p.id)==="open"?"#6ABF80":isOpenNow(p.id)==="info"?"var(--gold)":"var(--stone)"};font-weight:600">${isOpenNow(p.id)==="open"?"● Offen":isOpenNow(p.id)==="info"?"Auf Anfrage":"Geschlossen"}</span>
          </div>
          <span style="font-size:var(--font-md);font-weight:800;color:var(--gold2)">${t("from")} ${p.svs[0].pr} €</span>
        </div>
      </div>
    </div>`).join("");
  return`
    <!-- LOGO HERO -->
    <div style="padding:var(--pad) var(--pad) 0;display:flex;justify-content:space-between;align-items:center;gap:12px">
      ${logoHeader(true)}
      <div style="display:flex;align-items:center;gap:6px;flex-shrink:0">
        <div style="text-align:right">
          <p style="font-size:var(--font-sm);font-weight:600;color:var(--cream);white-space:nowrap">${gr}</p>
          <p style="font-size:10px;color:var(--stone);white-space:nowrap">${t("nationwide")}</p>
        </div>
        <button onclick="goSub('notifications')" style="position:relative;font-size:18px;min-width:40px;min-height:40px;display:flex;align-items:center;justify-content:center">${state.notifications.filter(n=>!n.read).length>0?`<span style="position:absolute;top:2px;right:2px;width:8px;height:8px;border-radius:50%;background:var(--red)"></span>`:""} 🔔</button>
      </div>
    </div>

    <!-- PROMO BANNER -->
    <div style="margin:14px var(--pad)" class="fu d1">
      <div class="card" style="padding:var(--pad);background:linear-gradient(135deg,#1E1A08,#141008)">
        <span class="badge bgd" style="margin-bottom:10px">🎉 ${t("special")}</span>
        <p class="cinzel" style="font-size:var(--font-lg);font-weight:600;line-height:1.3;margin-bottom:4px;color:var(--gold2)">${t("promoTitle")}<br/>${t("promoSub")}</p>
        <p style="font-size:var(--font-sm);color:var(--stone);margin-bottom:12px">${t("promoCode")}</p>
        <button class="bgold" style="width:auto;padding:11px 22px;font-size:var(--font-md)" onclick="goTab('explore')">${t("bookNow")}</button>
      </div>
    </div>

    <!-- SEARCH + FILTER -->
    <div style="padding:0 var(--pad) 14px" class="fu d1">
      <div style="display:flex;gap:8px">
        <div onclick="focusSearch()" style="flex:1;display:flex;align-items:center;gap:10px;padding:12px 16px;background:var(--c2);border-radius:13px;border:1px solid var(--border)">
          <span>🔍</span>
          <input id="searchInp" class="inp" style="padding:0;background:transparent;border:none;font-size:16px" placeholder="${t("search")}" value="${state.searchQuery}" oninput="onSearch(this.value)"/>
        </div>
        <button onclick="toggleFilter()" style="width:48px;height:48px;border-radius:13px;background:var(--c2);border:1px solid ${afc>0?"var(--gold)":"var(--border)"};display:flex;align-items:center;justify-content:center;font-size:18px;position:relative;flex-shrink:0">
          ⚙${afc>0?`<span style="position:absolute;top:-3px;right:-3px;width:16px;height:16px;border-radius:50%;background:var(--gold);color:#080706;font-size:9px;font-weight:800;display:flex;align-items:center;justify-content:center">${afc}</span>`:""}
        </button>
      </div>
      ${!state.searchQuery?`<div style="display:flex;gap:6px;flex-wrap:wrap;margin-top:10px">${["Haartransplantation","Haarentfernung","OP-Raum","Botox","Balayage","Massage","Skin Fade","Lash Extensions"].map(s=>`<button onclick="onSearch('${s}')" style="padding:6px 12px;border-radius:20px;font-size:11px;font-weight:600;background:var(--c3);color:var(--stone);border:1px solid var(--border);cursor:pointer;font-family:inherit">${s}</button>`).join("")}</div>`:""}
    </div>

    <!-- CATEGORIES 4x2 GRID -->
    <div style="padding:0 var(--pad) 18px" class="fu d2">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
        <p class="lsm">${t("categories")}</p>
        <button onclick="setCat('all')" style="font-size:var(--font-sm);color:var(--gold);cursor:pointer;border:none;background:none;font-family:inherit;min-height:44px;display:flex;align-items:center">${t("all")}</button>
      </div>
      <div style="display:flex;flex-wrap:wrap;gap:9px">${catCards}</div>
    </div>

    <!-- TOP SPECIALISTS -->
    <div style="margin-bottom:20px" class="fu d2">
      <div style="padding:0 var(--pad);display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
        <p class="lsm">${t("topSpecs")}</p>
        <span class="badge bgr" style="font-size:9px">${t("availToday")}</span>
      </div>
      <div style="display:flex;gap:12px;overflow-x:auto;padding:0 var(--pad) 4px;-webkit-overflow-scrolling:touch;scroll-snap-type:x proximity">
        ${SPECS.map(s=>`<div style="flex-shrink:0;text-align:center;width:68px;scroll-snap-align:start">
          <div style="width:54px;height:54px;border-radius:50%;background:${s.col};display:flex;align-items:center;justify-content:center;font-size:16px;font-weight:800;border:2px solid rgba(200,168,75,.2);margin:0 auto 5px">${s.ini}</div>
          <p style="font-size:11px;font-weight:700">${s.nm.split(" ")[0]}</p>
          <p style="font-size:9px;color:var(--stone)">${s.role.split(" ")[0]}</p>
        </div>`).join("")}
      </div>
    </div>

    <!-- NEWSLETTER -->
    ${!state.nlSubscribed?`<div style="margin:0 var(--pad) 16px" class="fu d2">
      <div class="card" style="padding:16px;background:linear-gradient(135deg,#1A1608,#0E0C04);border:1px solid rgba(200,168,75,.2)">
        <p class="lgold" style="margin-bottom:6px">📩 NEWSLETTER</p>
        <p style="font-size:var(--font-md);font-weight:700;margin-bottom:4px;color:var(--gold2)">${t("nlTitle")}</p>
        <p style="font-size:var(--font-sm);color:var(--stone);margin-bottom:12px;line-height:1.5">${t("nlSub")}</p>
        <div style="display:flex;gap:8px">
          <input id="nlInput" class="inp" style="flex:1;padding:11px 14px;font-size:14px" placeholder="${t("nlPlaceholder")}" value="${state.nlEmail}" oninput="state.nlEmail=this.value"/>
          <button class="bgold" style="width:auto;padding:11px 16px;font-size:var(--font-sm);white-space:nowrap" onclick="subscribeNL()">${t("nlButton")}</button>
        </div>
      </div>
    </div>`:""}

    <!-- VIEW MODE + PROVIDERS -->
    <div style="padding:0 var(--pad) 10px;display:flex;justify-content:space-between;align-items:center" class="fu d3">
      <div style="display:flex;align-items:center;gap:6px">
        <p class="lsm">${f==="all"?t("allProviders"):CATS.find(c=>c.id===f)?.lbl}</p>
        <span style="font-size:11px;color:var(--stone)">(${list.length})</span>
      </div>
      <div style="display:flex;gap:4px">
        <button onclick="setView('list')" style="padding:8px 14px;border-radius:8px;font-size:11px;font-weight:700;min-height:36px;background:${state.viewMode==='list'?'var(--gold)':'var(--c3)'};color:${state.viewMode==='list'?'#080706':'var(--stone)'}">${t("list")}</button>
        <button onclick="setView('map')" style="padding:8px 14px;border-radius:8px;font-size:11px;font-weight:700;min-height:36px;background:${state.viewMode==='map'?'var(--gold)':'var(--c3)'};color:${state.viewMode==='map'?'#080706':'var(--stone)'}">${t("map")}</button>
      </div>
    </div>
    <div style="padding:0 var(--pad)" class="fu d3">
      ${state.viewMode==="map"?renderMapView(list):`
        ${list.length===0?`<div style="text-align:center;padding:40px 0"><p style="font-size:36px;margin-bottom:12px">🔍</p><p style="font-size:var(--font-md);font-weight:700;margin-bottom:4px">${t("noResults")}</p><p style="font-size:var(--font-md);color:var(--stone)">${t("tryOther")}</p></div>`:`<div style="display:flex;flex-direction:column;gap:10px">${provCards}</div>`}
      `}
    </div>
    <div style="height:20px"></div>`;
}

// ─── MAP VIEW ───
function renderMapView(list){
  const cityPos={Frankfurt:{x:48,y:52},München:{x:72,y:82},Berlin:{x:72,y:22},Hamburg:{x:52,y:12},Düsseldorf:{x:32,y:42},Köln:{x:30,y:48},Stuttgart:{x:55,y:75}};
  const pins=list.map(p=>{const pos=cityPos[p.city];if(!pos)return"";return`<div onclick="openDetail('${p.id}')" style="position:absolute;left:${pos.x}%;top:${pos.y}%;transform:translate(-50%,-100%);cursor:pointer;text-align:center;z-index:2">
    <div style="background:${p.bc};color:#fff;padding:3px 8px;border-radius:8px;font-size:10px;font-weight:700;white-space:nowrap;box-shadow:0 2px 8px rgba(0,0,0,.4)">${p.nm.split(" ")[0]}</div>
    <div style="width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:6px solid ${p.bc};margin:0 auto"></div>
  </div>`;}).join("");
  return`<div style="position:relative;background:var(--c2);border-radius:18px;border:1px solid var(--border);height:380px;overflow:hidden">
    <div style="position:absolute;inset:0;opacity:.15;background:radial-gradient(circle at 55% 45%,var(--gold) 0%,transparent 70%)"></div>
    <svg style="position:absolute;inset:0;width:100%;height:100%;opacity:.2" viewBox="0 0 100 100"><path d="M30 5 Q25 15 28 25 Q32 35 27 42 Q22 50 25 60 Q30 72 28 82 Q26 90 30 98" stroke="var(--gold)" fill="none" stroke-width=".3"/><path d="M70 2 Q75 12 72 22 Q68 32 73 42 Q78 52 75 62 Q70 72 72 85" stroke="var(--gold)" fill="none" stroke-width=".3"/><text x="50" y="50" text-anchor="middle" fill="var(--stone)" font-size="3" opacity=".5">DEUTSCHLAND</text></svg>
    ${pins}
    <div style="position:absolute;bottom:10px;left:10px;right:10px;display:flex;gap:6px;overflow-x:auto;padding:4px 0">
      ${list.slice(0,4).map(p=>`<div onclick="openDetail('${p.id}')" style="flex-shrink:0;background:var(--c1);border-radius:12px;padding:10px;border:1px solid var(--border);min-width:160px;cursor:pointer">
        <p style="font-size:12px;font-weight:700">${p.nm}</p>
        <p style="font-size:10px;color:var(--stone)">${p.city} · ${stars(p.rt)}</p>
      </div>`).join("")}
    </div>
  </div>`;
}

// ─── FILTER SHEET ───
function renderFilterSheet(){
  return`<div style="padding:var(--pad)">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:18px">
      <p style="font-size:18px;font-weight:800">${t("filter")}</p>
      <button onclick="resetFilters()" style="font-size:13px;color:var(--gold)">${t("reset")}</button>
    </div>
    <p class="lsm" style="margin-bottom:8px">${t("city")}</p>
    <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:16px">
      <button onclick="setFilterCity('all')" style="padding:8px 14px;border-radius:10px;font-size:12px;font-weight:700;background:${state.filterCity==="all"?"var(--gold)":"var(--c3)"};color:${state.filterCity==="all"?"#080706":"var(--stone)"};border:1px solid ${state.filterCity==="all"?"var(--gold)":"var(--border)"}">${t("allCities")}</button>
      ${CITIES.map(c=>`<button onclick="setFilterCity('${c}')" style="padding:8px 14px;border-radius:10px;font-size:12px;font-weight:700;background:${state.filterCity===c?"var(--gold)":"var(--c3)"};color:${state.filterCity===c?"#080706":"var(--stone)"};border:1px solid ${state.filterCity===c?"var(--gold)":"var(--border)"}">${c}</button>`).join("")}
    </div>
    <p class="lsm" style="margin-bottom:8px">${t("minRating")}</p>
    <div style="display:flex;gap:6px;margin-bottom:16px">
      ${[0,4,4.5,4.8,5].map(r=>`<button onclick="setFilterRating(${r})" style="padding:8px 14px;border-radius:10px;font-size:12px;font-weight:700;background:${state.filterMinRating===r?"var(--gold)":"var(--c3)"};color:${state.filterMinRating===r?"#080706":"var(--stone)"};border:1px solid ${state.filterMinRating===r?"var(--gold)":"var(--border)"}">${r===0?t("all"):"★ "+r+"+"}</button>`).join("")}
    </div>
    <p class="lsm" style="margin-bottom:8px">${t("priceRange")}: max ${state.filterMaxPrice}€</p>
    <input type="range" min="20" max="500" step="10" value="${state.filterMaxPrice}" oninput="setFilterPrice(this.value)" style="width:100%;margin-bottom:16px;accent-color:var(--gold)"/>
    <div style="display:flex;gap:10px;margin-bottom:20px">
      <div onclick="toggleFilterAvail()" style="flex:1;display:flex;align-items:center;gap:8px;padding:12px;background:var(--c2);border-radius:12px;border:1px solid ${state.filterOnlyAvail?"var(--gold)":"var(--border)"};cursor:pointer">
        <div class="check ${state.filterOnlyAvail?"on":""}">${state.filterOnlyAvail?"✓":""}</div>
        <span style="font-size:12px;font-weight:600">${t("onlyAvail")}</span>
      </div>
      <div onclick="toggleFilterDisc()" style="flex:1;display:flex;align-items:center;gap:8px;padding:12px;background:var(--c2);border-radius:12px;border:1px solid ${state.filterOnlyDisc?"var(--gold)":"var(--border)"};cursor:pointer">
        <div class="check ${state.filterOnlyDisc?"on":""}">${state.filterOnlyDisc?"✓":""}</div>
        <span style="font-size:12px;font-weight:600">${t("onlyDiscount")}</span>
      </div>
    </div>
    <button class="bgold" onclick="toggleFilter()">${t("apply")} (${getFiltered().length})</button>
  </div>`;
}

// ─── DETAIL (with gallery tab) ───
function renderDetail(){
  const p=state.detail;const dt=state.detailTab;
  const specs=SPECS.filter(s=>p.sps.includes(s.id));
  const tabs=["info","services","team","bewertungen","galerie"].map(tb=>{
    const label=tb==="bewertungen"?t("reviews"):tb==="galerie"?t("gallery"):t(tb);
    return`<button onclick="setDetailTab('${tb}')" style="padding:7px 14px;border-radius:20px;font-size:12px;font-weight:700;flex-shrink:0;background:${dt===tb?"var(--gold)":"var(--c3)"};color:${dt===tb?"#080706":"var(--stone)"};border:1px solid ${dt===tb?"var(--gold)":"var(--border)"}">${label}</button>`;}).join("");
  let content="";
  if(dt==="info") content=`<p style="font-size:14px;color:var(--stone);line-height:1.7;margin-bottom:14px">${p.tl}</p>
    <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:16px">${p.tags.map(tg=>badge(tg,"bgd")).join("")}</div>
    <div style="display:flex;gap:8px;margin-bottom:16px">
      <a href="https://wa.me/?text=${encodeURIComponent(p.nm+' - '+p.st+', '+p.city)}" target="_blank" style="flex:1;display:flex;align-items:center;justify-content:center;gap:6px;padding:12px;background:#25D366;color:#fff;border-radius:12px;font-size:13px;font-weight:700;text-decoration:none">💬 WhatsApp</a>
      <button onclick="toggleFav('${p.id}')" style="flex:1;padding:12px;background:var(--c2);border-radius:12px;border:1px solid var(--border);font-size:13px;font-weight:700">${state.favorites.includes(p.id)?"♥ Favorit":"♡ "+t("favs")}</button>
    </div>
    <div class="card" style="padding:14px;margin-bottom:16px">
      <p class="lgold" style="margin-bottom:10px">🕐 Öffnungszeiten</p>
      ${(()=>{const h=getHrs(p.id);const days=["Mo","Di","Mi","Do","Fr","Sa","So"];const today=["So","Mo","Di","Mi","Do","Fr","Sa"][new Date().getDay()];return days.map(d=>`<div style="display:flex;justify-content:space-between;padding:5px 0;border-bottom:1px solid var(--border);font-size:12px"><span style="font-weight:${d===today?800:400};color:${d===today?"var(--gold2)":"var(--stone)"}">${d}</span><span style="font-weight:${d===today?700:400};color:${h[d]==="Geschlossen"?"#C04040":d===today?"var(--gold2)":"var(--cream)"}">${h[d]}</span></div>`).join("");})()}
    </div>
    ${p.rental&&p.rental.length>0?`<div class="card" style="padding:14px;margin-bottom:16px;border:1.5px solid rgba(200,168,75,.2)">
      <p class="lgold" style="margin-bottom:10px">💺 Vermietung</p>
      ${p.rental.map(r=>{const ico=r.type==="stuhl"?"💺":r.type==="liege"?"🛏":r.type==="opraum"?"🏥":"🚪";const nm=r.type==="stuhl"?"Stuhl":r.type==="liege"?"Liege":r.type==="opraum"?"OP-Raum":"Raum/Kabine";return`
        <div style="display:flex;justify-content:space-between;align-items:center;padding:9px 0;border-bottom:1px solid var(--border)">
          <div style="display:flex;align-items:center;gap:8px"><span style="font-size:18px">${ico}</span><span style="font-size:13px;font-weight:600">${nm}</span></div>
          <span style="font-size:15px;font-weight:800;color:var(--gold2)">${r.pr} €/Tag</span>
        </div>`;}).join("")}
      <p style="font-size:11px;color:#6ABF80;margin-top:8px;font-weight:600">✓ Direkt buchen — Sofort bestätigt</p>
    </div>`:""}
    <div class="card" style="padding:14px"><p class="lgold" style="margin-bottom:10px">${t("whyUs")}</p>
      ${[[t("noComm"),t("vs")],[t("direct"),t("noDetour")],[t("verified"),t("checked")]].map(([k,v])=>`
        <div style="display:flex;justify-content:space-between;padding:7px 0;border-bottom:1px solid var(--border);font-size:13px">
          <span style="font-weight:700;color:var(--gold2)">${k}</span><span style="color:var(--stone);font-size:12px">${v}</span>
        </div>`).join("")}
    </div>`;
  if(dt==="services") content=`<div style="display:flex;flex-direction:column;gap:8px">
    ${p.svs.map(s=>`<div style="display:flex;justify-content:space-between;align-items:center;padding:13px 15px;background:var(--c2);border-radius:13px;border:1px solid var(--border)">
      <div><p style="font-size:14px;font-weight:700">${s.nm}</p><p style="font-size:12px;color:var(--stone)">${s.dur} min</p></div>
      <div style="display:flex;gap:10px;align-items:center">
        <span style="font-size:15px;font-weight:800;color:var(--gold2)">${s.pr} €</span>
        <button class="bgold" style="width:auto;padding:8px 14px;font-size:12px" onclick="openBooking('${p.id}')">${t("buchen")}</button>
      </div>
    </div>`).join("")}</div>`;
  if(dt==="team") content=`<div style="display:flex;gap:10px;flex-wrap:wrap">
    ${specs.map(s=>`<div style="flex:1 1 calc(50% - 5px);padding:14px;background:var(--c2);border-radius:16px;text-align:center;border:1px solid var(--border)">
      <div style="width:48px;height:48px;border-radius:50%;background:${s.col};display:flex;align-items:center;justify-content:center;font-size:15px;font-weight:800;margin:0 auto 8px">${s.ini}</div>
      <p style="font-size:13px;font-weight:700">${s.nm}</p>
      <p style="font-size:11px;color:var(--stone);margin-bottom:5px">${s.role}</p>${stars(s.rt)}
    </div>`).join("")}</div>`;
  if(dt==="bewertungen") content=`
    <div style="display:flex;align-items:center;gap:12px;padding:14px;background:var(--c2);border-radius:14px;border:1px solid var(--border);margin-bottom:14px">
      <p class="cinzel" style="font-size:36px;font-weight:700;color:var(--gold2)">${p.rt}</p>
      <div>${stars(p.rt)}<p style="font-size:12px;color:var(--stone);margin-top:4px">${p.rc} ${t("reviews")}</p></div>
    </div>
    ${p.revs.map(r=>`<div style="padding:13px 15px;background:var(--c2);border-radius:13px;margin-bottom:8px;border:1px solid var(--border)">
      <div style="display:flex;justify-content:space-between;margin-bottom:4px">
        <p style="font-size:13px;font-weight:700">${r.u}</p><span style="font-size:11px;color:var(--stone)">${r.d}</span>
      </div>${stars(r.s)}<p style="font-size:13px;color:var(--stone);line-height:1.6;margin-top:5px">${r.t}</p>
    </div>`).join("")}
    <div style="margin-top:18px;padding:16px;background:var(--c2);border-radius:14px;border:1px solid var(--border)">
      <p class="lsm" style="margin-bottom:10px">${t("writeReview")}</p>
      <div style="display:flex;gap:4px;margin-bottom:12px">
        ${[1,2,3,4,5].map(i=>`<span onclick="setReviewRating(${i})" style="font-size:28px;cursor:pointer;opacity:${i<=state.reviewRating?1:.3};color:#E8C86A">★</span>`).join("")}
      </div>
      <textarea class="inp" style="height:80px;resize:none" placeholder="${t("reviewPlaceholder")}" oninput="state.reviewText=this.value">${state.reviewText}</textarea>
      <button class="bgold" style="margin-top:10px" ${state.reviewRating===0?"disabled":""} onclick="submitReview('${p.id}')">${t("submitReview")}</button>
    </div>`;
  if(dt==="galerie") content=p.gal&&p.gal.length>0?`<div style="display:flex;flex-direction:column;gap:12px">
    ${p.gal.map(g=>`<div class="card" style="padding:14px">
      <div style="display:flex;gap:8px;margin-bottom:8px"><span class="badge bgd">${g.sv}</span></div>
      <div style="display:flex;gap:8px">
        <div style="flex:1;text-align:center">
          <p style="font-size:10px;font-weight:700;color:var(--stone);margin-bottom:6px">${t("before")}</p>
          <div style="height:120px;border-radius:12px;background:linear-gradient(135deg,${g.b},${g.b}88);display:flex;align-items:center;justify-content:center;font-size:28px;opacity:.7">📷</div>
        </div>
        <div style="display:flex;align-items:center;font-size:16px;color:var(--gold)">→</div>
        <div style="flex:1;text-align:center">
          <p style="font-size:10px;font-weight:700;color:var(--stone);margin-bottom:6px">${t("after")}</p>
          <div style="height:120px;border-radius:12px;background:linear-gradient(135deg,${g.a},${g.a}88);display:flex;align-items:center;justify-content:center;font-size:28px">✨</div>
        </div>
      </div>
    </div>`).join("")}</div>`:`<div style="text-align:center;padding:40px"><p style="font-size:40px;margin-bottom:10px">📸</p><p style="color:var(--stone)">Noch keine Galeriebilder</p></div>`;
  return`<div class="sticky">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;gap:12px">
      <button onclick="goBack()" style="font-size:var(--font-md);color:var(--gold);font-weight:700;min-height:44px;min-width:44px;display:flex;align-items:center;gap:4px">← ${t("back")}</button>
      <button class="bgold" style="width:auto;padding:10px 20px;font-size:var(--font-md);flex-shrink:0" onclick="openBooking('${p.id}')">${t("buchen")}</button>
    </div>
    <p style="font-size:var(--font-lg);font-weight:800;margin-bottom:2px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${p.nm}</p>
    <p style="font-size:var(--font-sm);color:var(--stone);margin-bottom:10px">${p.st} · ${p.city}</p>
    <div style="display:flex;gap:7px;overflow-x:auto;-webkit-overflow-scrolling:touch">${tabs}</div>
  </div>
  <div style="padding:18px var(--pad)">${content}</div>`;
}

// ─── EXPLORE ───
function renderExplore(){return`<div style="padding:50px var(--pad) 0">
  <div style="margin-bottom:16px">${logoHeader(true)}</div>
  <p class="lsm" style="margin-bottom:12px">${t("bookNow")}</p>
  <div style="display:flex;flex-direction:column;gap:9px">
    ${PROVS.filter(p=>p.live).map(p=>`<div class="card" style="padding:13px 15px;cursor:pointer;display:flex;justify-content:space-between;align-items:center;gap:10px" onclick="openDetail('${p.id}')">
      <div style="flex:1;min-width:0"><p style="font-size:var(--font-md);font-weight:800;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${p.nm}</p><p style="font-size:var(--font-sm);color:var(--stone);overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${p.st} · ${p.city}</p></div>
      <button class="bgold" style="width:auto;padding:9px 16px;font-size:var(--font-sm);flex-shrink:0;min-height:40px" onclick="event.stopPropagation();openBooking('${p.id}')">${t("buchen")}</button>
    </div>`).join("")}
  </div></div>`;}

// ─── FAVORITES ───
function renderFavorites(){
  const favProvs=PROVS.filter(p=>state.favorites.includes(p.id));
  return`<div style="padding:50px var(--pad) 0">
    <div style="margin-bottom:16px">${logoHeader(true)}</div>
    <p class="lsm" style="margin-bottom:12px">${t("favs")} (${favProvs.length})</p>
    ${favProvs.length===0?`<div style="text-align:center;padding:50px var(--pad)"><p style="font-size:48px;margin-bottom:14px">♡</p><p style="font-size:var(--font-lg);font-weight:700;margin-bottom:6px">${t("noFavs")}</p><p style="font-size:var(--font-md);color:var(--stone)">${t("noFavsSub")}</p></div>`:`
    <div style="display:flex;flex-direction:column;gap:10px">
      ${favProvs.map(p=>`<div class="card" style="padding:13px 15px;cursor:pointer;display:flex;justify-content:space-between;align-items:center;gap:10px" onclick="openDetail('${p.id}')">
        <div style="flex:1;min-width:0"><p style="font-size:var(--font-md);font-weight:800;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${p.nm}</p><p style="font-size:var(--font-sm);color:var(--stone)">${p.city} · ${stars(p.rt)}</p></div>
        <div style="display:flex;gap:8px;align-items:center;flex-shrink:0">
          <span class="heart liked" onclick="toggleFav('${p.id}',event)" style="font-size:18px">♥</span>
          <button class="bgold" style="width:auto;padding:9px 14px;font-size:var(--font-sm);min-height:40px" onclick="event.stopPropagation();openBooking('${p.id}')">${t("buchen")}</button>
        </div>
      </div>`).join("")}
    </div>`}
  </div>`;}

// ─── OFFERS ───
function renderOffers(){
  const discProvs=[...PROVS.filter(p=>p.disc>0)].sort((a,b)=>tierWeight(b.tier)-tierWeight(a.tier)||(b.boost||0)-(a.boost||0));
  return`<div style="padding:50px var(--pad) 0">
  <div style="margin-bottom:16px">${logoHeader(true)}</div>
  <p class="lsm" style="margin-bottom:12px">${t("offers")}</p>
  ${discProvs.map(p=>`<div class="card" style="padding:15px;margin-bottom:10px;background:linear-gradient(135deg,#1E1A08,#141008);${p.tier==="gold"?"border:1.5px solid rgba(200,168,75,.25)":""}">
    <div style="display:flex;gap:5px;flex-wrap:wrap;margin-bottom:8px">
      <span class="badge brd">−${p.disc}% ${t("discount")}</span>
      ${p.tier==="gold"?`<span class="badge bgd">👑 GOLD</span>`:p.tier==="premium"?`<span class="badge bgd">⚡ ${t("premBadge")}</span>`:""}
    </div>
    <p style="font-size:var(--font-md);font-weight:800;margin-bottom:2px">${p.nm}</p>
    <p style="font-size:var(--font-sm);color:var(--stone);margin-bottom:10px">${p.tl}</p>
    <button class="bgold" style="width:auto;padding:10px 20px;font-size:var(--font-md)" onclick="openBooking('${p.id}')">${t("bookNow")}</button>
  </div>`).join("")}

  <!-- REFERRAL PROGRAM -->
  <div class="card" style="padding:18px;margin-bottom:12px;background:linear-gradient(135deg,#1A1608,#0E0C04);border:1px solid rgba(200,168,75,.2)">
    <p class="lgold" style="margin-bottom:10px">🎁 ${t("refTitle")}</p>
    <div style="display:flex;gap:14px;margin-bottom:14px">
      <div style="flex:1;text-align:center;padding:12px 6px;background:var(--c2);border-radius:12px">
        <p style="font-size:22px;font-weight:800;color:var(--gold2)">${state.refCount}</p>
        <p style="font-size:10px;color:var(--stone);margin-top:2px">${t("refInvited")}</p>
      </div>
      <div style="flex:1;text-align:center;padding:12px 6px;background:var(--c2);border-radius:12px">
        <p style="font-size:22px;font-weight:800;color:var(--gold2)">${state.refEarnings.toFixed(2)} €</p>
        <p style="font-size:10px;color:var(--stone);margin-top:2px">${t("refEarned")}</p>
      </div>
    </div>
    <p class="lsm" style="margin-bottom:8px">${t("refSteps")}</p>
    <div style="display:flex;flex-direction:column;gap:8px;margin-bottom:14px">
      ${[t("refStep1"),t("refStep2"),t("refStep3")].map((s,i)=>`<div style="display:flex;gap:10px;align-items:center">
        <div style="width:24px;height:24px;border-radius:50%;background:var(--gold);color:#080706;font-size:11px;font-weight:800;display:flex;align-items:center;justify-content:center;flex-shrink:0">${i+1}</div>
        <span style="font-size:var(--font-sm);color:var(--cream)">${s}</span>
      </div>`).join("")}
    </div>
    <div style="background:var(--c2);border-radius:10px;padding:12px;display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
      <div>
        <p style="font-size:10px;color:var(--stone);margin-bottom:2px">${t("refCode")}</p>
        <p style="font-size:16px;font-weight:800;letter-spacing:2px;color:var(--gold2)">${state.refCode}</p>
      </div>
      <button class="bgold" style="width:auto;padding:8px 14px;font-size:12px" onclick="copyRefCode()">📋</button>
    </div>
    <div style="display:flex;gap:8px">
      <button class="bgold" style="flex:1;font-size:var(--font-sm)" onclick="shareReferral()">📤 ${t("shareLink")}</button>
      <button class="boutline" style="flex:1;font-size:var(--font-sm)" onclick="shareWhatsApp()">💬 WhatsApp</button>
    </div>
  </div>

  <!-- NEWSLETTER in Offers -->
  ${!state.nlSubscribed?`<div class="card" style="padding:16px;margin-bottom:12px;background:linear-gradient(135deg,#1A1608,#0E0C04);border:1px solid rgba(200,168,75,.15)">
    <p class="lgold" style="margin-bottom:6px">📩 NEWSLETTER</p>
    <p style="font-size:var(--font-sm);color:var(--stone);margin-bottom:10px">${t("nlSub")}</p>
    <div style="display:flex;gap:8px">
      <input class="inp" style="flex:1;padding:10px 12px;font-size:14px" placeholder="${t("nlPlaceholder")}" value="${state.nlEmail}" oninput="state.nlEmail=this.value"/>
      <button class="bgold" style="width:auto;padding:10px 14px;font-size:var(--font-sm);white-space:nowrap" onclick="subscribeNL()">→</button>
    </div>
  </div>`:`<div class="card" style="padding:14px;margin-bottom:12px;text-align:center">
    <p style="font-size:var(--font-sm);color:#6ABF80">✓ ${t("nlAlready")}</p>
  </div>`}
</div>`;}

// ─── PROVIDER SERVICE SECTION (visible in Account for role=PROVIDER) ───
function renderProviderSection(){
  const p=PROVS[0];
  const cat=p.cat;
  const catalog=SVC_CATALOG[cat]||[];
  if(!state.provServices)state.provServices=JSON.parse(localStorage.getItem("cm_prov_svcs")||"null")||p.svs.map(s=>s.nm);
  const activeCount=state.provServices.length;
  return`
    <!-- MEINE SERVICES -->
    <div class="card" style="padding:16px;margin-bottom:14px;background:linear-gradient(135deg,#141008,#1A1608);border:1.5px solid rgba(200,168,75,.25)">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
        <div><p class="lgold" style="margin-bottom:3px">Meine Services</p>
          <p style="font-size:11px;color:var(--stone)">${activeCount} von ${catalog.length} aktiv · So sehen Kunden dein Angebot</p></div>
        <button onclick="state.adminTab='services';goSub('admin')" style="padding:6px 12px;border-radius:8px;background:var(--c3);border:1px solid var(--gold);color:var(--gold2);font-size:11px;font-weight:700;cursor:pointer">Bearbeiten</button>
      </div>
      ${state.provServices.length===0?`<p style="font-size:12px;color:var(--stone2);padding:14px 0;text-align:center">Noch keine Services aktiviert. Tippe "Bearbeiten" um deine Dienste freizuschalten.</p>`:""}
      ${catalog.filter(sv=>state.provServices.includes(sv.nm)).slice(0,4).map(sv=>`
      <div style="display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:1px solid var(--border)">
        <div><p style="font-size:13px;font-weight:700">${sv.nm}</p><p style="font-size:11px;color:var(--stone)">${sv.dur} min</p></div>
        <span style="font-size:14px;font-weight:800;color:var(--gold2)">${sv.pr} €</span>
      </div>`).join("")}
      ${activeCount>4?`<p style="font-size:11px;color:var(--stone);margin-top:8px;text-align:center">+ ${activeCount-4} weitere Services</p>`:""}
    </div>`;
}
// ─── B2B RENTAL SECTION (visible in Account for role=B2B) ───
function renderB2BSection(){
  const p=PROVS[0];
  if(!state.b2bRentals)state.b2bRentals=JSON.parse(localStorage.getItem("cm_b2b")||"null")||(p.rental||[]).map(r=>({type:r.type,pr:r.pr,active:true,size:"",photo:null,desc:""}));
  const allTypes=[
    {type:"stuhl",svg:rentalIcon("stuhl"),nm:"Barber-Stuhl",desc:"Friseur-/Barber-Arbeitsplatz mit Stuhl"},
    {type:"liege",svg:rentalIcon("liege"),nm:"Liege",desc:"Massage-/Kosmetik-Liege"},
    {type:"raum",svg:rentalIcon("raum"),nm:"Kosmetik-Kabine",desc:"Behandlungsraum / geschlossene Kabine"},
    {type:"opraum",svg:rentalIcon("opraum"),nm:"OP-Raum",desc:"Steriler Operationssaal"}
  ];
  return`
    <!-- B2B VERMIETUNG -->
    <div class="card" style="padding:16px;margin-bottom:14px;background:linear-gradient(135deg,#141008,#1A1608);border:1.5px solid rgba(200,168,75,.25)">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:4px">
        <p class="lgold">B2B — Mein Angebot</p>
        <span style="font-size:10px;color:var(--stone);background:var(--c3);padding:4px 8px;border-radius:6px">Business to Business</span>
      </div>
      <p style="font-size:11px;color:var(--stone);margin-bottom:14px;line-height:1.5">Schalte frei, was du an andere Profis vermieten möchtest. Mieter sehen Fotos, Größe und Preis direkt in der App.</p>
      ${allTypes.map(at=>{
        const item=state.b2bRentals.find(r=>r.type===at.type);
        const isActive=item&&item.active;
        return`
      <div style="margin-bottom:12px;border:1.5px solid ${isActive?"rgba(200,168,75,.25)":"var(--border)"};border-radius:14px;overflow:hidden;background:${isActive?"rgba(200,168,75,.03)":"var(--c2)"}">
        <div style="display:flex;align-items:center;gap:12px;padding:14px">
          <div style="width:40px;display:flex;align-items:center;justify-content:center">${at.svg}</div>
          <div style="flex:1"><p style="font-size:14px;font-weight:700">${at.nm}</p><p style="font-size:11px;color:var(--stone)">${at.desc}</p></div>
          <div onclick="toggleB2B('${at.type}')" style="width:44px;height:26px;border-radius:13px;background:${isActive?"var(--gold)":"var(--c4)"};cursor:pointer;position:relative;transition:background .2s">
            <div style="width:20px;height:20px;border-radius:50%;background:#fff;position:absolute;top:3px;${isActive?"right:3px":"left:3px"};transition:all .2s"></div>
          </div>
        </div>
        ${isActive?`
        <div style="padding:0 14px 14px;display:flex;flex-direction:column;gap:10px;border-top:1px solid var(--border);padding-top:12px">
          <div style="display:flex;gap:10px">
            <div style="flex:1"><label style="font-size:11px;color:var(--stone);display:block;margin-bottom:4px">Preis / Tag (€)</label>
              <input class="inp" type="number" value="${item.pr||""}" oninput="updateB2B('${at.type}','pr',this.value)" placeholder="z.B. 45" style="font-size:15px;font-weight:700"/></div>
            <div style="flex:1"><label style="font-size:11px;color:var(--stone);display:block;margin-bottom:4px">Größe (m²)</label>
              <input class="inp" value="${item.size||""}" oninput="updateB2B('${at.type}','size',this.value)" placeholder="z.B. 12 m²"/></div>
          </div>
          <div><label style="font-size:11px;color:var(--stone);display:block;margin-bottom:4px">Beschreibung (optional)</label>
            <input class="inp" value="${item.desc||""}" oninput="updateB2B('${at.type}','desc',this.value)" placeholder="z.B. Klimatisiert, eigener Eingang..."/></div>
          <div>
            <label style="font-size:11px;color:var(--stone);display:block;margin-bottom:4px">Foto hochladen</label>
            ${item.photo?`
            <div style="position:relative;border-radius:10px;overflow:hidden;margin-bottom:6px">
              <img src="${item.photo}" style="width:100%;height:120px;object-fit:cover;border-radius:10px;border:1px solid var(--border)"/>
              <button onclick="removeB2BPhoto('${at.type}')" style="position:absolute;top:6px;right:6px;width:26px;height:26px;border-radius:50%;background:rgba(0,0,0,.7);border:1px solid var(--border);color:#fff;font-size:14px;cursor:pointer;display:flex;align-items:center;justify-content:center">✕</button>
            </div>`:`
            <div onclick="document.getElementById('b2bPhoto_${at.type}').click()" style="border:2px dashed var(--c5);border-radius:12px;padding:20px;text-align:center;cursor:pointer">
              <p style="font-size:11px;color:var(--stone)">📸 Tippe zum Hochladen</p>
              <p style="font-size:10px;color:var(--stone2)">So sehen Mieter deinen ${at.nm}</p>
            </div>`}
            <input type="file" id="b2bPhoto_${at.type}" accept="image/*" style="display:none" onchange="handleB2BPhoto('${at.type}',event)"/>
          </div>
          <div style="padding:10px 12px;background:rgba(74,138,90,.06);border-radius:10px;border:1px solid rgba(74,138,90,.12)">
            <p style="font-size:11px;color:#6ABF80;font-weight:700">✓ Sichtbar für Mieter</p>
            <p style="font-size:10px;color:var(--stone);margin-top:2px">Freelancer sehen Preis, Foto & Größe direkt — ohne extra hinfahren.</p>
          </div>
        </div>`:""}
      </div>`;}).join("")}
    </div>`;
}
function toggleB2B(type){
  if(!state.b2bRentals)state.b2bRentals=[];
  const item=state.b2bRentals.find(r=>r.type===type);
  if(item){item.active=!item.active;showToast(item.active?"Freigeschaltet":"Deaktiviert");}
  else{state.b2bRentals.push({type,pr:0,active:true,size:"",photo:null,desc:""});showToast("Freigeschaltet");}
  localStorage.setItem("cm_b2b",JSON.stringify(state.b2bRentals));render();
}
function updateB2B(type,field,val){
  if(!state.b2bRentals)return;
  const item=state.b2bRentals.find(r=>r.type===type);
  if(item){item[field]=field==="pr"?(parseFloat(val)||0):val;localStorage.setItem("cm_b2b",JSON.stringify(state.b2bRentals));}
}
function handleB2BPhoto(type,e){
  const file=e.target.files[0];if(!file)return;
  if(file.size>3*1024*1024){showToast("Max 3 MB!");return;}
  const reader=new FileReader();
  reader.onload=function(ev){
    const item=state.b2bRentals.find(r=>r.type===type);
    if(item){item.photo=ev.target.result;localStorage.setItem("cm_b2b",JSON.stringify(state.b2bRentals));render();showToast("Foto hochgeladen!");}
  };reader.readAsDataURL(file);
}
function removeB2BPhoto(type){
  const item=state.b2bRentals.find(r=>r.type===type);
  if(item){item.photo=null;localStorage.setItem("cm_b2b",JSON.stringify(state.b2bRentals));render();}
}
// ─── ACCOUNT (with loyalty card, theme, lang, dbSeat) ───
function renderAccount(){
  const r=state.role;
  const bkgs=state.bookings.length>0?state.bookings:[{id:"demo1",nm:"Ahmed K.",sv:"Skin Fade",t:"Mi 26.02 · 10:00",st:"confirmed",pr:48,provNm:"BlackLabel Barbershop"},{id:"demo2",nm:"Sofia M.",sv:"Deep Cleanse",t:"Fr 28.02 · 14:00",st:"pending",pr:85,provNm:"Glow Studio"}];
  const sc={confirmed:"#4A8A5A",pending:"var(--gold)",cancelled:"#C04040"};
  const stLabel={confirmed:t("confirmed"),pending:t("pending"),cancelled:t("cancelled")};
  const stampArr=Array.from({length:10},(_,i)=>i<state.stamps);
  return`<div style="padding:var(--pad) var(--pad) 0">
    <div style="margin-bottom:18px">${logoHeader(true)}</div>
    <div style="display:flex;gap:7px;margin-bottom:18px">
      ${[["CUSTOMER",t("customer").split("—")[0].trim()],["PROVIDER",t("provider").split("—")[0].trim()],["B2B","B2B"]].map(([rv,lv])=>`
        <button onclick="setRole('${rv}')" style="flex:1;padding:10px 0;border-radius:12px;font-size:12px;font-weight:700;cursor:pointer;font-family:inherit;background:${r===rv?"var(--gold)":"var(--c2)"};color:${r===rv?"#080706":"var(--stone)"};border:1px solid ${r===rv?"var(--gold)":"var(--border)"}">
          ${lv}
        </button>`).join("")}
    </div>
    <!-- LOYALTY CARD -->
    <div class="card" style="padding:16px;margin-bottom:14px;background:linear-gradient(135deg,#1A1608,#100E04);border:1px solid rgba(200,168,75,.2)">
      <p class="lgold" style="margin-bottom:10px">🏆 ${t("loyalty")}</p>
      <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:10px">
        ${stampArr.map((filled,i)=>`<div style="width:30px;height:30px;border-radius:50%;background:${filled?"linear-gradient(135deg,#D4AE54,#C8A84B)":"var(--c4)"};border:2px solid ${filled?"var(--gold2)":"var(--c5)"};display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:800;color:${filled?"#080706":"var(--stone2)"};${filled?"box-shadow:0 0 10px rgba(200,168,75,.5);animation:starGlow 2s ease-in-out infinite;animation-delay:"+(i*0.15)+"s":""}"><span style="${filled?"text-shadow:0 1px 2px rgba(0,0,0,.3)":""}">${filled?"★":i+1}</span></div>`).join("")}
      </div>
      <div class="pbar" style="margin-bottom:6px"><div class="pfill" style="width:${state.stamps/10*100}%"></div></div>
      <p style="font-size:12px;color:var(--stone)">${state.stamps}/10 ${t("stampsOf")} ${state.stamps>=10?"— "+t("freeService"):""}</p>
      <p style="font-size:11px;color:var(--stone2);margin-top:4px">${t("loyaltySub")}</p>
      ${state.stamps>=10&&!state.loyaltyRedeemed?`<button class="bgold" style="margin-top:10px;width:auto;padding:10px 20px;font-size:13px" onclick="redeemLoyalty()">🎁 ${t("redeemNow")} — ${t("freeService")}</button>`:''}
      ${state.loyaltyRedeemed?`<p style="font-size:12px;color:#6ABF80;margin-top:8px">✓ ${t("redeemed")}</p>`:''}
    </div>
    <!-- REFERRAL -->
    <div class="card" style="padding:15px;margin-bottom:14px;background:linear-gradient(135deg,#1E1A08,#141008);border:1px solid rgba(200,168,75,.15)">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
        <div><p class="lgold" style="margin-bottom:3px">${t("refBalance")}</p>
          <p class="cinzel" style="font-size:24px;font-weight:700;color:var(--gold2)">${(15+state.refEarnings).toFixed(2)} €</p></div>
        <button class="bgold" style="width:auto;padding:10px 14px;font-size:12px" onclick="shareReferral()">✨ ${t("recommend")}</button>
      </div>
      <div style="display:flex;gap:8px">
        <div style="flex:1;text-align:center;padding:8px;background:var(--c2);border-radius:8px">
          <p style="font-size:16px;font-weight:800;color:var(--gold2)">${state.refCount}</p>
          <p style="font-size:9px;color:var(--stone)">${t("refInvited")}</p>
        </div>
        <div style="flex:1;text-align:center;padding:8px;background:var(--c2);border-radius:8px">
          <p style="font-size:14px;font-weight:800;letter-spacing:1px;color:var(--gold2)">${state.refCode}</p>
          <p style="font-size:9px;color:var(--stone)">${t("refCode")}</p>
        </div>
      </div>
    </div>
    ${r==="CUSTOMER"?`<div class="card" onclick="goSub('register')" style="padding:0;margin-bottom:14px;background:linear-gradient(135deg,#1A1608,#100E04);cursor:pointer;border:1px solid rgba(200,168,75,.2);overflow:hidden">
      <div style="display:flex;align-items:center;gap:0">
        <div style="flex-shrink:0;width:130px;height:130px;display:flex;align-items:flex-end;justify-content:center;gap:1px;background:linear-gradient(135deg,#0A0600,#180C04);border-right:1px solid rgba(200,168,75,.12);position:relative;overflow:hidden;padding-bottom:4px">
          <div style="position:absolute;inset:0;background:radial-gradient(ellipse at 50% 80%,rgba(200,100,0,.08),transparent 70%)"></div>
          <div style="transform:scale(.7);transform-origin:bottom center">${dbSeat()}</div>
        </div>
        <div style="flex:1;padding:16px 14px">
          <p class="lgold" style="margin-bottom:6px">VERMIETEN & VERDIENEN</p>
          <p class="cinzel" style="font-size:14px;font-weight:700;margin-bottom:6px;color:var(--gold2);line-height:1.3">${t("premChair")}</p>
          <p style="font-size:11px;color:var(--stone);margin-bottom:12px;line-height:1.6">${t("zeroComm")}</p>
          <span class="badge bgd" style="font-size:10px">${t("becomeProvider")}</span>
        </div>
      </div>
    </div>`:""}
    ${r==="PROVIDER"?renderProviderSection():""}
    ${r==="B2B"?renderB2BSection():""}
    ${r!=="CUSTOMER"?`<!-- ADMIN PANEL ENTRY -->
    <div class="card" onclick="goSub('admin')" style="padding:16px;margin-bottom:14px;background:linear-gradient(135deg,#141008,#1A1608);border:1.5px solid rgba(200,168,75,.25);cursor:pointer">
      <div style="display:flex;align-items:center;gap:14px">
        <div style="width:48px;height:48px;border-radius:14px;background:linear-gradient(135deg,var(--gold),#D4AE54);display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0">⚙</div>
        <div style="flex:1">
          <p style="font-size:var(--font-md);font-weight:800;color:var(--gold2)">${t("adminPanel")}</p>
          <p style="font-size:var(--font-sm);color:var(--stone)">Logo · Services · ${t("adminStats")}</p>
        </div>
        <span style="color:var(--gold);font-size:18px">›</span>
      </div>
    </div>`:""}
    <!-- BOOKINGS -->
    <p class="lsm" style="margin-bottom:10px">${t("bookings")}</p>
    ${bkgs.length===0?`<div style="text-align:center;padding:30px 20px"><p style="font-size:36px;margin-bottom:10px">📅</p><p style="font-size:14px;font-weight:700;margin-bottom:4px">${t("noBookings")}</p><p style="font-size:13px;color:var(--stone)">${t("noBookingsSub")}</p></div>`:bkgs.map(b=>`<div class="card" style="padding:13px 15px;margin-bottom:8px">
      <div style="display:flex;justify-content:space-between;margin-bottom:3px">
        <p style="font-size:14px;font-weight:700">${b.provNm||b.nm}</p>
        <span style="font-size:12px;font-weight:700;color:${sc[b.st]||"var(--stone)"}">${stLabel[b.st]||b.st}</span>
      </div>
      <p style="font-size:13px;color:var(--stone);margin-bottom:2px">${b.sv}</p>
      <div style="display:flex;justify-content:space-between;align-items:center">
        <span style="font-size:12px;color:var(--stone)">${b.t}</span>
        <div style="display:flex;gap:8px;align-items:center">
          <span style="font-size:13px;font-weight:800;color:var(--gold2)">${b.pr} €</span>
          ${b.st!=='cancelled'?`<button class="boutline" style="padding:6px 10px;font-size:11px" onclick="cancelBooking('${b.id}')">${t('cancelBooking')}</button>`:''}
        </div>
      </div>
    </div>`).join("")}
    <!-- SETTINGS -->
    <div style="margin-top:16px;padding-top:16px;border-top:1px solid var(--border)">
      <p class="lsm" style="margin-bottom:12px">${t("theme")}</p>
      <div style="display:flex;justify-content:space-between;align-items:center;padding:10px 0;margin-bottom:8px">
        <span style="font-size:13px">${state.theme==="dark"?t("darkMode"):t("lightMode")}</span>
        <div class="switch ${state.theme==="light"?"on":""}" onclick="toggleTheme()"></div>
      </div>
      <p class="lsm" style="margin-bottom:8px">${t("lang")}</p>
      <div style="display:flex;gap:6px;margin-bottom:16px">
        ${[["de","🇩🇪 Deutsch"],["en","🇬🇧 English"],["tr","🇹🇷 Türkçe"]].map(([code,label])=>`
          <button onclick="setLang('${code}')" style="flex:1;padding:10px;border-radius:10px;font-size:11px;font-weight:700;background:${state.lang===code?"var(--gold)":"var(--c2)"};color:${state.lang===code?"#080706":"var(--stone)"};border:1px solid ${state.lang===code?"var(--gold)":"var(--border)"}">${label}</button>`).join("")}
      </div>
    </div>
    <!-- FEATURES -->
    <div style="margin-top:4px;padding-top:14px;border-top:1px solid var(--border)">
      <p class="lsm" style="margin-bottom:10px">Features</p>
      ${[
        {icon:rentalIcon("stuhl"),nm:"Chat & Nachrichten",desc:"Direkt mit Anbietern chatten",pg:"chat"},
        {icon:'<svg width="26" height="26" viewBox="0 0 32 32" fill="none"><circle cx="16" cy="14" r="10" fill="none" stroke="#C8A84B" stroke-width="1.5"/><circle cx="16" cy="14" r="3" fill="#C8A84B" opacity=".5"/><path d="M16 24L20 30H12Z" fill="#C8A84B" opacity=".6"/></svg>',nm:"Karte & Navigation",desc:"Anbieter in deiner Nähe finden",pg:"map"},
        {icon:'<svg width="26" height="26" viewBox="0 0 32 32" fill="none"><rect x="4" y="4" width="24" height="24" rx="4" fill="none" stroke="#C8A84B" stroke-width="1.5"/><line x1="4" y1="12" x2="28" y2="12" stroke="#C8A84B" stroke-width="1"/><line x1="12" y1="4" x2="12" y2="12" stroke="#C8A84B" stroke-width="1"/><line x1="20" y1="4" x2="20" y2="12" stroke="#C8A84B" stroke-width="1"/><circle cx="10" cy="18" r="1.5" fill="#C8A84B" opacity=".5"/><circle cx="16" cy="18" r="1.5" fill="#C8A84B"/><circle cx="22" cy="18" r="1.5" fill="#C8A84B" opacity=".5"/><circle cx="10" cy="24" r="1.5" fill="#C8A84B" opacity=".3"/><circle cx="16" cy="24" r="1.5" fill="#C8A84B" opacity=".5"/></svg>',nm:"Kalender",desc:"Termine synchronisieren",pg:"calendar"},
        {icon:'<svg width="26" height="26" viewBox="0 0 32 32" fill="none"><rect x="6" y="2" width="20" height="28" rx="3" fill="none" stroke="#C8A84B" stroke-width="1.5"/><line x1="10" y1="10" x2="22" y2="10" stroke="#C8A84B" stroke-width="1" opacity=".4"/><line x1="10" y1="14" x2="22" y2="14" stroke="#C8A84B" stroke-width="1" opacity=".4"/><line x1="10" y1="18" x2="18" y2="18" stroke="#C8A84B" stroke-width="1" opacity=".4"/><path d="M18 22L21 25L27 18" fill="none" stroke="#C8A84B" stroke-width="2" stroke-linecap="round"/></svg>',nm:"Dokumente & Verifizierung",desc:"Gewerbeschein & Zertifikate",pg:"documents"}
      ].map(f=>`
        <div onclick="goSub('${f.pg}')" style="display:flex;align-items:center;gap:12px;padding:12px 0;border-bottom:1px solid var(--border);cursor:pointer">
          <div style="width:40px;height:40px;border-radius:12px;background:var(--c2);border:1px solid var(--border);display:flex;align-items:center;justify-content:center">${f.icon}</div>
          <div style="flex:1"><p style="font-size:13px;font-weight:700">${f.nm}</p><p style="font-size:11px;color:var(--stone)">${f.desc}</p></div>
          <span style="color:var(--gold);font-size:14px">›</span>
        </div>`).join("")}
    </div>
    <!-- LEGAL -->
    ${r!=="CUSTOMER"?`<!-- PRICING -->
    <div class="card" onclick="goSub('pricing')" style="padding:14px;margin-bottom:14px;cursor:pointer;background:linear-gradient(135deg,#1A1608,#0E0C04);border:1px solid rgba(200,168,75,.2)">
      <div style="display:flex;align-items:center;gap:12px">
        <span style="font-size:24px">💎</span>
        <div style="flex:1"><p style="font-size:var(--font-md);font-weight:700;color:var(--gold2)">${t("pricingTitle")}</p><p style="font-size:11px;color:var(--stone)">Free · Premium · Gold</p></div>
        <span style="color:var(--gold)">›</span>
      </div>
    </div>`:""}
    <div style="padding-top:12px;border-top:1px solid var(--border)">
      <p class="lsm" style="margin-bottom:10px">${t("legal")}</p>
      ${[["📋 "+t("privacy"),"dsgvo"],["📄 "+t("imprint"),"impressum"],["💺 "+t("register"),"register"]].map(([lv,pg])=>`
        <div onclick="goSub('${pg}')" style="display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid var(--border);cursor:pointer">
          <span style="font-size:13px">${lv}</span><span style="color:var(--stone)">›</span>
        </div>`).join("")}
      <!-- SUPER ADMIN (hidden entry - triple tap version) -->
      <div onclick="toggleSuperAdmin()" style="cursor:pointer">
        <p style="font-size:11px;color:var(--stone2);margin-top:14px;text-align:center;line-height:1.7">ChairMatch · Yusuf Ferhat Demir · Deutschland · v7.1 · © 2026</p>
      </div>
      ${state.superAdmin?`<div onclick="goSub('superadmin')" style="display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-top:1px solid var(--border);cursor:pointer;margin-top:8px">
        <span style="font-size:13px;color:var(--gold2)">🛡 ${t("saPanel")}</span><span style="color:var(--gold)">›</span>
      </div>`:""}
    <div style="height:20px"></div>
  </div>`;
}

// ─── SUB PAGES ───
function renderSubPage(){
  if(state.subPage==="dsgvo")return renderDsgvo();
  if(state.subPage==="impressum")return renderImpressum();
  if(state.subPage==="register")return renderRegister();
  if(state.subPage==="notifications")return renderNotifications();
  if(state.subPage==="admin")return renderAdmin();
  if(state.subPage==="superadmin")return renderSuperAdmin();
  if(state.subPage==="pricing")return renderPricing();
  if(state.subPage==="social")return renderSocial();
  if(state.subPage==="chat")return renderChat();
  if(state.subPage==="map")return renderMap();
  if(state.subPage==="calendar")return renderCalendar();
  if(state.subPage==="documents")return renderDocuments();
  return"";}

function renderNotifications(){
  return`<div class="sticky"><button onclick="goSub(null)" style="font-size:var(--font-md);color:var(--gold);font-weight:700;min-height:44px;display:flex;align-items:center;gap:4px">← ${t("back")}</button>
    <h1 style="font-size:var(--font-lg);font-weight:700;font-family:'Cinzel',serif;color:var(--gold2);margin-top:6px">${t("notifications")}</h1></div>
  <div style="padding:14px var(--pad)">
    ${state.notifications.length===0?`<div style="text-align:center;padding:50px 20px"><p style="font-size:48px;margin-bottom:14px">🔔</p><p style="font-size:16px;font-weight:700;margin-bottom:6px">${t("noNotifications")}</p><p style="font-size:13px;color:var(--stone)">${t("noNotificationsSub")}</p></div>`:''}
    ${state.notifications.map(n=>`<div onclick="markRead('${n.id}')" style="display:flex;gap:12px;padding:14px;margin-bottom:8px;background:${n.read?"var(--c2)":"rgba(200,168,75,.06)"};border-radius:14px;border:1px solid ${n.read?"var(--border)":"rgba(200,168,75,.15)"};cursor:pointer">
      <div style="font-size:22px;flex-shrink:0">${n.icon}</div>
      <div style="flex:1"><p style="font-size:13px;font-weight:${n.read?500:700}">${n.title}</p><p style="font-size:12px;color:var(--stone);margin-top:2px">${n.body}</p><p style="font-size:10px;color:var(--stone2);margin-top:4px">${n.time}</p></div>
      ${!n.read?`<div style="width:8px;height:8px;border-radius:50%;background:var(--gold);flex-shrink:0;margin-top:4px"></div>`:""}
    </div>`).join("")}
  </div>`;
}

function renderDsgvo(){
  const items=[["1. Verantwortlicher","ChairMatch GmbH (i. Gr.), Deutschland. datenschutz@chairmatch.de"],["2. Erhobene Daten","Name, E-Mail, Telefon, Buchungsdaten. Anbieter: Gewerbedaten, IBAN."],["3. Rechtsgrundlage","Vertragserfüllung Art. 6 I b DSGVO."],["4. Weitergabe","Keine Weitergabe zu Werbezwecken. Nur Auftragsverarbeiter (Art. 28 DSGVO)."],["5. Speicherdauer","Buchungsdaten: 10 Jahre. Logs: 90 Tage."],["6. Ihre Rechte","Auskunft · Berichtigung · Löschung · Widerspruch (Art. 15–21 DSGVO)"],["7. Beschwerderecht","HBDI Hessen, Postfach 3163, 65021 Wiesbaden"]];
  return`<div class="sticky"><button onclick="goSub(null)" style="font-size:var(--font-md);color:var(--gold);font-weight:700;min-height:44px;display:flex;align-items:center;gap:4px">← ${t("back")}</button>
    <h1 style="font-size:var(--font-xl);font-weight:700;font-family:'Cinzel',serif;color:var(--gold2)">${t("privacy")}</h1>
    <p style="font-size:var(--font-sm);color:var(--stone)">DSGVO · Stand 02/2026</p></div>
  <div style="padding:18px var(--pad) 40px">
    <div style="background:rgba(74,138,90,.08);border:1px solid rgba(74,138,90,.2);border-radius:12px;padding:12px 14px;margin-bottom:18px">
      <p style="font-size:13px;font-weight:700;color:#6ABF80">✓ DSGVO-konform · App Store & Play Store geprüft</p>
    </div>
    ${items.map(([ti,tx])=>`<div style="margin-bottom:16px"><p style="font-size:13px;font-weight:800;color:var(--gold2);margin-bottom:5px">${ti}</p><p style="font-size:13px;color:var(--stone);line-height:1.7">${tx}</p><div style="height:1px;background:linear-gradient(90deg,transparent,rgba(200,168,75,.15),transparent);margin-top:14px"></div></div>`).join("")}
  </div>`;}

function renderImpressum(){
  const items=[["Angaben gemäß § 5 TMG","Yusuf Ferhat Demir\nChairMatch\nDeutschland"],["Kontakt","E-Mail: info@chairmatch.de"],["Verantwortlich für den Inhalt","Yusuf Ferhat Demir"],["Haftungsausschluss","Trotz sorgfältiger inhaltlicher Kontrolle übernehmen wir keine Haftung für die Inhalte externer Links. Für den Inhalt der verlinkten Seiten sind ausschließlich deren Betreiber verantwortlich."],["Plattform","ChairMatch ist eine Vermittlungsplattform für Beauty- und Wellness-Dienstleistungen."],["Streitbeilegung","Die Europäische Kommission stellt eine Plattform zur Online-Streitbeilegung (OS) bereit:\nhttps://ec.europa.eu/consumers/odr"]];
  return`<div class="sticky"><button onclick="goSub(null)" style="font-size:var(--font-md);color:var(--gold);font-weight:700;min-height:44px;display:flex;align-items:center;gap:4px">← ${t("back")}</button>
    <h1 style="font-size:var(--font-xl);font-weight:700;font-family:'Cinzel',serif;color:var(--gold2)">${t("imprint")}</h1>
    <p style="font-size:var(--font-sm);color:var(--stone)">§ 5 TMG</p></div>
  <div style="padding:18px var(--pad) 40px">
    ${items.map(([ti,tx])=>`<div style="margin-bottom:16px"><p style="font-size:11px;font-weight:800;color:var(--gold2);letter-spacing:.05em;text-transform:uppercase;margin-bottom:5px">${ti}</p><p style="font-size:13px;color:var(--stone);line-height:1.7;white-space:pre-line">${tx}</p><div style="height:1px;background:linear-gradient(90deg,transparent,rgba(200,168,75,.15),transparent);margin-top:14px"></div></div>`).join("")}
  </div>`;}

// ─── SUPER ADMIN PANEL ───
function renderSuperAdmin(){
  const tb=state.saTab;
  const tabs=[["providers",t("saProviders")],["features",t("saFeatures")],["analytics",t("saAnalytics")]];
  const tabBar=tabs.map(([id,lbl])=>`<button onclick="state.saTab='${id}';render()" style="flex:1;padding:10px 0;border-radius:10px;font-size:11px;font-weight:700;background:${tb===id?"var(--gold)":"var(--c2)"};color:${tb===id?"#080706":"var(--stone)"};border:1px solid ${tb===id?"var(--gold)":"var(--border)"}">${lbl}</button>`).join("");
  let content="";
  if(tb==="providers"){
    content=PROVS.map(p=>`
    <div class="card" style="padding:12px 14px;margin-bottom:8px;${p.tier==="gold"?"border:1px solid rgba(200,168,75,.25)":""}">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
        <div style="display:flex;align-items:center;gap:8px;min-width:0;flex:1">
          ${p.logo?`<img src="${p.logo}" style="width:28px;height:28px;border-radius:6px;object-fit:cover;flex-shrink:0">`:`<div style="width:28px;height:28px;border-radius:6px;background:${p.bc};flex-shrink:0"></div>`}
          <div style="min-width:0"><p style="font-size:13px;font-weight:700;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${p.nm}</p>
          <p style="font-size:10px;color:var(--stone)">${p.city} · ${p.cat}</p></div>
        </div>
        <span class="badge ${p.tier==="gold"?"bgd":p.tier==="premium"?"bgd":"bgr"}" style="font-size:9px;flex-shrink:0">${p.tier==="gold"?"👑 GOLD":p.tier==="premium"?"⚡ PREM":"FREE"}</span>
      </div>
      <div style="display:flex;gap:6px;flex-wrap:wrap">
        <button onclick="saTier('${p.id}','gold')" style="padding:5px 10px;border-radius:6px;font-size:10px;font-weight:700;background:${p.tier==="gold"?"var(--gold)":"var(--c3)"};color:${p.tier==="gold"?"#080706":"var(--stone)"};border:1px solid ${p.tier==="gold"?"var(--gold)":"var(--border)"}">Gold</button>
        <button onclick="saTier('${p.id}','premium')" style="padding:5px 10px;border-radius:6px;font-size:10px;font-weight:700;background:${p.tier==="premium"?"var(--gold)":"var(--c3)"};color:${p.tier==="premium"?"#080706":"var(--stone)"};border:1px solid ${p.tier==="premium"?"var(--gold)":"var(--border)"}">Premium</button>
        <button onclick="saTier('${p.id}','free')" style="padding:5px 10px;border-radius:6px;font-size:10px;font-weight:700;background:${p.tier==="free"?"var(--c5)":"var(--c3)"};color:var(--stone);border:1px solid var(--border)">Free</button>
        <div style="flex:1"></div>
        <div style="display:flex;align-items:center;gap:4px">
          <span style="font-size:10px;color:var(--stone)">Boost:</span>
          <input type="range" min="0" max="100" value="${p.boost||0}" oninput="saBoost('${p.id}',this.value)" style="width:60px;accent-color:var(--gold)"/>
          <span style="font-size:10px;font-weight:700;color:var(--gold2);width:22px">${p.boost||0}</span>
        </div>
      </div>
    </div>`).join("");
  }
  if(tb==="features"){
    const features=[
      {id:"aiIcon",nm:t("saIconFeature"),desc:"Dükkanlar logolarından AI ikon üretebilir",active:true},
      {id:"premList",nm:"Premium Listing",desc:"Gold/Premium dükkanlar listenin üstünde",active:true},
      {id:"newsletter",nm:"Newsletter",desc:"Kullanıcılardan e-mail toplama",active:true},
      {id:"referral",nm:"Referral Program",desc:"Kullanıcılar arası davet sistemi",active:true},
      {id:"boost",nm:"Boost Marketplace",desc:"Ödeme ile sıralama yükseltme",active:false}
    ];
    content=`<p style="font-size:var(--font-sm);color:var(--stone);margin-bottom:14px">Platform özelliklerini aktif/deaktif edin</p>
    ${features.map(f=>`
    <div class="card" style="padding:14px;margin-bottom:8px">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="flex:1"><p style="font-size:13px;font-weight:700">${f.nm}</p><p style="font-size:11px;color:var(--stone)">${f.desc}</p></div>
        <div class="switch ${f.active?"on":""}"></div>
      </div>
    </div>`).join("")}`;
  }
  if(tb==="analytics"){
    const gold=PROVS.filter(p=>p.tier==="gold").length;
    const prem=PROVS.filter(p=>p.tier==="premium").length;
    const free=PROVS.filter(p=>p.tier==="free").length;
    const totalRev=gold*99+prem*49;
    content=`
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:16px">
      <div class="card" style="padding:14px;text-align:center"><p style="font-size:28px;font-weight:800;color:var(--gold2)">${PROVS.length}</p><p style="font-size:10px;color:var(--stone)">${t("saTotalProviders")}</p></div>
      <div class="card" style="padding:14px;text-align:center"><p style="font-size:28px;font-weight:800;color:var(--gold2)">${totalRev} €</p><p style="font-size:10px;color:var(--stone)">MRR (Monthly)</p></div>
      <div class="card" style="padding:14px;text-align:center"><p style="font-size:28px;font-weight:800;color:#F5E080">${gold}</p><p style="font-size:10px;color:var(--stone)">${t("saGoldCount")}</p></div>
      <div class="card" style="padding:14px;text-align:center"><p style="font-size:28px;font-weight:800;color:#C8A84B">${prem}</p><p style="font-size:10px;color:var(--stone)">${t("saPremiumCount")}</p></div>
    </div>
    <p class="lsm" style="margin-bottom:8px">Revenue Breakdown</p>
    <div class="card" style="padding:14px;margin-bottom:10px">
      ${[["Gold ("+gold+"×99€)",gold*99,"#F5E080"],["Premium ("+prem+"×49€)",prem*49,"#C8A84B"],["Free ("+free+"×0€)",0,"var(--stone)"]].map(([l,v,c])=>`
      <div style="display:flex;justify-content:space-between;align-items:center;padding:6px 0;${v>0?"":"opacity:.5"}">
        <span style="font-size:13px;color:${c}">${l}</span>
        <span style="font-size:13px;font-weight:800;color:${c}">${v} €/mo</span>
      </div>`).join("")}
      <div style="border-top:1px solid var(--border);padding-top:8px;margin-top:8px;display:flex;justify-content:space-between">
        <span style="font-size:14px;font-weight:800;color:var(--gold2)">Total MRR</span>
        <span style="font-size:14px;font-weight:800;color:var(--gold2)">${totalRev} €/mo</span>
      </div>
    </div>
    <p class="lsm" style="margin-bottom:8px">Tier Distribution</p>
    <div class="card" style="padding:14px">
      <div style="display:flex;gap:4px;height:20px;border-radius:6px;overflow:hidden;margin-bottom:8px">
        <div style="flex:${gold};background:linear-gradient(90deg,#F5E080,#C8A84B);border-radius:4px"></div>
        <div style="flex:${prem};background:linear-gradient(90deg,#C8A84B,#9A70C8);border-radius:4px"></div>
        <div style="flex:${free};background:var(--c4);border-radius:4px"></div>
      </div>
      <div style="display:flex;justify-content:space-around;font-size:11px">
        <span style="color:#F5E080">Gold ${Math.round(gold/PROVS.length*100)}%</span>
        <span style="color:#C8A84B">Premium ${Math.round(prem/PROVS.length*100)}%</span>
        <span style="color:var(--stone)">Free ${Math.round(free/PROVS.length*100)}%</span>
      </div>
    </div>`;
  }
  return`<div class="sticky">
    <button onclick="goSub(null)" style="font-size:var(--font-md);color:var(--gold);font-weight:700;min-height:44px;display:flex;align-items:center;gap:4px">← ${t("back")}</button>
    <h1 style="font-size:var(--font-lg);font-weight:700;font-family:'Cinzel',serif;color:var(--gold2);margin-top:4px">🛡 ${t("saPanel")}</h1>
    <div style="display:flex;gap:5px;margin-top:10px">${tabBar}</div>
  </div>
  <div style="padding:16px var(--pad) 40px">${content}</div>`;
}
function saTier(provId,tier){const p=PROVS.find(x=>x.id===provId);if(p){p.tier=tier;p.prom=tier!=="free";}render();}
function saBoost(provId,val){const p=PROVS.find(x=>x.id===provId);if(p)p.boost=parseInt(val);render();}

// ─── PRICING / SUBSCRIPTION PLANS ───
function renderPricing(){
  const plans=[
    {id:"free",nm:t("pricingFree"),sub:t("pricingFreeSub"),price:"0",features:["Basisprofil","Bis zu 3 Services","Standard-Listing","E-Mail Support"],color:"var(--stone)",border:"var(--border)"},
    {id:"premium",nm:t("pricingPrem"),sub:t("pricingPremSub"),price:"49",features:["Erweitertes Profil","Unbegrenzte Services","Höheres Listing","AI-Icon Feature","Priority Support","Rabatt-Aktionen"],color:"#C8A84B",border:"rgba(200,168,75,.4)",pop:true},
    {id:"gold",nm:t("pricingGold"),sub:t("pricingGoldSub"),price:"99",features:["Premium-Profil","Unbegrenzte Services","Top-Listing garantiert","AI-Icon Feature","24/7 VIP Support","Rabatt-Aktionen","Boost inklusive","Analytics Dashboard","Social Media Kit"],color:"#F5E080",border:"rgba(245,224,128,.5)"}
  ];
  return`<div class="sticky">
    <button onclick="goSub(null)" style="font-size:var(--font-md);color:var(--gold);font-weight:700;min-height:44px;display:flex;align-items:center;gap:4px">← ${t("back")}</button>
    <h1 style="font-size:var(--font-lg);font-weight:700;font-family:'Cinzel',serif;color:var(--gold2);margin-top:4px">${t("pricingTitle")}</h1>
  </div>
  <div style="padding:16px var(--pad) 40px">
    ${plans.map(pl=>`
    <div class="card" style="padding:20px;margin-bottom:14px;border:2px solid ${pl.border};${pl.pop?"background:linear-gradient(135deg,#1A1608,#141008);box-shadow:0 0 24px rgba(200,168,75,.1)":""}">
      ${pl.pop?`<span class="badge bgd" style="margin-bottom:10px;font-size:10px">⭐ EMPFOHLEN</span>`:""}
      <div style="display:flex;justify-content:space-between;align-items:flex-end;margin-bottom:12px">
        <div>
          <p style="font-size:var(--font-lg);font-weight:800;color:${pl.color}">${pl.nm}</p>
          <p style="font-size:var(--font-sm);color:var(--stone)">${pl.sub}</p>
        </div>
        <div style="text-align:right">
          <p style="font-size:28px;font-weight:800;color:${pl.color}">${pl.price} €</p>
          <p style="font-size:11px;color:var(--stone)">${t("pricingMonth")}</p>
        </div>
      </div>
      <p style="font-size:11px;font-weight:700;color:var(--stone);margin-bottom:8px">${t("pricingFeatures")}:</p>
      <div style="display:flex;flex-direction:column;gap:6px;margin-bottom:14px">
        ${pl.features.map(f=>`<div style="display:flex;gap:8px;align-items:center"><span style="color:${pl.color};font-size:12px">✓</span><span style="font-size:12px">${f}</span></div>`).join("")}
      </div>
      <button class="${pl.id==="free"?"boutline":"bgold"}" style="width:100%;${pl.id==="gold"?"background:linear-gradient(135deg,#F5E080,#C8A84B)":""}" onclick="showToast('${pl.nm} gewählt!')">${PROVS[0].tier===pl.id?t("pricingCurrent"):t("pricingUpgrade")}</button>
    </div>`).join("")}
  </div>`;
}

// ─── SOCIAL MEDIA & QR ───
function renderSocial(){
  const p=PROVS[0];
  return`<div class="sticky">
    <button onclick="goSub(null)" style="font-size:var(--font-md);color:var(--gold);font-weight:700;min-height:44px;display:flex;align-items:center;gap:4px">← ${t("back")}</button>
    <h1 style="font-size:var(--font-lg);font-weight:700;font-family:'Cinzel',serif;color:var(--gold2);margin-top:4px">📱 Social Media Kit</h1>
  </div>
  <div style="padding:16px var(--pad) 40px">
    <!-- STORY TEMPLATES -->
    <p class="lsm" style="margin-bottom:10px">Story / Post Templates</p>
    <div style="display:flex;gap:10px;overflow-x:auto;padding-bottom:10px;margin-bottom:16px">
      ${[
        {bg:"linear-gradient(135deg,#1A1608,#0A0800)",title:"Jetzt buchen!",sub:p.nm,accent:"#C8A84B"},
        {bg:"linear-gradient(135deg,#0A1020,#1A0830)",title:"NEU bei ChairMatch",sub:"Jetzt entdecken",accent:"#9A70C8"},
        {bg:"linear-gradient(135deg,#081408,#0A2010)",title:"Top bewertet ⭐",sub:p.rt+" / 5.0",accent:"#4AA890"}
      ].map((tmpl,i)=>`
      <div style="flex-shrink:0;width:200px;height:356px;border-radius:18px;overflow:hidden;background:${tmpl.bg};border:1px solid rgba(200,168,75,.2);display:flex;flex-direction:column;justify-content:space-between;padding:20px;position:relative" id="storyCard${i}">
        <div>
          <div style="display:flex;align-items:center;gap:8px;margin-bottom:16px">
            ${p.logo?`<img src="${p.logo}" style="width:32px;height:32px;border-radius:8px;object-fit:cover"/>`:`<div style="width:32px;height:32px;border-radius:8px;background:${p.bc}"></div>`}
            <span style="font-size:11px;font-weight:700;color:var(--cream)">${p.nm}</span>
          </div>
        </div>
        <div>
          <p style="font-size:22px;font-weight:800;color:${tmpl.accent};line-height:1.2;margin-bottom:6px;font-family:'Cinzel',serif">${tmpl.title}</p>
          <p style="font-size:13px;color:var(--stone);margin-bottom:16px">${tmpl.sub}</p>
          <div style="padding:10px 16px;background:${tmpl.accent};border-radius:10px;text-align:center">
            <span style="font-size:12px;font-weight:800;color:#080706">chairmatch.vercel.app</span>
          </div>
        </div>
      </div>`).join("")}
    </div>

    <!-- QR CODE -->
    <p class="lsm" style="margin-bottom:10px">QR Code</p>
    <div class="card" style="padding:20px;margin-bottom:14px;text-align:center">
      <div id="qrArea" style="display:inline-block;padding:16px;background:#fff;border-radius:12px;margin-bottom:12px">
        <canvas id="qrCanvas" width="160" height="160"></canvas>
      </div>
      <p style="font-size:12px;color:var(--stone);margin-bottom:4px">chairmatch.vercel.app</p>
      <p style="font-size:11px;color:var(--stone2);margin-bottom:12px">Kunden scannen → direkt zur Buchung</p>
      <button class="bgold" style="width:auto;padding:10px 20px;font-size:13px" onclick="downloadQR()">📥 QR herunterladen</button>
    </div>

    <!-- SHARE LINKS -->
    <p class="lsm" style="margin-bottom:10px">Teilen</p>
    <div style="display:flex;flex-direction:column;gap:8px">
      <button class="boutline" onclick="shareSocial('instagram')" style="display:flex;align-items:center;gap:10px;padding:14px 16px">
        <span style="font-size:20px">📸</span><span style="flex:1;text-align:left;font-weight:700">Instagram Story</span><span style="color:var(--stone)">›</span>
      </button>
      <button class="boutline" onclick="shareSocial('whatsapp')" style="display:flex;align-items:center;gap:10px;padding:14px 16px">
        <span style="font-size:20px">💬</span><span style="flex:1;text-align:left;font-weight:700">WhatsApp Status</span><span style="color:var(--stone)">›</span>
      </button>
      <button class="boutline" onclick="shareSocial('tiktok')" style="display:flex;align-items:center;gap:10px;padding:14px 16px">
        <span style="font-size:20px">🎵</span><span style="flex:1;text-align:left;font-weight:700">TikTok Bio Link</span><span style="color:var(--stone)">›</span>
      </button>
      <button class="boutline" onclick="shareSocial('copy')" style="display:flex;align-items:center;gap:10px;padding:14px 16px">
        <span style="font-size:20px">🔗</span><span style="flex:1;text-align:left;font-weight:700">Link kopieren</span><span style="color:var(--stone)">›</span>
      </button>
    </div>
  </div>`;
}
function generateQR(){
  const c=document.getElementById("qrCanvas");if(!c)return;
  const ctx=c.getContext("2d");const s=160;ctx.fillStyle="#fff";ctx.fillRect(0,0,s,s);
  // Simple QR-like pattern (visual placeholder - real QR would use a library)
  const url="chairmatch.vercel.app";ctx.fillStyle="#080706";
  // Corner markers
  [[4,4,28],[4,128,28],[128,4,28]].forEach(([x,y,sz])=>{ctx.fillRect(x,y,sz,sz);ctx.fillStyle="#fff";ctx.fillRect(x+4,y+4,sz-8,sz-8);ctx.fillStyle="#080706";ctx.fillRect(x+8,y+8,sz-16,sz-16);ctx.fillStyle="#080706";});
  // Data modules (seeded from URL)
  for(let i=0;i<url.length;i++){
    const code=url.charCodeAt(i);
    for(let b=0;b<8;b++){
      if((code>>b)&1){
        const col=36+((i*8+b)%9)*12;const row=36+Math.floor((i*8+b)/9)*12;
        if(col<152&&row<152)ctx.fillRect(col,row,8,8);
      }
    }
  }
  // Center logo
  ctx.fillStyle="#C8A84B";ctx.fillRect(64,64,32,32);ctx.fillStyle="#080706";ctx.font="bold 14px Cinzel";ctx.textAlign="center";ctx.fillText("CM",80,82);
}
function downloadQR(){
  const c=document.getElementById("qrCanvas");if(!c)return;
  const a=document.createElement("a");a.download="chairmatch-qr.png";a.href=c.toDataURL("image/png");a.click();showToast("QR heruntergeladen!");
}
function shareSocial(platform){
  const url="https://chairmatch.vercel.app";
  const text="Buche deinen nächsten Termin bei ChairMatch! "+url;
  if(platform==="whatsapp")window.open("https://wa.me/?text="+encodeURIComponent(text),"_blank");
  else if(platform==="copy"){navigator.clipboard?.writeText(url).then(()=>showToast(t("linkCopied")));}
  else if(navigator.share){navigator.share({title:"ChairMatch",text:text,url:url}).catch(()=>{});}
  else{navigator.clipboard?.writeText(url).then(()=>showToast(t("linkCopied")));}
}

// ─── CHAT / NACHRICHTEN ───
function renderChat(){
  if(!state.chatMessages)state.chatMessages=[
    {id:"c1",from:"BlackLabel Barbershop",msg:"Hallo! Dein Termin ist bestätigt für Mi 10:00 Uhr.",time:"10:32",mine:false},
    {id:"c2",from:"Du",msg:"Danke! Kann ich 10 Minuten später kommen?",time:"10:35",mine:true},
    {id:"c3",from:"BlackLabel Barbershop",msg:"Kein Problem, wir tragen 10:10 ein. Bis dann!",time:"10:36",mine:false}
  ];
  if(!state.chatContacts)state.chatContacts=[
    {id:"ch1",nm:"BlackLabel Barbershop",last:"Kein Problem, wir tragen 10:10 ein.",time:"10:36",unread:1,cat:"barber"},
    {id:"ch2",nm:"Glow Studio",last:"Dein Peeling-Termin wurde bestätigt.",time:"Gestern",unread:0,cat:"kosmetik"},
    {id:"ch3",nm:"MedCenter OP-Räume",last:"Willkommen! Wie können wir helfen?",time:"Mo",unread:0,cat:"opraum"}
  ];
  const activeChat=state.activeChat||null;
  if(activeChat){
    const contact=state.chatContacts.find(c=>c.id===activeChat);
    return`<div class="sticky">
      <div style="display:flex;align-items:center;gap:12px">
        <button onclick="state.activeChat=null;render()" style="font-size:var(--font-md);color:var(--gold);font-weight:700;min-height:44px;display:flex;align-items:center;gap:4px">← ${t("back")}</button>
        <div style="flex:1"><p style="font-size:14px;font-weight:700">${contact?.nm||""}</p></div>
      </div>
    </div>
    <div style="padding:16px var(--pad);display:flex;flex-direction:column;gap:10px;min-height:50vh">
      ${state.chatMessages.map(m=>`
        <div style="display:flex;${m.mine?"justify-content:flex-end":"justify-content:flex-start"}">
          <div style="max-width:80%;padding:10px 14px;border-radius:${m.mine?"16px 4px 16px 16px":"4px 16px 16px 16px"};background:${m.mine?"var(--gold)":"var(--c3)"};color:${m.mine?"#080706":"var(--cream)"}">
            <p style="font-size:13px;line-height:1.5">${m.msg}</p>
            <p style="font-size:10px;opacity:.6;margin-top:4px;text-align:right">${m.time}</p>
          </div>
        </div>`).join("")}
    </div>
    <div style="padding:8px var(--pad) 20px;display:flex;gap:8px;position:sticky;bottom:0;background:var(--c1);border-top:1px solid var(--border)">
      <input id="chatInput" class="inp" style="flex:1;padding:10px 14px" placeholder="Nachricht schreiben..." onkeydown="if(event.key==='Enter')sendChat()"/>
      <button class="bgold" style="width:auto;padding:10px 16px;font-size:14px" onclick="sendChat()">→</button>
    </div>`;}
  return`<div class="sticky">
    <button onclick="goSub(null)" style="font-size:var(--font-md);color:var(--gold);font-weight:700;min-height:44px;display:flex;align-items:center;gap:4px">← ${t("back")}</button>
    <h1 style="font-size:var(--font-lg);font-weight:700;font-family:'Cinzel',serif;color:var(--gold2)">Chat & Nachrichten</h1>
  </div>
  <div style="padding:16px var(--pad)">
    ${state.chatContacts.map(c=>`
    <div onclick="state.activeChat='${c.id}';render()" class="card" style="padding:14px;margin-bottom:8px;cursor:pointer">
      <div style="display:flex;align-items:center;gap:12px">
        <div style="width:44px;height:44px;border-radius:50%;background:var(--c3);display:flex;align-items:center;justify-content:center">${catSVG(c.cat)}</div>
        <div style="flex:1;min-width:0">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:2px">
            <p style="font-size:13px;font-weight:700">${c.nm}</p>
            <span style="font-size:10px;color:var(--stone)">${c.time}</span>
          </div>
          <p style="font-size:12px;color:var(--stone);overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${c.last}</p>
        </div>
        ${c.unread>0?`<div style="width:20px;height:20px;border-radius:50%;background:var(--gold);color:#080706;font-size:10px;font-weight:800;display:flex;align-items:center;justify-content:center;flex-shrink:0">${c.unread}</div>`:""}
      </div>
    </div>`).join("")}
  </div>`;}
function sendChat(){
  const inp=document.getElementById("chatInput");if(!inp||!inp.value.trim())return;
  if(!state.chatMessages)state.chatMessages=[];
  state.chatMessages.push({id:"c"+Date.now(),from:"Du",msg:inp.value.trim(),time:new Date().getHours()+":"+String(new Date().getMinutes()).padStart(2,"0"),mine:true});
  inp.value="";render();
  setTimeout(()=>{state.chatMessages.push({id:"c"+Date.now(),from:"Anbieter",msg:"Danke für deine Nachricht! Wir melden uns in Kürze.",time:new Date().getHours()+":"+String(new Date().getMinutes()).padStart(2,"0"),mine:false});render();},1500);
}

// ─── MAP / KARTE ───
function renderMap(){
  const list=getFiltered();
  return`<div class="sticky">
    <button onclick="goSub(null)" style="font-size:var(--font-md);color:var(--gold);font-weight:700;min-height:44px;display:flex;align-items:center;gap:4px">← ${t("back")}</button>
    <h1 style="font-size:var(--font-lg);font-weight:700;font-family:'Cinzel',serif;color:var(--gold2)">Karte & Navigation</h1>
  </div>
  <div style="padding:16px var(--pad)">
    <div style="width:100%;height:240px;border-radius:16px;background:linear-gradient(135deg,#1A2030,#0A1020);border:1.5px solid var(--border);position:relative;overflow:hidden;margin-bottom:16px">
      <div style="position:absolute;inset:0;opacity:.15;background:repeating-linear-gradient(0deg,transparent,transparent 19px,rgba(200,168,75,.3) 20px),repeating-linear-gradient(90deg,transparent,transparent 19px,rgba(200,168,75,.3) 20px)"></div>
      ${list.slice(0,6).map((p,i)=>{const x=15+Math.floor(i%3)*30+Math.random()*10;const y=15+Math.floor(i/3)*35+Math.random()*10;return`
      <div onclick="openDetail('${p.id}')" style="position:absolute;left:${x}%;top:${y}%;transform:translate(-50%,-100%);cursor:pointer;text-align:center">
        <div style="width:32px;height:32px;border-radius:50%;background:${p.tier==="gold"?"var(--gold)":p.tier==="premium"?"#9A70C8":"var(--c4)"};border:2px solid ${p.tier==="gold"?"var(--gold2)":"var(--border)"};display:flex;align-items:center;justify-content:center;font-size:12px;margin:0 auto 2px;box-shadow:0 2px 8px rgba(0,0,0,.4)">${catSVG(p.cat)?`<div style="transform:scale(.5)">${catSVG(p.cat)}</div>`:"●"}</div>
        <span style="font-size:8px;font-weight:700;color:var(--cream);text-shadow:0 1px 3px rgba(0,0,0,.8);white-space:nowrap">${p.nm.split(" ")[0]}</span>
      </div>`;}).join("")}
    </div>
    <p class="lsm" style="margin-bottom:10px">In deiner Nähe (${list.length})</p>
    ${list.slice(0,5).map(p=>`
    <div onclick="openDetail('${p.id}')" class="card" style="padding:12px 14px;margin-bottom:8px;cursor:pointer">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="display:flex;align-items:center;gap:10px;min-width:0;flex:1">
          <div style="width:36px;height:36px;border-radius:10px;background:var(--c3);display:flex;align-items:center;justify-content:center">${catSVG(p.cat)}</div>
          <div style="min-width:0"><p style="font-size:13px;font-weight:700;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${p.nm}</p><p style="font-size:11px;color:var(--stone)">${p.st} · ${p.city}</p></div>
        </div>
        <div style="text-align:right;flex-shrink:0">
          <p style="font-size:12px;font-weight:800;color:var(--gold2)">ab ${p.svs[0].pr} €</p>
          <span style="font-size:10px;color:${isOpenNow(p.id)==="open"?"#6ABF80":"var(--stone)"}">${isOpenNow(p.id)==="open"?"● Offen":"Geschlossen"}</span>
        </div>
      </div>
    </div>`).join("")}
  </div>`;}

// ─── KALENDER ───
function renderCalendar(){
  const today=new Date();const month=today.toLocaleString("de-DE",{month:"long",year:"numeric"});
  const firstDay=new Date(today.getFullYear(),today.getMonth(),1).getDay();
  const daysInMonth=new Date(today.getFullYear(),today.getMonth()+1,0).getDate();
  const bookedDays=[today.getDate(),today.getDate()+2,today.getDate()+5].filter(d=>d<=daysInMonth);
  const offset=firstDay===0?6:firstDay-1;
  let cells="";for(let i=0;i<offset;i++)cells+=`<div></div>`;
  for(let d=1;d<=daysInMonth;d++){
    const isToday=d===today.getDate();const isBooked=bookedDays.includes(d);
    cells+=`<div style="aspect-ratio:1;display:flex;flex-direction:column;align-items:center;justify-content:center;border-radius:10px;font-size:13px;font-weight:${isToday||isBooked?700:400};background:${isToday?"var(--gold)":isBooked?"rgba(200,168,75,.12)":"transparent"};color:${isToday?"#080706":isBooked?"var(--gold2)":"var(--cream)"};border:1px solid ${isBooked&&!isToday?"rgba(200,168,75,.25)":"transparent"};cursor:pointer">${d}${isBooked&&!isToday?`<div style="width:4px;height:4px;border-radius:50%;background:var(--gold);margin-top:2px"></div>`:""}</div>`;}
  const bkgs=state.bookings.length>0?state.bookings:[{id:"demo1",nm:"Ahmed K.",sv:"Skin Fade",t:"Mi 26.02 · 10:00",st:"confirmed",pr:48,provNm:"BlackLabel Barbershop"},{id:"demo2",nm:"Sofia M.",sv:"Deep Cleanse",t:"Fr 28.02 · 14:00",st:"pending",pr:85,provNm:"Glow Studio"}];
  return`<div class="sticky">
    <button onclick="goSub(null)" style="font-size:var(--font-md);color:var(--gold);font-weight:700;min-height:44px;display:flex;align-items:center;gap:4px">← ${t("back")}</button>
    <h1 style="font-size:var(--font-lg);font-weight:700;font-family:'Cinzel',serif;color:var(--gold2)">Kalender</h1>
  </div>
  <div style="padding:16px var(--pad)">
    <div class="card" style="padding:16px;margin-bottom:16px">
      <p class="cinzel" style="font-size:16px;font-weight:600;text-align:center;margin-bottom:14px;color:var(--gold2)">${month}</p>
      <div style="display:grid;grid-template-columns:repeat(7,1fr);gap:4px;text-align:center;margin-bottom:6px">
        ${["Mo","Di","Mi","Do","Fr","Sa","So"].map(d=>`<div style="font-size:10px;font-weight:700;color:var(--stone);padding:4px 0">${d}</div>`).join("")}
      </div>
      <div style="display:grid;grid-template-columns:repeat(7,1fr);gap:4px">${cells}</div>
    </div>
    <p class="lsm" style="margin-bottom:10px">Anstehende Termine</p>
    ${bkgs.map(b=>`
    <div class="card" style="padding:14px;margin-bottom:8px">
      <div style="display:flex;justify-content:space-between;align-items:start">
        <div><p style="font-size:13px;font-weight:700">${b.provNm||b.nm}</p><p style="font-size:12px;color:var(--stone)">${b.sv} · ${b.t}</p></div>
        <span class="badge ${b.st==="confirmed"?"bgr":b.st==="pending"?"bgd":"brd"}" style="font-size:10px">${b.st==="confirmed"?t("confirmed"):b.st==="pending"?t("pending"):t("cancelled")}</span>
      </div>
    </div>`).join("")}
  </div>`;}

// ─── DOKUMENTE & VERIFIZIERUNG ───
function renderDocuments(){
  // Determine provider category (demo: PROVS[0] = barber)
  const provCat=PROVS[0].cat;
  const isFreelancer=state.regData?.freelancer||false;
  const reqDocs=getRequiredDocs(provCat,isFreelancer);
  if(!state.documents)state.documents=[
    {id:"d1",nm:"Betriebshaftpflicht",st:"verified",date:"15.01.2026"}
  ];
  // Category description for header
  const catLabels={barber:"Barbershop",friseur:"Friseur",kosmetik:"Kosmetik-Studio",aesthetik:"Ästhetik-Klinik",nail:"Nail-Studio",massage:"Massage-Studio",lash:"Lash & Brow Studio",arzt:"Arzt/Klinik",raum:"Raum-Anbieter",opraum:"OP-Raum Anbieter"};
  return`<div class="sticky">
    <button onclick="goSub(null)" style="font-size:var(--font-md);color:var(--gold);font-weight:700;min-height:44px;display:flex;align-items:center;gap:4px">← ${t("back")}</button>
    <h1 style="font-size:var(--font-lg);font-weight:700;font-family:'Cinzel',serif;color:var(--gold2)">Dokumente & Verifizierung</h1>
  </div>
  <div style="padding:16px var(--pad)">
    <div style="padding:12px 14px;background:rgba(200,168,75,.06);border:1px solid rgba(200,168,75,.15);border-radius:12px;margin-bottom:16px">
      <p style="font-size:12px;color:var(--gold2);font-weight:700">Dein Profil: ${catLabels[provCat]||"Anbieter"}</p>
      <p style="font-size:11px;color:var(--stone);margin-top:3px;line-height:1.5">${reqDocs.length===0?"Keine Dokumente erforderlich. Wir sind eine Plattform — Nachweise liegen beim Mieter.":"Die folgenden Dokumente werden für dein Profil benötigt."}</p>
    </div>
    <p class="lsm" style="margin-bottom:10px">Meine Dokumente</p>
    ${state.documents.length===0?`<p style="font-size:12px;color:var(--stone);margin-bottom:14px">Noch keine Dokumente hochgeladen.</p>`:""}
    ${state.documents.map(d=>`
    <div class="card" style="padding:14px;margin-bottom:8px">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div><p style="font-size:13px;font-weight:700">${d.nm}</p><p style="font-size:11px;color:var(--stone)">Hochgeladen: ${d.date}</p></div>
        <span class="badge ${d.st==="verified"?"bgr":"bgd"}" style="font-size:10px">${d.st==="verified"?"✓ Verifiziert":"⏳ In Prüfung"}</span>
      </div>
    </div>`).join("")}
    ${reqDocs.length>0?`<p class="lsm" style="margin:20px 0 10px">Benötigte Dokumente</p>
    ${reqDocs.filter(dt=>!state.documents.find(d=>d.nm===dt.nm)).map(dt=>`
    <div class="card" style="padding:14px;margin-bottom:8px;cursor:pointer" onclick="uploadDocument('${dt.nm}')">
      <div style="display:flex;align-items:center;gap:12px">
        <div style="width:40px;height:40px;border-radius:12px;background:var(--c2);border:1px solid var(--border);display:flex;align-items:center;justify-content:center">${dt.icon}</div>
        <div style="flex:1"><p style="font-size:13px;font-weight:700">${dt.nm}</p><p style="font-size:11px;color:var(--stone)">${dt.desc}</p></div>
        <span style="font-size:12px;color:var(--gold)">+ Upload</span>
      </div>
    </div>`).join("")}`:`
    <div style="padding:16px;background:rgba(74,138,90,.06);border-radius:12px;border:1px solid rgba(74,138,90,.15);margin-top:14px">
      <p style="font-size:12px;color:#6ABF80;font-weight:700;margin-bottom:4px">✓ Keine weiteren Dokumente nötig</p>
      <p style="font-size:11px;color:var(--stone);line-height:1.5">Als Mieter/Freelancer brauchst du keine Nachweise hochzuladen. ChairMatch ist eine Vermittlungsplattform.</p>
    </div>`}
  </div>`;}
function uploadDocument(name){
  if(!state.documents)state.documents=[];
  const today=new Date();const d=String(today.getDate()).padStart(2,"0")+"."+String(today.getMonth()+1).padStart(2,"0")+"."+today.getFullYear();
  state.documents.push({id:"d"+Date.now(),nm:name,st:"pending",date:d});
  showToast(name+" hochgeladen — wird geprüft");render();
}

// ─── ADMIN PANEL (Provider Dashboard + Logo + AI Icons) ───
function renderAdmin(){
  const tb=state.adminTab;
  const p=PROVS[0]; // demo: first provider as "my shop"
  const tabs=[["dashboard",t("adminDash")],["preise","Preise"],["logo",t("adminLogo")],["services",t("adminServices")],["settings",t("adminSettings")]];
  const tabBar=tabs.map(([id,lbl])=>`<button onclick="state.adminTab='${id}';render()" style="flex:1;padding:10px 0;border-radius:10px;font-size:11px;font-weight:700;background:${tb===id?"var(--gold)":"var(--c2)"};color:${tb===id?"#080706":"var(--stone)"};border:1px solid ${tb===id?"var(--gold)":"var(--border)"}">${lbl}</button>`).join("");
  let content="";
  if(tb==="dashboard"){
    const todayBk=Math.floor(Math.random()*5)+3;
    const monthRev=Math.floor(Math.random()*3000)+4500;
    content=`
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:16px">
      <div class="card" style="padding:14px;text-align:center"><p style="font-size:24px;font-weight:800;color:var(--gold2)">${todayBk}</p><p style="font-size:10px;color:var(--stone);margin-top:2px">${t("todayBookings")}</p></div>
      <div class="card" style="padding:14px;text-align:center"><p style="font-size:24px;font-weight:800;color:var(--gold2)">${monthRev} €</p><p style="font-size:10px;color:var(--stone);margin-top:2px">${t("totalRevenue")}</p></div>
      <div class="card" style="padding:14px;text-align:center"><p style="font-size:24px;font-weight:800;color:var(--gold2)">${p.rt}</p><p style="font-size:10px;color:var(--stone);margin-top:2px">${t("avgRating")}</p></div>
      <div class="card" style="padding:14px;text-align:center"><p style="font-size:24px;font-weight:800;color:var(--gold2)">${p.rc}</p><p style="font-size:10px;color:var(--stone);margin-top:2px">${t("totalReviews")}</p></div>
    </div>
    <p class="lsm" style="margin-bottom:8px">${t("todayBookings")}</p>
    ${[{nm:"Tobias K.",sv:"Signature Cut",time:"10:00",st:"confirmed"},{nm:"Sarah L.",sv:"Skin Fade",time:"11:30",st:"confirmed"},{nm:"Leon M.",sv:"Beard Design",time:"14:00",st:"pending"}].map(b=>`
    <div class="card" style="padding:12px 14px;margin-bottom:6px">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div><p style="font-size:13px;font-weight:700">${b.nm}</p><p style="font-size:11px;color:var(--stone)">${b.sv}</p></div>
        <div style="text-align:right"><p style="font-size:13px;font-weight:700;color:var(--gold2)">${b.time}</p><span style="font-size:10px;color:${b.st==="confirmed"?"#6ABF80":"var(--gold)"}">${t(b.st)}</span></div>
      </div>
    </div>`).join("")}
    <div style="margin-top:16px">
      <p class="lsm" style="margin-bottom:8px">Tier & Boost</p>
      <div class="card" style="padding:14px">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
          <span style="font-size:13px;color:var(--stone)">Aktueller Tier</span>
          <span class="badge bgd" style="font-size:11px">${p.tier==="gold"?"👑 GOLD":p.tier==="premium"?"⚡ PREMIUM":"FREE"}</span>
        </div>
        <div style="display:flex;justify-content:space-between;align-items:center">
          <span style="font-size:13px;color:var(--stone)">Boost Score</span>
          <span style="font-size:14px;font-weight:800;color:var(--gold2)">${p.boost||0}/100</span>
        </div>
        <div class="pbar" style="margin-top:8px"><div class="pfill" style="width:${p.boost||0}%"></div></div>
      </div>
    </div>`;
  }
  if(tb==="preise"){
    const rentalTypes={stuhl:{svg:rentalIcon("stuhl"),nm:"Stuhl",desc:"Barber-/Friseur-Stuhl"},liege:{svg:rentalIcon("liege"),nm:"Liege",desc:"Massage-/Kosmetik-Liege"},raum:{svg:rentalIcon("raum"),nm:"Kabine",desc:"Kosmetik-Kabine / Behandlungsraum"},opraum:{svg:rentalIcon("opraum"),nm:"OP-Raum",desc:"Steriler Operationssaal"}};
    const allowed=getAllowedRentals(p.cat);
    const rentals=p.rental||[];
    const stdPrices={stuhl:"35–55",liege:"30–50",raum:"50–80",opraum:"250–500"};
    content=`
    <p class="lgold" style="margin-bottom:6px">${rentalIcon("stuhl")} Vermietungspreise</p>
    <p style="font-size:12px;color:var(--stone);margin-bottom:14px;line-height:1.5">Verwalte deine Tagespreise. Preisänderungen werden mit ChairMatch abgestimmt.</p>
    ${Object.entries(rentalTypes).map(([key,rt])=>{
      const existing=rentals.find(r=>r.type===key);
      const active=existing?true:false;
      const price=existing?existing.pr:"";
      const isAllowed=allowed.includes(key)||active;
      const reqSent=(state.unlockRequests||[]).includes(key);
      if(!isAllowed)return`<div class="card" style="padding:14px;margin-bottom:10px;border:1.5px dashed var(--c5);opacity:.65">
        <div style="display:flex;align-items:center;gap:12px">
          <div style="width:40px;display:flex;align-items:center;justify-content:center;opacity:.4">${rt.svg}</div>
          <div style="flex:1"><p style="font-size:14px;font-weight:700;color:var(--stone)">${rt.nm}</p><p style="font-size:11px;color:var(--stone2)">${rt.desc}</p>
            <p style="font-size:10px;color:var(--gold);margin-top:4px">🔒 Nicht verfügbar für deine Kategorie</p></div>
          ${reqSent?`<span style="font-size:10px;color:#6ABF80;font-weight:700;white-space:nowrap">✓ Angefragt</span>`:`<button onclick="requestUnlock('${key}')" style="padding:6px 10px;border-radius:8px;background:var(--c3);border:1px solid var(--border);font-size:10px;color:var(--gold);font-weight:700;white-space:nowrap;cursor:pointer">Anfragen</button>`}
        </div>
      </div>`;
      return`<div class="card" style="padding:14px;margin-bottom:10px;border:1.5px solid ${active?"rgba(200,168,75,.25)":"var(--border)"}">
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:${active?"10":"0"}px">
          <div style="width:40px;display:flex;align-items:center;justify-content:center">${rt.svg}</div>
          <div style="flex:1"><p style="font-size:14px;font-weight:700">${rt.nm}</p><p style="font-size:11px;color:var(--stone)">${rt.desc}</p>
            <p style="font-size:10px;color:var(--stone2);margin-top:2px">Standardpreis: ${stdPrices[key]} €/Tag</p></div>
          <div onclick="toggleRental('${key}')" style="width:44px;height:26px;border-radius:13px;background:${active?"var(--gold)":"var(--c4)"};cursor:pointer;position:relative;transition:background .2s">
            <div style="width:20px;height:20px;border-radius:50%;background:#fff;position:absolute;top:3px;${active?"right:3px":"left:3px"};transition:all .2s"></div>
          </div>
        </div>
        ${active?`<div style="display:flex;gap:10px;align-items:center;padding-top:8px;border-top:1px solid var(--border)">
          <label style="font-size:12px;color:var(--stone);white-space:nowrap">Preis/Tag</label>
          <div style="flex:1;display:flex;align-items:center;gap:6px">
            <input class="inp" type="number" value="${price}" oninput="updateRentalPrice('${key}',this.value)" style="flex:1;text-align:right;font-size:16px;font-weight:700" placeholder="0"/>
            <span style="font-size:14px;font-weight:700;color:var(--gold2)">€</span>
          </div>
        </div>`:""}
      </div>`;}).join("")}
    <div style="margin-top:14px;padding:14px;background:rgba(200,168,75,.04);border-radius:12px;border:1px solid rgba(200,168,75,.12)">
      <p style="font-size:12px;color:var(--gold2);font-weight:700;margin-bottom:6px">📩 Preise mit ChairMatch abstimmen</p>
      <p style="font-size:11px;color:var(--stone);line-height:1.5;margin-bottom:10px">Sende uns eine Nachricht um deinen Standardpreis festzulegen. Wir prüfen dein Angebot und stimmen faire Konditionen mit dir ab.</p>
      <button onclick="goSub('chat');showToast('Schreibe uns deine gewünschten Preise!')" style="padding:10px 16px;border-radius:10px;background:var(--c3);border:1px solid var(--gold);color:var(--gold2);font-size:12px;font-weight:700;cursor:pointer;width:100%">💬 Nachricht an ChairMatch senden</button>
    </div>
    <div style="margin-top:10px;padding:14px;background:rgba(74,138,90,.06);border-radius:12px;border:1px solid rgba(74,138,90,.15)">
      <p style="font-size:12px;color:#6ABF80;font-weight:700;margin-bottom:4px">✓ Faire Konditionen</p>
      <p style="font-size:11px;color:var(--stone);line-height:1.5">Du kannst nur das anbieten, was du auch wirklich hast. Für weitere Kategorien schicke uns Fotos zur Verifizierung.</p>
    </div>`;
  }
  if(tb==="logo"){
    content=`
    <!-- CURRENT LOGO -->
    <div class="card" style="padding:18px;margin-bottom:14px">
      <p class="lgold" style="margin-bottom:12px">${t("uploadLogo")}</p>
      <p style="font-size:var(--font-sm);color:var(--stone);margin-bottom:14px;line-height:1.5">${t("logoDesc")}</p>
      ${state.adminLogo?`
        <div style="display:flex;align-items:center;gap:14px;margin-bottom:14px;padding:12px;background:var(--c2);border-radius:12px">
          <img src="${state.adminLogo}" style="width:64px;height:64px;border-radius:12px;object-fit:cover;border:2px solid var(--gold)"/>
          <div style="flex:1"><p style="font-size:13px;font-weight:700">Aktuelles Logo</p><p style="font-size:11px;color:var(--stone)">Hochgeladen</p></div>
          <button class="boutline" style="padding:8px 12px;font-size:11px" onclick="removeAdminLogo()">${t("removeLogo")}</button>
        </div>`:`
        <div style="border:2px dashed var(--c5);border-radius:14px;padding:30px;text-align:center;cursor:pointer;margin-bottom:14px" onclick="document.getElementById('logoUpload').click()">
          <p style="font-size:30px;margin-bottom:8px">📤</p>
          <p style="font-size:13px;color:var(--stone)">Klicke zum Hochladen</p>
          <p style="font-size:11px;color:var(--stone2)">JPG, PNG · max 2 MB</p>
        </div>`}
      <input type="file" id="logoUpload" accept="image/*" style="display:none" onchange="handleLogoUpload(event)"/>
      ${!state.adminLogo?"":`<button class="bgold" style="width:100%" ${state.adminGenerated?"disabled":""} onclick="generateAIIcons()">${state.adminGenerated?t("generating"):t("generateIcons")}</button>`}
    </div>

    <!-- AI GENERATED ICONS -->
    ${state.adminIcons.length>0?`
    <div class="card" style="padding:18px;margin-bottom:14px">
      <p class="lgold" style="margin-bottom:6px">🤖 AI-${t("generateIcons").split(" ")[0]} Icons</p>
      <p style="font-size:var(--font-sm);color:var(--stone);margin-bottom:14px;line-height:1.5">${t("iconDesc")}</p>
      <div style="display:flex;gap:10px;margin-bottom:14px">
        ${state.adminIcons.map((icon,i)=>`
        <div style="flex:1;text-align:center" onclick="selectAdminIcon(${i})">
          <div style="width:100%;aspect-ratio:1;border-radius:14px;overflow:hidden;border:2.5px solid ${state.adminSelectedIcon===String(i)?"var(--gold)":"var(--c4)"};cursor:pointer;margin-bottom:6px;background:var(--c2);display:flex;align-items:center;justify-content:center;position:relative${state.adminSelectedIcon===String(i)?";box-shadow:0 0 16px rgba(200,168,75,.3)":""}">
            <img src="${icon}" style="width:80%;height:80%;object-fit:contain"/>
            ${state.adminSelectedIcon===String(i)?`<div style="position:absolute;top:4px;right:4px;width:20px;height:20px;border-radius:50%;background:var(--gold);color:#080706;font-size:10px;font-weight:900;display:flex;align-items:center;justify-content:center">✓</div>`:""}
          </div>
          <p style="font-size:10px;font-weight:700;color:${state.adminSelectedIcon===String(i)?"var(--gold2)":"var(--stone)"}">${[t("iconStyle1"),t("iconStyle2"),t("iconStyle3")][i]}</p>
        </div>`).join("")}
      </div>
      ${state.adminSelectedIcon!==null?`<div style="padding:10px;background:rgba(74,138,90,.1);border-radius:10px;border:1px solid rgba(74,138,90,.2);text-align:center">
        <p style="font-size:12px;color:#6ABF80;font-weight:700">✓ ${t("selectedIcon")} — ${[t("iconStyle1"),t("iconStyle2"),t("iconStyle3")][parseInt(state.adminSelectedIcon)]}</p>
      </div>`:""}
    </div>`:""}

    <!-- PREVIEW IN LISTING -->
    ${state.adminSelectedIcon!==null?`
    <p class="lsm" style="margin-bottom:8px">Vorschau in der Liste</p>
    <div class="card" style="padding:13px 15px;margin-bottom:14px;border:1.5px solid rgba(200,168,75,.3)">
      <div style="display:flex;gap:5px;flex-wrap:wrap;margin-bottom:5px">${badge("👑 GOLD","bgd")}${badge("✓ "+t("verified"),"bgr")}</div>
      <div style="display:flex;align-items:center;gap:8px;margin-bottom:2px">
        <img src="${state.adminIcons[parseInt(state.adminSelectedIcon)]}" style="width:28px;height:28px;border-radius:6px;object-fit:cover"/>
        <p style="font-size:var(--font-md);font-weight:800">${p.nm}</p>
      </div>
      <p style="font-size:var(--font-sm);color:var(--stone)">${p.st} · ${p.city}</p>
    </div>`:""}`;
  }
  if(tb==="services"){
    const cat=p.cat;
    const catalog=SVC_CATALOG[cat]||[];
    if(!state.provServices)state.provServices=JSON.parse(localStorage.getItem("cm_prov_svcs")||"null")||p.svs.map(s=>s.nm);
    if(!state.provPrices)state.provPrices=JSON.parse(localStorage.getItem("cm_prov_prices")||"{}");
    const catLabels={barber:"Barbershop",friseur:"Friseur",kosmetik:"Kosmetik",aesthetik:"Ästhetik",nail:"Nails",massage:"Massage",lash:"Lash & Brows",arzt:"Arzt/Klinik",raum:"Raum-Anbieter",opraum:"OP-Raum"};
    content=`
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
      <p class="lgold">Meine Dienste</p>
      <span style="font-size:11px;color:var(--stone);background:var(--c3);padding:4px 10px;border-radius:8px">${catLabels[cat]||cat}</span>
    </div>
    <p style="font-size:12px;color:var(--stone);margin-bottom:14px;line-height:1.5">Schalte die Services frei, die du anbietest. Kunden sehen dein Angebot wie eine digitale Speisekarte.</p>
    <div style="display:flex;justify-content:space-between;align-items:center;padding:10px 14px;background:rgba(200,168,75,.04);border-radius:10px;border:1px solid rgba(200,168,75,.1);margin-bottom:14px">
      <span style="font-size:12px;color:var(--stone)">${state.provServices.length}/${catalog.length} aktiv</span>
      <button onclick="toggleAllServices()" style="padding:5px 12px;border-radius:8px;background:var(--c3);border:1px solid var(--border);font-size:11px;color:var(--gold);font-weight:700;cursor:pointer">${state.provServices.length===catalog.length?"Alle deaktivieren":"Alle aktivieren"}</button>
    </div>
    ${catalog.map((sv,i)=>{
      const active=state.provServices.includes(sv.nm);
      const customPr=state.provPrices[sv.nm];
      const displayPr=customPr!==undefined?customPr:sv.pr;
      return`
    <div style="margin-bottom:8px;border:1.5px solid ${active?"rgba(200,168,75,.2)":"var(--border)"};border-radius:12px;overflow:hidden;background:${active?"rgba(200,168,75,.03)":"var(--c2)"}">
      <div style="display:flex;align-items:center;gap:10px;padding:12px 14px">
        <div onclick="toggleService('${sv.nm.replace(/'/g,"\\'")}')" style="width:44px;height:26px;border-radius:13px;background:${active?"var(--gold)":"var(--c4)"};cursor:pointer;position:relative;transition:background .2s;flex-shrink:0">
          <div style="width:20px;height:20px;border-radius:50%;background:#fff;position:absolute;top:3px;${active?"right:3px":"left:3px"};transition:all .2s"></div>
        </div>
        <div style="flex:1"><p style="font-size:13px;font-weight:700;color:${active?"var(--fg)":"var(--stone)"}">${sv.nm}</p><p style="font-size:11px;color:var(--stone2)">${sv.dur} min · Standard: ${sv.pr} €</p></div>
        ${active?`<div style="display:flex;align-items:center;gap:4px">
          <input class="inp" type="number" value="${displayPr}" oninput="updateServicePrice('${sv.nm.replace(/'/g,"\\'")}',this.value)" style="width:60px;text-align:right;font-size:15px;font-weight:700;padding:6px 8px"/>
          <span style="font-size:13px;font-weight:700;color:var(--gold2)">€</span>
        </div>`:`<span style="font-size:12px;color:var(--stone2)">Aus</span>`}
      </div>
    </div>`;}).join("")}
    <div style="margin-top:14px;padding:14px;background:rgba(200,168,75,.04);border-radius:12px;border:1px solid rgba(200,168,75,.1)">
      <p style="font-size:12px;color:var(--gold2);font-weight:700;margin-bottom:4px">💡 So funktioniert's</p>
      <p style="font-size:11px;color:var(--stone);line-height:1.5">Aktiviere deine Dienste → Kunden sehen sie in deinem Profil als Servicekarte. Du kannst die Preise jederzeit individuell anpassen.</p>
    </div>`;
  }
  if(tb==="settings"){
    content=`
    <div class="card" style="padding:14px;margin-bottom:10px">
      <p style="font-size:13px;font-weight:700;margin-bottom:4px">${p.nm}</p>
      <p style="font-size:12px;color:var(--stone);margin-bottom:8px">${p.st}, ${p.city}</p>
      <p style="font-size:12px;color:var(--stone)">${p.tl}</p>
    </div>
    <div class="card" style="padding:14px;margin-bottom:10px">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <span style="font-size:13px">Tier</span><span class="badge bgd">${p.tier==="gold"?"👑 GOLD":p.tier==="premium"?"⚡ PREMIUM":"FREE"}</span>
      </div>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <span style="font-size:13px">Promoted</span><span style="font-size:13px;color:${p.prom?"#6ABF80":"var(--stone)"}">${p.prom?"Aktiv":"Inaktiv"}</span>
      </div>
      <div style="display:flex;justify-content:space-between;align-items:center">
        <span style="font-size:13px">Verifiziert</span><span style="font-size:13px;color:#6ABF80">✓ Ja</span>
      </div>
    </div>
    <div class="card" style="padding:14px;margin-bottom:10px">
      <p style="font-size:12px;color:var(--stone);margin-bottom:6px">Öffnungszeiten</p>
      ${["Mo-Fr: 09:00 - 19:00","Sa: 10:00 - 16:00","So: Geschlossen"].map(h=>`<p style="font-size:13px;padding:4px 0">${h}</p>`).join("")}
    </div>
    <button class="bgold" onclick="goSub('social')" style="width:100%">📱 Social Media Kit & QR</button>`;
  }
  return`<div class="sticky">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <button onclick="goSub(null)" style="font-size:var(--font-md);color:var(--gold);font-weight:700;min-height:44px;display:flex;align-items:center;gap:4px">← ${t("back")}</button>
    </div>
    <h1 style="font-size:var(--font-lg);font-weight:700;font-family:'Cinzel',serif;color:var(--gold2);margin-top:4px">${t("adminPanel")}</h1>
    <div style="display:flex;gap:5px;margin-top:10px">${tabBar}</div>
  </div>
  <div style="padding:16px var(--pad) 40px">${content}</div>`;
}

// ─── ADMIN: Logo Upload & AI Icon Generation ───
function handleLogoUpload(e){
  const file=e.target.files[0];if(!file)return;
  if(file.size>2*1024*1024){showToast("Max 2 MB!");return;}
  const reader=new FileReader();
  reader.onload=function(ev){
    state.adminLogo=ev.target.result;
    localStorage.setItem("cm_admin_logo",state.adminLogo);
    state.adminIcons=[];state.adminSelectedIcon=null;state.adminGenerated=false;
    localStorage.removeItem("cm_admin_icons");localStorage.removeItem("cm_admin_selicon");
    render();
  };reader.readAsDataURL(file);
}
function removeAdminLogo(){
  state.adminLogo=null;state.adminIcons=[];state.adminSelectedIcon=null;state.adminGenerated=false;
  localStorage.removeItem("cm_admin_logo");localStorage.removeItem("cm_admin_icons");localStorage.removeItem("cm_admin_selicon");
  render();
}
function generateAIIcons(){
  if(!state.adminLogo)return;
  state.adminGenerated=true;render();
  const img=new Image();img.crossOrigin="anonymous";
  img.onload=function(){
    const icons=[];
    // Style 1: Geometric - circle crop with gold border
    const c1=document.createElement("canvas");c1.width=200;c1.height=200;const x1=c1.getContext("2d");
    x1.fillStyle="#0D0B08";x1.fillRect(0,0,200,200);
    x1.save();x1.beginPath();x1.arc(100,100,80,0,Math.PI*2);x1.clip();
    x1.drawImage(img,10,10,180,180);x1.restore();
    x1.strokeStyle="#C8A84B";x1.lineWidth=4;x1.beginPath();x1.arc(100,100,82,0,Math.PI*2);x1.stroke();
    // corners
    x1.strokeStyle="#E8D06A";x1.lineWidth=2;
    [[20,20,35,20,20,35],[180,20,165,20,180,35],[20,180,35,180,20,165],[180,180,165,180,180,165]].forEach(([x,y,lx,ly,rx,ry])=>{x1.beginPath();x1.moveTo(lx,ly);x1.lineTo(x,y);x1.lineTo(rx,ry);x1.stroke();});
    icons.push(c1.toDataURL("image/png"));

    // Style 2: Minimal - rounded square, subtle
    const c2=document.createElement("canvas");c2.width=200;c2.height=200;const x2=c2.getContext("2d");
    x2.fillStyle="#141108";x2.fillRect(0,0,200,200);
    const r=30;x2.save();x2.beginPath();
    x2.moveTo(30+r,30);x2.lineTo(170-r,30);x2.arcTo(170,30,170,30+r,r);x2.lineTo(170,170-r);x2.arcTo(170,170,170-r,170,r);x2.lineTo(30+r,170);x2.arcTo(30,170,30,170-r,r);x2.lineTo(30,30+r);x2.arcTo(30,30,30+r,30,r);x2.closePath();x2.clip();
    x2.filter="saturate(0.6) contrast(1.1)";x2.drawImage(img,25,25,150,150);x2.restore();
    x2.strokeStyle="rgba(200,168,75,0.5)";x2.lineWidth=2;x2.beginPath();
    x2.moveTo(30+r,30);x2.lineTo(170-r,30);x2.arcTo(170,30,170,30+r,r);x2.lineTo(170,170-r);x2.arcTo(170,170,170-r,170,r);x2.lineTo(30+r,170);x2.arcTo(30,170,30,170-r,r);x2.lineTo(30,30+r);x2.arcTo(30,30,30+r,30,r);x2.closePath();x2.stroke();
    icons.push(c2.toDataURL("image/png"));

    // Style 3: Luxury - shield shape with gold gradient overlay
    const c3=document.createElement("canvas");c3.width=200;c3.height=200;const x3=c3.getContext("2d");
    x3.fillStyle="#0A0800";x3.fillRect(0,0,200,200);
    x3.save();x3.beginPath();x3.moveTo(100,10);x3.lineTo(175,35);x3.lineTo(175,120);x3.quadraticCurveTo(175,175,100,195);x3.quadraticCurveTo(25,175,25,120);x3.lineTo(25,35);x3.closePath();x3.clip();
    x3.drawImage(img,15,10,170,185);
    const grd=x3.createLinearGradient(0,0,200,200);grd.addColorStop(0,"rgba(200,168,75,0.25)");grd.addColorStop(0.5,"rgba(245,224,128,0.1)");grd.addColorStop(1,"rgba(200,168,75,0.2)");
    x3.fillStyle=grd;x3.fillRect(0,0,200,200);x3.restore();
    x3.strokeStyle="#C8A84B";x3.lineWidth=3;x3.beginPath();x3.moveTo(100,10);x3.lineTo(175,35);x3.lineTo(175,120);x3.quadraticCurveTo(175,175,100,195);x3.quadraticCurveTo(25,175,25,120);x3.lineTo(25,35);x3.closePath();x3.stroke();
    icons.push(c3.toDataURL("image/png"));

    state.adminIcons=icons;state.adminGenerated=false;
    localStorage.setItem("cm_admin_icons",JSON.stringify(icons));
    showToast("3 AI-Icons generiert!");render();
  };
  img.onerror=function(){state.adminGenerated=false;showToast("Fehler beim Laden");render();};
  img.src=state.adminLogo;
}
function selectAdminIcon(i){
  state.adminSelectedIcon=String(i);
  localStorage.setItem("cm_admin_selicon",state.adminSelectedIcon);
  // Apply to first provider as demo
  PROVS[0].logo=state.adminIcons[i];
  showToast(t("selectedIcon")+" ✓");render();
}
function toggleRental(type){
  const p=PROVS[0];
  if(!p.rental)p.rental=[];
  const allowed=getAllowedRentals(p.cat);
  if(!allowed.includes(type)){showToast("Verifizierung nötig — Nachricht senden");return;}
  const idx=p.rental.findIndex(r=>r.type===type);
  if(idx>-1){p.rental.splice(idx,1);showToast("Entfernt");}
  else{p.rental.push({type,pr:0});showToast("Hinzugefügt");}
  render();
}
function updateRentalPrice(type,val){
  const p=PROVS[0];if(!p.rental)p.rental=[];
  const r=p.rental.find(r=>r.type===type);
  if(r)r.pr=parseFloat(val)||0;
}
// Rental types allowed per business category (without extra verification)
function getAllowedRentals(cat){
  const map={barber:["stuhl"],friseur:["stuhl"],kosmetik:["raum","liege"],aesthetik:["raum"],nail:["stuhl"],massage:["liege","raum"],lash:["stuhl"],arzt:["raum","opraum"],raum:["raum"],opraum:["opraum"]};
  return map[cat]||["stuhl"];
}
// Which documents are required per provider category
function getRequiredDocs(cat,isFreelancer){
  const docs=[];
  // Gewerbeschein: everyone except freelance barbers/friseure
  if(!(isFreelancer&&(cat==="barber"||cat==="friseur")))docs.push({nm:"Gewerbeschein",desc:"Pflichtdokument für Geschäftsinhaber",icon:'<svg width="20" height="20" viewBox="0 0 24 24" fill="none"><rect x="3" y="1" width="18" height="22" rx="2" fill="none" stroke="#C8A84B" stroke-width="1.5"/><line x1="7" y1="7" x2="17" y2="7" stroke="#C8A84B" stroke-width="1" opacity=".4"/><line x1="7" y1="11" x2="17" y2="11" stroke="#C8A84B" stroke-width="1" opacity=".4"/><line x1="7" y1="15" x2="13" y2="15" stroke="#C8A84B" stroke-width="1" opacity=".4"/><circle cx="17" cy="18" r="3" fill="#4A8A5A" opacity=".8"/><path d="M15.5 18L16.5 19L18.5 17" fill="none" stroke="#fff" stroke-width="1" stroke-linecap="round"/></svg>'});
  // Betriebshaftpflicht: everyone
  docs.push({nm:"Betriebshaftpflicht",desc:"Pflichtversicherung für alle Dienstleister",icon:'<svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M12 2L20 6V12C20 17 16.5 21 12 22C7.5 21 4 17 4 12V6L12 2Z" fill="none" stroke="#C8A84B" stroke-width="1.5"/><path d="M12 8V13" stroke="#C8A84B" stroke-width="1.5" stroke-linecap="round"/><circle cx="12" cy="16" r="1" fill="#C8A84B"/></svg>'});
  // Kosmetik-Zertifikat: only for kosmetik, aesthetik, lash
  if(["kosmetik","aesthetik","lash","nail"].includes(cat))docs.push({nm:"Kosmetik-Zertifikat",desc:"Nachweis für kosmetische Behandlungen",icon:'<svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M12 2L20 6V12C20 17 16.5 21 12 22C7.5 21 4 17 4 12V6L12 2Z" fill="none" stroke="#C8A84B" stroke-width="1.5"/><path d="M9 12L11 14L15 10" fill="none" stroke="#C8A84B" stroke-width="1.5" stroke-linecap="round"/></svg>'});
  // Hygiene-Zertifikat: kosmetik, massage, aesthetik, arzt
  if(["kosmetik","massage","aesthetik","arzt"].includes(cat))docs.push({nm:"Hygiene-Zertifikat",desc:"Nachweis für hygienische Standards",icon:'<svg width="20" height="20" viewBox="0 0 24 24" fill="none"><rect x="4" y="2" width="16" height="20" rx="2" fill="none" stroke="#C8A84B" stroke-width="1.5"/><path d="M12 7V11M10 9H14" stroke="#C8A84B" stroke-width="1.5" stroke-linecap="round"/><line x1="8" y1="14" x2="16" y2="14" stroke="#C8A84B" stroke-width="1" opacity=".4"/><line x1="8" y1="17" x2="14" y2="17" stroke="#C8A84B" stroke-width="1" opacity=".4"/></svg>'});
  // OP-Raum mieter: KEINE Dokumente nötig — wir sind Plattform
  // Barber: nur Betriebshaftpflicht (kein Kosmetik/Hygiene-Zertifikat)
  return docs;
}
function requestUnlock(type){
  const names={stuhl:"Stuhl-Vermietung",liege:"Liegen-Vermietung",raum:"Kosmetik-Kabine",opraum:"OP-Raum"};
  showToast("Anfrage für "+names[type]+" gesendet! Wir prüfen das.");
  if(!state.unlockRequests)state.unlockRequests=[];
  if(!state.unlockRequests.includes(type)){state.unlockRequests.push(type);localStorage.setItem("cm_unlock",JSON.stringify(state.unlockRequests));}
  render();
}

function renderRegister(){
  const s=state.regStep;const f=state.regData;
  const snames=["Persönliche Daten","Geschäftsdaten","Services & Stuhl","Bestätigung"];
  if(state.regDone)return`<div style="padding:36px 22px;text-align:center">
    <div style="margin-bottom:16px">${logoHeader(false)}</div>
    <h2 style="font-size:22px;margin-bottom:8px;font-family:'Cinzel',serif;color:var(--gold2)">Eingereicht!</h2>
    <p style="font-size:13px;color:var(--stone);margin-bottom:18px;line-height:1.7">Prüfung innerhalb 24h.<br/>E-Mail-Bestätigung folgt.</p>
    <button class="bgold" onclick="goSub(null)">Zurück zur App</button></div>`;
  let body="";
  if(s===1)body=`<div style="display:flex;flex-direction:column;gap:12px">
    ${[["Vorname","vn","text","Max"],["Nachname","nn","text","Mustermann"],["E-Mail","em","email","max@mail.de"],["Telefon","tel","tel","+49 170 ..."]].map(([l,k,tp,ph])=>`<div><label style="font-size:12px;color:var(--stone);display:block;margin-bottom:4px">${l}</label><input class="inp" type="${tp}" value="${f[k]}" oninput="updateReg('${k}',this.value)" placeholder="${ph}"/></div>`).join("")}</div>`;
  if(s===2){
    const isBarbFris=f.kat==="Barbershop"||f.kat==="Friseur";
    const needGewerbe=!(f.freelancer&&isBarbFris);
    body=`<div style="display:flex;flex-direction:column;gap:12px">
    ${[["Geschäftsname","geschaeft","Mein Studio"],["Straße + Nr.","st","Münchener Str. 17"],["PLZ","plz","60329"],["Stadt","city","Frankfurt"]].map(([l,k,ph])=>`<div><label style="font-size:12px;color:var(--stone);display:block;margin-bottom:4px">${l}</label><input class="inp" value="${f[k]}" oninput="updateReg('${k}',this.value)" placeholder="${ph}"/></div>`).join("")}
    <div><label style="font-size:12px;color:var(--stone);display:block;margin-bottom:8px">Kategorie</label>
    <div style="display:flex;gap:7px;flex-wrap:wrap">${CATS.map(c=>`<button onclick="updateReg('kat','${c.lbl}')" style="padding:9px 13px;border-radius:10px;font-size:12px;font-weight:700;background:${f.kat===c.lbl?"var(--gold)":"var(--c3)"};color:${f.kat===c.lbl?"#080706":"var(--stone)"};border:1px solid ${f.kat===c.lbl?"var(--gold)":"var(--border)"}">${c.lbl}</button>`).join("")}</div></div>
    <div onclick="updateReg('freelancer',${!f.freelancer})" style="display:flex;gap:10px;align-items:center;padding:12px 14px;background:${f.freelancer?"rgba(200,168,75,.06)":"var(--c2)"};border-radius:12px;border:1.5px solid ${f.freelancer?"var(--gold)":"var(--border)"};cursor:pointer">
      <div class="check ${f.freelancer?"on":""}">${f.freelancer?"✓":""}</div>
      <div><p style="font-size:13px;font-weight:700">Ich bin Freiberufler / Mieter</p><p style="font-size:11px;color:var(--stone)">Ich möchte einen Stuhl/Raum anmieten (nicht vermieten)</p></div>
    </div>
    <div><label style="font-size:12px;color:var(--stone);display:block;margin-bottom:4px">IBAN</label><input class="inp" value="${f.iban}" oninput="updateReg('iban',this.value)" placeholder="DE89 3704 ..."/></div>
    ${needGewerbe?`<div onclick="updateReg('gb',${!f.gb})" style="display:flex;gap:10px;align-items:center;padding:12px 14px;background:var(--c2);border-radius:12px;border:1px solid ${f.gb?"var(--gold)":"var(--border)"};cursor:pointer">
      <div class="check ${f.gb?"on":""}">${f.gb?"✓":""}</div>
      <div><p style="font-size:13px;font-weight:700">Gewerbeschein vorhanden</p><p style="font-size:11px;color:var(--stone)">Hochladen nach Registrierung</p></div>
    </div>`:`<div style="padding:12px 14px;background:rgba(74,138,90,.06);border-radius:12px;border:1px solid rgba(74,138,90,.15)">
      <p style="font-size:12px;color:#6ABF80;font-weight:700">✓ Kein Gewerbeschein nötig</p>
      <p style="font-size:11px;color:var(--stone);margin-top:2px">Als freiberuflicher Barber/Friseur brauchst du keinen Gewerbeschein.</p>
    </div>`}</div>`;}
  if(s===3){
    const catMap={Barbershop:"barber",Friseur:"friseur",Kosmetik:"kosmetik","Ästhetik":"aesthetik",Nails:"nail",Massage:"massage","Lash & Brows":"lash","Arzt/Klinik":"arzt","Raum/Kabine":"raum","OP-Raum":"opraum"};
    const regCat=catMap[f.kat]||"barber";
    const allowed=getAllowedRentals(regCat);
    const allOpts=[
      {k:"chair",type:"stuhl",svg:rentalIcon("stuhl"),nm:"Stuhl vermieten",desc:"Barber-/Friseur-Stuhl",ph:"45"},
      {k:"liege",type:"liege",svg:rentalIcon("liege"),nm:"Liege vermieten",desc:"Massage-/Kosmetik-Liege",ph:"40"},
      {k:"kabine",type:"raum",svg:rentalIcon("raum"),nm:"Kosmetik-Kabine vermieten",desc:"Behandlungsraum / Kabine",ph:"55"},
      {k:"opraum",type:"opraum",svg:rentalIcon("opraum"),nm:"OP-Raum vermieten",desc:"Steriler Operationssaal",ph:"400"}
    ];
    body=`<div style="display:flex;flex-direction:column;gap:14px">
    <p class="lgold">${rentalIcon("stuhl")} Was vermietest du?</p>
    <p style="font-size:13px;color:var(--stone);line-height:1.6">Basierend auf deiner Kategorie <strong style="color:var(--gold2)">${f.kat||"—"}</strong> kannst du folgendes anbieten:</p>
    ${allOpts.map(opt=>{
      const unlocked=allowed.includes(opt.type);
      const reqSent=(state.unlockRequests||[]).includes(opt.type);
      if(unlocked)return`
    <div onclick="updateReg('${opt.k}',${!f[opt.k]})" style="display:flex;gap:10px;align-items:center;padding:13px 15px;background:${f[opt.k]?"rgba(200,168,75,.06)":"var(--c2)"};border-radius:12px;border:1.5px solid ${f[opt.k]?"var(--gold)":"var(--border)"};cursor:pointer">
      <div style="width:36px;display:flex;align-items:center;justify-content:center">${opt.svg}</div>
      <div style="flex:1"><p style="font-size:13px;font-weight:700">${opt.nm} ✦</p><p style="font-size:11px;color:var(--stone)">${opt.desc}</p></div>
      <div class="check ${f[opt.k]?"on":""}">${f[opt.k]?"✓":""}</div>
    </div>
    ${f[opt.k]?`<div style="margin-left:46px"><label style="font-size:12px;color:var(--stone);display:block;margin-bottom:4px">Preis/Tag (€)</label><input class="inp" type="number" value="${f[opt.k+"_pr"]||""}" oninput="updateReg('${opt.k}_pr',this.value)" placeholder="${opt.ph}"/></div>`:""}`;
      return`
    <div style="display:flex;gap:10px;align-items:center;padding:13px 15px;background:var(--c2);border-radius:12px;border:1.5px dashed var(--c5);opacity:.7">
      <div style="width:36px;display:flex;align-items:center;justify-content:center;opacity:.4">${opt.svg}</div>
      <div style="flex:1"><p style="font-size:13px;font-weight:700;color:var(--stone)">${opt.nm}</p><p style="font-size:11px;color:var(--stone2)">${opt.desc}</p>
        <p style="font-size:10px;color:var(--gold);margin-top:4px">🔒 Verifizierung nötig — Fotos & Nachweis erforderlich</p></div>
      ${reqSent?`<span style="font-size:10px;color:#6ABF80;font-weight:700;white-space:nowrap">✓ Angefragt</span>`:`<button onclick="event.stopPropagation();requestUnlock('${opt.type}')" style="padding:6px 10px;border-radius:8px;background:var(--c3);border:1px solid var(--border);font-size:10px;color:var(--gold);font-weight:700;white-space:nowrap;cursor:pointer">Anfragen</button>`}
    </div>`;}).join("")}
    <div style="padding:12px 14px;background:rgba(200,168,75,.04);border-radius:12px;border:1px solid rgba(200,168,75,.1);margin-top:4px">
      <p style="font-size:11px;color:var(--stone);line-height:1.5">💡 Du kannst nur anbieten was du tatsächlich hast. Für weitere Kategorien sende uns Fotos deiner Räumlichkeiten — wir prüfen und schalten frei.</p>
    </div>
  </div>`;}
  if(s===4)body=`<div>
    <p class="lgold" style="margin-bottom:14px">✅ Zusammenfassung</p>
    <div class="card" style="padding:14px;margin-bottom:16px">
      ${[["Name",f.vn+" "+f.nn],["E-Mail",f.em],["Geschäft",f.geschaeft],["Stadt",f.city],["Kategorie",f.kat],["Typ",f.freelancer?"Freiberufler / Mieter":"Vermieter / Inhaber"]].map(([k,v])=>`<div style="display:flex;justify-content:space-between;padding:7px 0;border-bottom:1px solid var(--border);font-size:13px"><span style="color:var(--stone)">${k}</span><span style="font-weight:600">${v||"—"}</span></div>`).join("")}
      ${f.chair?`<div style="display:flex;justify-content:space-between;align-items:center;padding:7px 0;border-bottom:1px solid var(--border);font-size:13px"><span style="color:var(--stone);display:flex;align-items:center;gap:6px">${rentalIcon("stuhl")} Stuhl</span><span style="font-weight:600">${f.chair_pr||"—"} €/Tag</span></div>`:""}
      ${f.liege?`<div style="display:flex;justify-content:space-between;align-items:center;padding:7px 0;border-bottom:1px solid var(--border);font-size:13px"><span style="color:var(--stone);display:flex;align-items:center;gap:6px">${rentalIcon("liege")} Liege</span><span style="font-weight:600">${f.liege_pr||"—"} €/Tag</span></div>`:""}
      ${f.kabine?`<div style="display:flex;justify-content:space-between;align-items:center;padding:7px 0;border-bottom:1px solid var(--border);font-size:13px"><span style="color:var(--stone);display:flex;align-items:center;gap:6px">${rentalIcon("raum")} Kabine</span><span style="font-weight:600">${f.kabine_pr||"—"} €/Tag</span></div>`:""}
      ${f.opraum?`<div style="display:flex;justify-content:space-between;align-items:center;padding:7px 0;border-bottom:1px solid var(--border);font-size:13px"><span style="color:var(--stone);display:flex;align-items:center;gap:6px">${rentalIcon("opraum")} OP-Raum</span><span style="font-weight:600">${f.opraum_pr||"—"} €/Tag</span></div>`:""}
    </div>
    <div onclick="updateReg('agb',${!f.agb})" style="display:flex;gap:10px;padding:12px 0;border-bottom:1px solid var(--border);cursor:pointer;align-items:center"><div class="check ${f.agb?"on":""}">${f.agb?"✓":""}</div><p style="font-size:13px;font-weight:600">AGB akzeptieren</p></div>
    <div onclick="updateReg('dsgvo',${!f.dsgvo})" style="display:flex;gap:10px;padding:12px 0;cursor:pointer;align-items:center"><div class="check ${f.dsgvo?"on":""}">${f.dsgvo?"✓":""}</div><p style="font-size:13px;font-weight:600">Datenschutzerklärung akzeptieren</p></div></div>`;
  return`<div class="sticky"><button onclick="goSub(null)" style="font-size:var(--font-md);color:var(--gold);font-weight:700;min-height:44px;display:flex;align-items:center;gap:4px">← ${t("back")}</button>
    <h1 style="font-size:var(--font-lg);font-weight:700;font-family:'Cinzel',serif;color:var(--gold2)">${t("register")}</h1>
    <p style="font-size:11px;color:var(--stone);margin-bottom:8px">${t("step")} ${s}/4 — ${snames[s-1]}</p>
    <div class="pbar"><div class="pfill" style="width:${s/4*100}%"></div></div></div>
  <div style="padding:22px var(--pad) 40px">
    ${body}
    <div style="display:flex;gap:10px;margin-top:22px">
      ${s>1?`<button class="boutline" style="flex:0 0 auto;padding:13px 18px" onclick="setRegStep(${s-1})">←</button>`:""}
      <button class="bgold" style="flex:1" ${s===4&&(!f.agb||!f.dsgvo)?"disabled":""} onclick="${s===4?"submitReg()":"setRegStep("+(s+1)+")"}">${s===4?"Jetzt registrieren →":t("next")}</button>
    </div></div>`;
}

// ─── SLOT AVAILABILITY (deterministic) ───
function getSlotAvailability(provId,dayIndex,timeSlot){
  let hash=0;const key=provId+'-'+dayIndex+'-'+timeSlot;
  for(let i=0;i<key.length;i++){hash=((hash<<5)-hash)+key.charCodeAt(i);hash|=0;}
  return(Math.abs(hash)%100)>35;
}

// ─── BOOKING (with WhatsApp sharing) ───
function renderBooking(){
  const p=state.bookingProv;const s=state.bookStep;
  const today=new Date();
  const days=["So","Mo","Di","Mi","Do","Fr","Sa"];
  const dl=Array.from({length:7},(_,i)=>{const d=new Date(today);d.setDate(today.getDate()+i);return{i,day:days[d.getDay()],dt:d.getDate(),mo:String(d.getMonth()+1).padStart(2,'0')};});
  const ts=["09:00","10:00","11:00","13:00","14:00","15:00","16:00","18:00","19:00"];
  const specs=SPECS.filter(sp=>p.sps.includes(sp.id));
  const sv=state.bookSv;const slot=state.bookSlot;const day=state.bookDay;const sp=state.bookSp;
  if(state.bookDone){
    const lastBk=state.bookings[0];
    const finalPr=lastBk?lastBk.pr:sv?.pr;
    const waMsg=encodeURIComponent(`Mein Termin bei ${p.nm}: ${sv?.nm}, ${dl[day]?.day} ${dl[day]?.dt}.${dl[day]?.mo}, ${slot} Uhr. Gebucht über ChairMatch!`);
    return`<div style="padding:36px 22px;text-align:center">
    <div style="width:60px;height:60px;border-radius:50%;background:rgba(74,138,90,.15);border:1px solid rgba(74,138,90,.3);display:flex;align-items:center;justify-content:center;font-size:26px;margin:0 auto 14px">✓</div>
    <h2 style="font-size:22px;margin-bottom:6px;font-family:'Cinzel',serif;color:var(--gold2)">${t("confirm")}</h2>
    <p style="font-size:13px;color:var(--stone);margin-bottom:18px">${p.nm} · ${sv?.nm} · ${dl[day]?.day} ${dl[day]?.dt}.${dl[day]?.mo} · ${slot}</p>
    <div class="card" style="padding:14px;margin-bottom:16px;text-align:left">
      <div style="display:flex;justify-content:space-between;padding:8px 0;font-size:15px">
        <span style="color:var(--gold2);font-weight:700">${t("total")}</span>
        <span style="font-weight:800;color:var(--gold2)">${finalPr} €</span>
      </div>
    </div>
    <p style="font-size:11px;color:var(--stone);margin-bottom:16px">${t("noFee")}</p>
    <a href="https://wa.me/?text=${waMsg}" target="_blank" style="display:block;padding:14px;background:#25D366;color:#fff;border-radius:14px;font-size:14px;font-weight:700;text-decoration:none;margin-bottom:10px">💬 ${t("shareWA")}</a>
    <button class="bgold" onclick="closeBooking()">${t("done")}</button>
  </div>`;}
  let body="";
  if(s===1){body=`
    <p class="lsm" style="margin-bottom:10px">${t("service")}</p>
    <div style="display:flex;flex-direction:column;gap:8px;margin-bottom:18px">
      ${p.svs.map(sv2=>`<div onclick="selectSv('${sv2.id}')" style="display:flex;justify-content:space-between;align-items:center;padding:13px 15px;background:${state.bookSv?.id===sv2.id?"rgba(200,168,75,.08)":"var(--c2)"};border-radius:13px;border:1.5px solid ${state.bookSv?.id===sv2.id?"var(--gold)":"var(--border)"};cursor:pointer">
        <div><p style="font-size:14px;font-weight:700">${sv2.nm}</p><p style="font-size:12px;color:var(--stone)">${sv2.dur} min</p></div>
        <span style="font-size:15px;font-weight:800;color:var(--gold2)">${sv2.pr} €</span>
      </div>`).join("")}
    </div>
    <p class="lsm" style="margin-bottom:10px">${t("day")}</p>
    <div style="display:flex;gap:7px;margin-bottom:18px;overflow-x:auto;padding-bottom:4px">
      ${dl.map((d,i)=>`<div onclick="selectDay(${i})" style="flex-shrink:0;width:46px;padding:9px 6px;border-radius:13px;text-align:center;cursor:pointer;background:${day===i?"var(--gold)":"var(--c2)"};border:1px solid ${day===i?"var(--gold)":"var(--border)"}">
        <p style="font-size:10px;font-weight:700;color:${day===i?"#080706":"var(--stone)"}">${d.day}</p>
        <p style="font-size:15px;font-weight:800;color:${day===i?"#080706":"var(--cream)"}">${d.dt}</p>
      </div>`).join("")}
    </div>
    <p class="lsm" style="margin-bottom:10px">${t("time")}</p>
    <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:20px">
      ${ts.map(tm=>{const av=getSlotAvailability(p.id,day,tm);return`<div onclick="${av?`selectSlot('${tm}')`:"return false"}" style="padding:9px 13px;border-radius:10px;font-size:13px;font-weight:700;cursor:${av?"pointer":"default"};background:${slot===tm?"var(--gold)":av?"var(--c3)":"var(--c2)"};color:${slot===tm?"#080706":av?"var(--cream)":"var(--stone2)"};border:1px solid ${slot===tm?"var(--gold)":"var(--border)"};opacity:${av?1:.4}">${tm}</div>`;}).join("")}
    </div>
    <button class="bgold" ${!state.bookSv||!state.bookSlot?"disabled":""} onclick="setBookStep(2)">${t("next")}</button>`;}
  if(s===2){body=`
    <p class="lsm" style="margin-bottom:10px">${t("specialist")}</p>
    <div style="display:flex;gap:10px;margin-bottom:20px;overflow-x:auto;padding-bottom:4px">
      ${specs.map(spec=>`<div onclick="selectSp('${spec.id}')" style="flex-shrink:0;width:106px;padding:13px 10px;border-radius:16px;text-align:center;cursor:pointer;background:${sp?.id===spec.id?"rgba(200,168,75,.08)":"var(--c2)"};border:1.5px solid ${sp?.id===spec.id?"var(--gold)":"var(--border)"}">
        <div style="width:48px;height:48px;border-radius:50%;background:${spec.col};display:flex;align-items:center;justify-content:center;font-size:15px;font-weight:800;margin:0 auto 8px">${spec.ini}</div>
        <p style="font-size:11px;font-weight:700;margin-bottom:2px">${spec.nm}</p>${stars(spec.rt)}
      </div>`).join("")}
    </div>
    <div style="display:flex;gap:10px">
      <button class="boutline" style="flex:0 0 auto;padding:13px 18px" onclick="setBookStep(1)">←</button>
      <button class="bgold" style="flex:1" onclick="setBookStep(3)">${t("next")}</button>
    </div>`;}
  if(s===3){
    const basePrice=sv?.pr||0;
    const discPrice=state.promoValid&&PROMO_CODES[state.promoCode]?(PROMO_CODES[state.promoCode].type==='percent'?Math.round(basePrice*(1-PROMO_CODES[state.promoCode].discount/100)):Math.max(0,basePrice-PROMO_CODES[state.promoCode].discount)):basePrice;
    const canConfirm=state.bookName.trim().length>0&&state.bookEmail.trim().length>0&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(state.bookEmail);
    body=`
    <p class="lsm" style="margin-bottom:10px">${t("contact")}</p>
    <div style="display:flex;flex-direction:column;gap:10px;margin-bottom:16px">
      <div><label style="font-size:12px;color:var(--stone);display:block;margin-bottom:4px">${t("name")}</label><input class="inp" value="${state.bookName}" oninput="updateBookContact('bookName',this.value)" placeholder="Max Mustermann"/></div>
      <div><label style="font-size:12px;color:var(--stone);display:block;margin-bottom:4px">${t("email")}</label><input class="inp" type="email" value="${state.bookEmail}" oninput="updateBookContact('bookEmail',this.value)" placeholder="max@mail.de" style="${state.bookEmail.length>0&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(state.bookEmail)?'border-color:var(--red)':''}"/></div>
      <div><label style="font-size:12px;color:var(--stone);display:block;margin-bottom:4px">${t("phone")}</label><input class="inp" type="tel" value="${state.bookPhone}" oninput="updateBookContact('bookPhone',this.value)" placeholder="+49 170 ..."/></div>
    </div>
    <div style="margin-bottom:16px">
      <label style="font-size:12px;color:var(--stone);display:block;margin-bottom:4px">${t("specialRequests")}</label>
      <textarea class="inp" style="height:60px;resize:none" placeholder="${t("notesPlaceholder")}" oninput="updateBookContact('bookNotes',this.value)">${state.bookNotes}</textarea>
    </div>
    <div class="card" style="padding:13px;margin-bottom:14px">
      ${[[sv?.nm,(state.promoValid?'<s style="color:var(--stone)">'+basePrice+'€</s> '+discPrice+'€':basePrice+"€")],[dl[day]?.day+" "+dl[day]?.dt+"."+dl[day]?.mo,slot]].map(([k,v])=>`<div style="display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid var(--border);font-size:13px"><span style="color:var(--stone)">${k}</span><span style="font-weight:700">${v}</span></div>`).join("")}
    </div>
    <div style="margin-bottom:14px">
      <p class="lsm" style="margin-bottom:6px">${t("enterPromo")}</p>
      <div style="display:flex;gap:8px">
        <input class="inp" style="flex:1" value="${state.promoCode}" oninput="updateBookContact('promoCode',this.value.toUpperCase())" placeholder="CHAIR2026"/>
        <button class="boutline" style="flex:0 0 auto;padding:12px 16px" onclick="applyPromo()">${t("promoApply")}</button>
      </div>
      ${state.promoValid===true?`<p style="font-size:12px;color:#6ABF80;margin-top:6px">✓ ${t("promoApplied")} -${state.promoDiscount}${PROMO_CODES[state.promoCode]?.type==='percent'?'%':'€'}</p>`:''}
      ${state.promoValid===false?`<p style="font-size:12px;color:var(--red);margin-top:6px">✕ ${t("promoInvalid")}</p>`:''}
    </div>
    <div style="display:flex;gap:10px">
      <button class="boutline" style="flex:0 0 auto;padding:13px 18px" onclick="setBookStep(2)">←</button>
      <button class="bgold" style="flex:1" ${canConfirm?'':"disabled"} onclick="confirmBooking()">${t("bookNow")}</button>
    </div>`;}
  return`<div class="sticky">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
      <button onclick="closeBooking()" style="font-size:var(--font-md);color:var(--stone);min-width:44px;min-height:44px;display:flex;align-items:center;justify-content:center">✕</button>
      <span style="font-size:var(--font-sm);color:var(--stone)">${t("step")} ${s}/3</span>
    </div>
    <div class="pbar"><div class="pfill" style="width:${s/3*100}%"></div></div>
  </div>
  <div style="padding:var(--pad);padding-bottom:30px">${body}</div>`;
}

// ═══ HISTORY / BACK NAVIGATION ═══
let skipPush=false;
function pushNav(label){if(!skipPush)history.pushState({nav:label},"")}
window.addEventListener("popstate",function(){
  skipPush=true;
  // Booking overlay open? Close it
  if(state.bookingProv){state.bookingProv=null;state.bookDone=false;render();skipPush=false;return;}
  // Sub-page open? Close it
  if(state.subPage){state.subPage=null;render();skipPush=false;return;}
  // Detail view open? Go back to list
  if(state.detail){state.detail=null;state.tab="home";render();skipPush=false;return;}
  // On a non-home tab? Go home
  if(state.tab!=="home"){state.tab="home";render();skipPush=false;return;}
  // Onboarding step >0? Go back one step
  if(!state.onboarded&&state.obStep>0){state.obStep--;render();skipPush=false;return;}
  // Nothing left to go back to — let browser handle it
  skipPush=false;
});

// ═══ ACTIONS ═══
function nextOb(){state.obStep++;pushNav("ob"+state.obStep);render();}
function finishOnboarding(r){state.role=r;state.onboarded=true;state.tab="home";pushNav("home");document.getElementById("mainScreen").scrollTop=0;render();}
function goTab(t){state.tab=t;state.detail=null;state.subPage=null;pushNav("tab-"+t);document.getElementById("mainScreen").scrollTop=0;render();}
function openDetail(id){state.detail=PROVS.find(p=>p.id===id);state.detailTab="info";pushNav("detail-"+id);document.getElementById("mainScreen").scrollTop=0;render();}
function setDetailTab(t){state.detailTab=t;render();}
function goBack(){state.detail=null;state.tab="home";history.back();}
function setCat(c){state.catFilter=c;render();}
function setRole(r){state.role=r;render();}
function goSub(p){if(p){pushNav("sub-"+p);}else{history.back();return;}state.subPage=p;document.getElementById("mainScreen").scrollTop=0;render();}
function openBooking(id){state.bookingProv=PROVS.find(p=>p.id===id);state.bookStep=1;state.bookSv=null;state.bookSlot=null;state.bookSp=null;state.bookDone=false;state.bookName="";state.bookEmail="";state.bookPhone="";state.bookNotes="";state.promoCode="";state.promoValid=null;state.promoDiscount=0;pushNav("booking");render();}
function closeBooking(){state.bookingProv=null;state.bookDone=false;state.stamps=Math.min(10,state.stamps+1);state.loyaltyRedeemed=false;localStorage.setItem("cm_redeemed","false");saveStamps();history.back();}
function selectSv(id){state.bookSv=state.bookingProv.svs.find(s=>s.id===id);render();}
function selectDay(i){state.bookDay=i;state.bookSlot=null;render();}
function selectSlot(tm){state.bookSlot=tm;render();}
function selectSp(id){state.bookSp=SPECS.find(s=>s.id===id);render();}
function setBookStep(s){state.bookStep=s;render();}
function confirmBooking(){
  const p=state.bookingProv;const today=new Date();const days=["So","Mo","Di","Mi","Do","Fr","Sa"];
  const d=new Date(today);d.setDate(today.getDate()+state.bookDay);
  const dateStr=days[d.getDay()]+" "+d.getDate()+"."+String(d.getMonth()+1).padStart(2,'0');
  const sv=state.bookSv;
  const basePrice=sv?.pr||0;
  const finalPrice=state.promoValid&&PROMO_CODES[state.promoCode]?(PROMO_CODES[state.promoCode].type==='percent'?Math.round(basePrice*(1-PROMO_CODES[state.promoCode].discount/100)):Math.max(0,basePrice-PROMO_CODES[state.promoCode].discount)):basePrice;
  const booking={id:'b'+Date.now(),provId:p.id,provNm:p.nm,nm:state.bookSp?.nm||state.bookName,sv:sv?.nm,t:dateStr+" · "+state.bookSlot,st:"confirmed",pr:finalPrice,notes:state.bookNotes};
  state.bookings.unshift(booking);localStorage.setItem("cm_bookings",JSON.stringify(state.bookings));
  state.bookDone=true;showToast(t("confirm")+" 🎉");render();
}
function updateReg(k,v){state.regData[k]=v==="true"?true:v==="false"?false:v;render();}
function setRegStep(s){state.regStep=s;render();}
function submitReg(){state.regDone=true;showToast("Registrierung eingereicht!");render();}
function toggleService(nm){
  if(!state.provServices)state.provServices=[];
  const idx=state.provServices.indexOf(nm);
  if(idx>-1){state.provServices.splice(idx,1);showToast("Deaktiviert");}
  else{state.provServices.push(nm);showToast("Freigeschaltet");}
  localStorage.setItem("cm_prov_svcs",JSON.stringify(state.provServices));render();
}
function toggleAllServices(){
  const p=PROVS[0];const catalog=SVC_CATALOG[p.cat]||[];
  if(state.provServices&&state.provServices.length===catalog.length){state.provServices=[];showToast("Alle deaktiviert");}
  else{state.provServices=catalog.map(s=>s.nm);showToast("Alle aktiviert");}
  localStorage.setItem("cm_prov_svcs",JSON.stringify(state.provServices));render();
}
function updateServicePrice(nm,val){
  if(!state.provPrices)state.provPrices={};
  state.provPrices[nm]=parseFloat(val)||0;
  localStorage.setItem("cm_prov_prices",JSON.stringify(state.provPrices));
}
function onSearch(v){state.searchQuery=v;render();}
function focusSearch(){setTimeout(()=>{const el=document.getElementById("searchInp");if(el)el.focus();},50);}
function toggleFilter(){state.showFilter=!state.showFilter;render();}
function setFilterCity(c){state.filterCity=c;render();}
function setFilterRating(r){state.filterMinRating=r;render();}
function setFilterPrice(v){state.filterMaxPrice=parseInt(v);render();}
function toggleFilterAvail(){state.filterOnlyAvail=!state.filterOnlyAvail;render();}
function toggleFilterDisc(){state.filterOnlyDisc=!state.filterOnlyDisc;render();}
function resetFilters(){state.filterCity="all";state.filterMinRating=0;state.filterMaxPrice=500;state.filterOnlyAvail=false;state.filterOnlyDisc=false;render();}
function setView(m){state.viewMode=m;render();}
function markRead(id){const n=state.notifications.find(x=>x.id===id);if(n)n.read=true;render();}
function toggleTheme(){state.theme=state.theme==="dark"?"light":"dark";document.body.classList.toggle("light");localStorage.setItem("cm_theme",state.theme);showToast(state.theme==="dark"?t("darkMode"):t("lightMode"));render();}
function setLang(code){state.lang=code;localStorage.setItem("cm_lang",code);showToast(t("lang")+": "+(code==="de"?"Deutsch":code==="en"?"English":"Türkçe"));render();}

function updateBookContact(field,value){state[field]=value;}
function subscribeNL(){
  const email=state.nlEmail.trim();
  if(!email||!email.includes("@")){showToast("Bitte gültige E-Mail eingeben");return;}
  state.nlSubscribed=true;localStorage.setItem("cm_nl","true");localStorage.setItem("cm_nl_email",email);
  showToast(t("nlSuccess"));render();
}
function shareReferral(){
  const refLink='https://chairmatch.de/ref/'+state.refCode;
  const text=(state.lang==="tr"?"ChairMatch'i dene - en iyi güzellik rezervasyon uygulaması! Kodum: ":state.lang==="en"?"Try ChairMatch - the best beauty booking app! My code: ":"Teste ChairMatch - die beste Beauty-Booking App! Mein Code: ")+state.refCode+" "+refLink;
  if(navigator.share){navigator.share({title:'ChairMatch',text:text,url:refLink}).catch(()=>{});}
  else if(navigator.clipboard){navigator.clipboard.writeText(text).then(()=>showToast(t('linkCopied')));}
  else{showToast(t('linkCopied'));}
}
function copyRefCode(){
  if(navigator.clipboard){navigator.clipboard.writeText(state.refCode).then(()=>showToast(t('refCopied')));}
  else{showToast(state.refCode);}
}
function shareWhatsApp(){
  const refLink='https://chairmatch.de/ref/'+state.refCode;
  const text=encodeURIComponent((state.lang==="tr"?"ChairMatch'i dene! Kodum: ":state.lang==="en"?"Try ChairMatch! Code: ":"Teste ChairMatch! Code: ")+state.refCode+" "+refLink);
  window.open('https://wa.me/?text='+text,'_blank');
}
function setReviewRating(n){state.reviewRating=n;render();}
function submitReview(provId){
  if(state.reviewRating===0)return;
  const prov=PROVS.find(p=>p.id===provId);if(!prov)return;
  const today=new Date();
  const dateStr=String(today.getDate()).padStart(2,'0')+'.'+String(today.getMonth()+1).padStart(2,'0')+'.'+today.getFullYear();
  prov.revs.unshift({u:state.bookName||"Gast",s:state.reviewRating,t:state.reviewText,d:dateStr});
  prov.rc++;showToast(t("reviewSubmitted"));state.reviewRating=0;state.reviewText="";render();
}
function applyPromo(){
  const code=state.promoCode.trim().toUpperCase();
  if(PROMO_CODES[code]){state.promoValid=true;state.promoDiscount=PROMO_CODES[code].discount;showToast(t("promoApplied"));}
  else{state.promoValid=false;state.promoDiscount=0;}
  render();
}
function redeemLoyalty(){
  state.stamps=0;state.loyaltyRedeemed=true;saveStamps();localStorage.setItem("cm_redeemed","true");
  showToast(t("loyaltyRedeemMsg"));render();
}
function cancelBooking(bookingId){
  if(!confirm(t("cancelConfirm")))return;
  const b=state.bookings.find(bk=>bk.id===bookingId);if(b){b.st="cancelled";}
  localStorage.setItem("cm_bookings",JSON.stringify(state.bookings));
  showToast(t("bookingCancelled"));render();
}
let _saTapCount=0,_saTapTimer=null;
function toggleSuperAdmin(){
  _saTapCount++;
  clearTimeout(_saTapTimer);
  _saTapTimer=setTimeout(()=>{_saTapCount=0;},2000);
  if(_saTapCount>=3){
    state.superAdmin=!state.superAdmin;
    localStorage.setItem("cm_superadmin",JSON.stringify(state.superAdmin));
    showToast(state.superAdmin?"🛡 Super Admin aktiviert":"Super Admin deaktiviert");
    _saTapCount=0;render();
  }
}

render();
</script>
</body>
</html>
